const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/HomeMap-CxkRF1JG.js","assets/charts-0jYrCXCa.js","assets/TileLayer-DQ8zY-q8.js","assets/search-Bhl9FGOw.js","assets/qr-BITZ6EfA.js","assets/EventCreationFlow-BxUEt-Yh.js","assets/geminiService-DURgciVI.js","assets/triangle-alert-CxxnQicr.js","assets/upload-uczA5OcS.js","assets/clock-Cnt1qgag.js","assets/map-pin-Zr57KGRe.js","assets/EventCreationFlow-Dgihpmma.css","assets/Dashboard-kVqm3yur.js","assets/browser-D7w79axB.js","assets/circle-alert-_cpfBv0g.js","assets/circle-x-6_o0yPnH.js","assets/circle-check-big-BVKQvehI.js","assets/maximize-2-upWm9pCa.js","assets/minus-BhrpZycd.js","assets/megaphone-1m6_Q5hP.js","assets/image-C72TOZrH.js","assets/rocket-D9Rxxq60.js","assets/download-B9c36Fle.js","assets/share-2-ytQz_KfA.js","assets/circle-check-CSkpwwxu.js","assets/copy-Qt2RpJVI.js","assets/smartphone-BLEMLclc.js","assets/twitter-CjjGKUzA.js","assets/UserProfile-Dmf8mOcy.js","assets/ticketService-O5k76BGT.js","assets/SimplifiedSocialMediaManager-CNnq1CE-.js","assets/refresh-cw-hkacKNH8.js","assets/loader-GWe7--jB.js","assets/message-square-CNN38snK.js","assets/EventDetail-B-KoHTrQ.js","assets/stripeService-DPa5zaLD.js","assets/pen-line-BArdnww9.js","assets/heart-BBtaA7RC.js","assets/user-plus-BMrevrHM.js","assets/EventEditPage-Bze1LBQ4.js","assets/arrow-left-XpV3ECAJ.js","assets/save-BMNvfd6I.js","assets/TicketScanner-Be5R7jeQ.js","assets/camera-DmA-TvOu.js","assets/info-DS4ltxwt.js","assets/TicketViewPage-BUBoWDXL.js","assets/PricingPage-B9kxJnGG.js","assets/AgencyProfile-DkXKp4FX.js","assets/lightbulb-BgcNqA9y.js","assets/AdminCommandCenter-C2oEtua0.js","assets/code-BJlMwBF-.js","assets/eye-DUeTJBJd.js","assets/ai-DHVDkxo7.js","assets/credit-card-LHnZpxiq.js","assets/HelpCenter-Cz_jTg9Q.js","assets/TermsOfService-CAjcJMjK.js","assets/LegalPage-CZuFrVjS.js","assets/PrivacyPolicy-CFRDE4MF.js","assets/CookieSettings-BcNyY7o-.js","assets/GDPRCompliance-DosqNCpS.js","assets/NotificationSettings-Dmr9agu7.js","assets/BetaInvitation-CYhFrswv.js","assets/OnboardingTutorial-rKfYipU2.js","assets/AdminCreditManager-D9WjW-L4.js","assets/CodeRedemption-DvR6HO_C.js","assets/campaignTrackingService-D4JXwC6N.js"])))=>i.map(i=>d[i]);
import{r as e,a as t,g as r,b as s,R as a}from"./charts-0jYrCXCa.js";import{_ as n}from"./qr-BITZ6EfA.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const r of e)if("childList"===r.type)for(const e of r.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var i,o,l={exports:{}},c={};var u,d=(o||(o=1,l.exports=function(){if(i)return c;i=1;var t=e(),r=Symbol.for("react.element"),s=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,n=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function l(e,t,s){var i,l={},c=null,u=null;for(i in void 0!==s&&(c=""+s),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(u=t.ref),t)a.call(t,i)&&!o.hasOwnProperty(i)&&(l[i]=t[i]);if(e&&e.defaultProps)for(i in t=e.defaultProps)void 0===l[i]&&(l[i]=t[i]);return{$$typeof:r,type:e,key:c,ref:u,props:l,_owner:n.current}}return c.Fragment=s,c.jsx=l,c.jsxs=l,c}()),l.exports),h={};const p=r(function(){if(u)return h;u=1;var e=t();return h.createRoot=e.createRoot,h.hydrateRoot=e.hydrateRoot,h}());
/**
 * react-router v7.11.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var m="popstate";function f(e={}){return function(e,t,r,s={}){let{window:a=document.defaultView,v5Compat:n=!1}=s,i=a.history,o="POP",l=null,c=u();null==c&&(c=0,i.replaceState({...i.state,idx:c},""));function u(){return(i.state||{idx:null}).idx}function d(){o="POP";let e=u(),t=null==e?null:e-c;c=e,l&&l({action:o,location:y.location,delta:t})}function h(e,t){o="PUSH";let r=v(y.location,e,t);c=u()+1;let s=w(r,c),d=y.createHref(r);try{i.pushState(s,"",d)}catch(h){if(h instanceof DOMException&&"DataCloneError"===h.name)throw h;a.location.assign(d)}n&&l&&l({action:o,location:y.location,delta:1})}function p(e,t){o="REPLACE";let r=v(y.location,e,t);c=u();let s=w(r,c),a=y.createHref(r);i.replaceState(s,"",a),n&&l&&l({action:o,location:y.location,delta:0})}function f(e){return function(e,t=!1){let r="http://localhost";"undefined"!=typeof window&&(r="null"!==window.location.origin?window.location.origin:window.location.href);g(r,"No window.location.(origin|href) available to create URL");let s="string"==typeof e?e:b(e);s=s.replace(/ $/,"%20"),!t&&s.startsWith("//")&&(s=r+s);return new URL(s,r)}(e)}let y={get action(){return o},get location(){return e(a,i)},listen(e){if(l)throw new Error("A history only accepts one active listener");return a.addEventListener(m,d),l=e,()=>{a.removeEventListener(m,d),l=null}},createHref:e=>t(a,e),createURL:f,encodeLocation(e){let t=f(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:h,replace:p,go:e=>i.go(e)};return y}(function(e,t){let{pathname:r,search:s,hash:a}=e.location;return v("",{pathname:r,search:s,hash:a},t.state&&t.state.usr||null,t.state&&t.state.key||"default")},function(e,t){return"string"==typeof t?t:b(t)},0,e)}function g(e,t){if(!1===e||null==e)throw new Error(t)}function y(e,t){if(!e)try{throw new Error(t)}catch(r){}}function w(e,t){return{usr:e.state,key:e.key,idx:t}}function v(e,t,r=null,s){return{pathname:"string"==typeof e?e:e.pathname,search:"",hash:"",..."string"==typeof t?x(t):t,state:r,key:t&&t.key||s||Math.random().toString(36).substring(2,10)}}function b({pathname:e="/",search:t="",hash:r=""}){return t&&"?"!==t&&(e+="?"===t.charAt(0)?t:"?"+t),r&&"#"!==r&&(e+="#"===r.charAt(0)?r:"#"+r),e}function x(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substring(r),e=e.substring(0,r));let s=e.indexOf("?");s>=0&&(t.search=e.substring(s),e=e.substring(0,s)),e&&(t.pathname=e)}return t}function _(e,t,r="/"){return function(e,t,r,s){let a="string"==typeof t?x(t):t,n=U(a.pathname||"/",r);if(null==n)return null;let i=k(e);!function(e){e.sort((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){let r=e.length===t.length&&e.slice(0,-1).every((e,r)=>e===t[r]);return r?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map(e=>e.childrenIndex),t.routesMeta.map(e=>e.childrenIndex)))}(i);let o=null;for(let l=0;null==o&&l<i.length;++l){let e=$(n);o=P(i[l],e,s)}return o}(e,t,r,!1)}function k(e,t=[],r=[],s="",a=!1){let n=(e,n,i=a,o)=>{let l={relativePath:void 0===o?e.path||"":o,caseSensitive:!0===e.caseSensitive,childrenIndex:n,route:e};if(l.relativePath.startsWith("/")){if(!l.relativePath.startsWith(s)&&i)return;g(l.relativePath.startsWith(s),`Absolute route path "${l.relativePath}" nested under path "${s}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),l.relativePath=l.relativePath.slice(s.length)}let c=F([s,l.relativePath]),u=r.concat(l);e.children&&e.children.length>0&&(g(!0!==e.index,`Index routes must not have child routes. Please remove all child routes from route path "${c}".`),k(e.children,t,u,c,i)),(null!=e.path||e.index)&&t.push({path:c,score:A(c,e.index),routesMeta:u})};return e.forEach((e,t)=>{var r;if(""!==e.path&&(null==(r=e.path)?void 0:r.includes("?")))for(let s of j(e.path))n(e,t,!0,s);else n(e,t)}),t}function j(e){let t=e.split("/");if(0===t.length)return[];let[r,...s]=t,a=r.endsWith("?"),n=r.replace(/\?$/,"");if(0===s.length)return a?[n,""]:[n];let i=j(s.join("/")),o=[];return o.push(...i.map(e=>""===e?n:[n,e].join("/"))),a&&o.push(...i),o.map(t=>e.startsWith("/")&&""===t?"/":t)}var S=/^:[\w-]+$/,E=3,N=2,T=1,R=10,O=-2,C=e=>"*"===e;function A(e,t){let r=e.split("/"),s=r.length;return r.some(C)&&(s+=O),t&&(s+=N),r.filter(e=>!C(e)).reduce((e,t)=>e+(S.test(t)?E:""===t?T:R),s)}function P(e,t,r=!1){let{routesMeta:s}=e,a={},n="/",i=[];for(let o=0;o<s.length;++o){let e=s[o],l=o===s.length-1,c="/"===n?t:t.slice(n.length)||"/",u=I({path:e.relativePath,caseSensitive:e.caseSensitive,end:l},c),d=e.route;if(!u&&l&&r&&!s[s.length-1].route.index&&(u=I({path:e.relativePath,caseSensitive:e.caseSensitive,end:!1},c)),!u)return null;Object.assign(a,u.params),i.push({params:a,pathname:F([n,u.pathname]),pathnameBase:W(F([n,u.pathnameBase])),route:d}),"/"!==u.pathnameBase&&(n=F([n,u.pathnameBase]))}return i}function I(e,t){"string"==typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[r,s]=function(e,t=!1,r=!0){y("*"===e||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let s=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(e,t,r)=>(s.push({paramName:t,isOptional:null!=r}),r?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");e.endsWith("*")?(s.push({paramName:"*"}),a+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?a+="\\/*$":""!==e&&"/"!==e&&(a+="(?:(?=\\/|$))");let n=new RegExp(a,t?void 0:"i");return[n,s]}(e.path,e.caseSensitive,e.end),a=t.match(r);if(!a)return null;let n=a[0],i=n.replace(/(.)\/+$/,"$1"),o=a.slice(1);return{params:s.reduce((e,{paramName:t,isOptional:r},s)=>{if("*"===t){let e=o[s]||"";i=n.slice(0,n.length-e.length).replace(/(.)\/+$/,"$1")}const a=o[s];return e[t]=r&&!a?void 0:(a||"").replace(/%2F/g,"/"),e},{}),pathname:n,pathnameBase:i,pattern:e}}function $(e){try{return e.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(t){return y(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),e}}function U(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,s=e.charAt(r);return s&&"/"!==s?null:e.slice(r)||"/"}var D=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i;function L(e,t="/"){let r,{pathname:s,search:a="",hash:n=""}="string"==typeof e?x(e):e;if(s)if(i=s,D.test(i))r=s;else{if(s.includes("//")){let e=s;s=s.replace(/\/\/+/g,"/"),y(!1,`Pathnames cannot have embedded double slashes - normalizing ${e} -> ${s}`)}r=s.startsWith("/")?q(s.substring(1),"/"):q(s,t)}else r=t;var i;return{pathname:r,search:V(a),hash:K(n)}}function q(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(e=>{".."===e?r.length>1&&r.pop():"."!==e&&r.push(e)}),r.length>1?r.join("/"):"/"}function M(e,t,r,s){return`Cannot include a '${e}' character in a manually specified \`to.${t}\` field [${JSON.stringify(s)}].  Please separate it out to the \`to.${r}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function B(e){let t=function(e){return e.filter((e,t)=>0===t||e.route.path&&e.route.path.length>0)}(e);return t.map((e,r)=>r===t.length-1?e.pathname:e.pathnameBase)}function z(e,t,r,s=!1){let a;"string"==typeof e?a=x(e):(a={...e},g(!a.pathname||!a.pathname.includes("?"),M("?","pathname","search",a)),g(!a.pathname||!a.pathname.includes("#"),M("#","pathname","hash",a)),g(!a.search||!a.search.includes("#"),M("#","search","hash",a)));let n,i=""===e||""===a.pathname,o=i?"/":a.pathname;if(null==o)n=r;else{let e=t.length-1;if(!s&&o.startsWith("..")){let t=o.split("/");for(;".."===t[0];)t.shift(),e-=1;a.pathname=t.join("/")}n=e>=0?t[e]:"/"}let l=L(a,n),c=o&&"/"!==o&&o.endsWith("/"),u=(i||"."===o)&&r.endsWith("/");return l.pathname.endsWith("/")||!c&&!u||(l.pathname+="/"),l}var F=e=>e.join("/").replace(/\/\/+/g,"/"),W=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),V=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",K=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"",H=class{constructor(e,t,r,s=!1){this.status=e,this.statusText=t||"",this.internal=s,r instanceof Error?(this.data=r.toString(),this.error=r):this.data=r}};function J(e){return e.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var G="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement;function Y(e,t){let r=e;if("string"!=typeof r||!D.test(r))return{absoluteURL:void 0,isExternal:!1,to:r};let s=r,a=!1;if(G)try{let e=new URL(window.location.href),s=r.startsWith("//")?new URL(e.protocol+r):new URL(r),n=U(s.pathname,t);s.origin===e.origin&&null!=n?r=n+s.search+s.hash:a=!0}catch(n){y(!1,`<Link to="${r}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:s,isExternal:a,to:r}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var Q=["POST","PUT","PATCH","DELETE"];new Set(Q);var Z=["GET",...Q];new Set(Z);var X=s.createContext(null);X.displayName="DataRouter";var ee=s.createContext(null);ee.displayName="DataRouterState";var te=s.createContext(!1),re=s.createContext({isTransitioning:!1});re.displayName="ViewTransition",s.createContext(new Map).displayName="Fetchers",s.createContext(null).displayName="Await";var se=s.createContext(null);se.displayName="Navigation";var ae=s.createContext(null);ae.displayName="Location";var ne=s.createContext({outlet:null,matches:[],isDataRoute:!1});ne.displayName="Route";var ie=s.createContext(null);ie.displayName="RouteError";var oe="REACT_ROUTER_ERROR";function le(){return null!=s.useContext(ae)}function ce(){return g(le(),"useLocation() may be used only in the context of a <Router> component."),s.useContext(ae).location}var ue="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function de(e){s.useContext(se).static||s.useLayoutEffect(e)}function he(){let{isDataRoute:e}=s.useContext(ne);return e?function(){let{router:e}=function(e){let t=s.useContext(X);return g(t,_e(e)),t}("useNavigate"),t=ke("useNavigate"),r=s.useRef(!1);return de(()=>{r.current=!0}),s.useCallback(async(s,a={})=>{y(r.current,ue),r.current&&("number"==typeof s?await e.navigate(s):await e.navigate(s,{fromRouteId:t,...a}))},[e,t])}():function(){g(le(),"useNavigate() may be used only in the context of a <Router> component.");let e=s.useContext(X),{basename:t,navigator:r}=s.useContext(se),{matches:a}=s.useContext(ne),{pathname:n}=ce(),i=JSON.stringify(B(a)),o=s.useRef(!1);return de(()=>{o.current=!0}),s.useCallback((s,a={})=>{if(y(o.current,ue),!o.current)return;if("number"==typeof s)return void r.go(s);let l=z(s,JSON.parse(i),n,"path"===a.relative);null==e&&"/"!==t&&(l.pathname="/"===l.pathname?t:F([t,l.pathname])),(a.replace?r.replace:r.push)(l,a.state,a)},[t,r,i,n,e])}()}function pe(){let{matches:e}=s.useContext(ne),t=e[e.length-1];return t?t.params:{}}function me(e,{relative:t}={}){let{matches:r}=s.useContext(ne),{pathname:a}=ce(),n=JSON.stringify(B(r));return s.useMemo(()=>z(e,JSON.parse(n),a,"path"===t),[e,n,a,t])}function fe(e,t,r,a,n){var i;g(le(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:o}=s.useContext(se),{matches:l}=s.useContext(ne),c=l[l.length-1],u=c?c.params:{},d=c?c.pathname:"/",h=c?c.pathnameBase:"/",p=c&&c.route;{let e=p&&p.path||"";Se(d,!p||e.endsWith("*")||e.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${d}" (under <Route path="${e}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.\n\nPlease change the parent <Route path="${e}"> to <Route path="${"/"===e?"*":`${e}/*`}">.`)}let m,f=ce();if(t){let e="string"==typeof t?x(t):t;g("/"===h||(null==(i=e.pathname)?void 0:i.startsWith(h)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${h}" but pathname "${e.pathname}" was given in the \`location\` prop.`),m=e}else m=f;let w=m.pathname||"/",v=w;if("/"!==h){let e=h.replace(/^\//,"").split("/");v="/"+w.replace(/^\//,"").split("/").slice(e.length).join("/")}let b=_(e,{pathname:v});y(p||null!=b,`No routes matched location "${m.pathname}${m.search}${m.hash}" `),y(null==b||void 0!==b[b.length-1].route.element||void 0!==b[b.length-1].route.Component||void 0!==b[b.length-1].route.lazy,`Matched leaf route at location "${m.pathname}${m.search}${m.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let k=function(e,t=[],r=null,a=null){if(null==e){if(!r)return null;if(r.errors)e=r.matches;else{if(0!==t.length||r.initialized||!(r.matches.length>0))return null;e=r.matches}}let n=e,i=null==r?void 0:r.errors;if(null!=i){let e=n.findIndex(e=>e.route.id&&void 0!==(null==i?void 0:i[e.route.id]));g(e>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(i).join(",")}`),n=n.slice(0,Math.min(n.length,e+1))}let o=!1,l=-1;if(r)for(let s=0;s<n.length;s++){let e=n[s];if((e.route.HydrateFallback||e.route.hydrateFallbackElement)&&(l=s),e.route.id){let{loaderData:t,errors:s}=r,a=e.route.loader&&!t.hasOwnProperty(e.route.id)&&(!s||void 0===s[e.route.id]);if(e.route.lazy||a){o=!0,n=l>=0?n.slice(0,l+1):[n[0]];break}}}let c=r&&a?(e,t)=>{var s,n;a(e,{location:r.location,params:(null==(n=null==(s=r.matches)?void 0:s[0])?void 0:n.params)??{},unstable_pattern:J(r.matches),errorInfo:t})}:void 0;return n.reduceRight((e,a,u)=>{let d,h=!1,p=null,m=null;r&&(d=i&&a.route.id?i[a.route.id]:void 0,p=a.route.errorElement||ye,o&&(l<0&&0===u?(Se("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),h=!0,m=null):l===u&&(h=!0,m=a.route.hydrateFallbackElement||null)));let f=t.concat(n.slice(0,u+1)),g=()=>{let t;return t=d?p:h?m:a.route.Component?s.createElement(a.route.Component,null):a.route.element?a.route.element:e,s.createElement(xe,{match:a,routeContext:{outlet:e,matches:f,isDataRoute:null!=r},children:t})};return r&&(a.route.ErrorBoundary||a.route.errorElement||0===u)?s.createElement(we,{location:r.location,revalidation:r.revalidation,component:p,error:d,children:g(),routeContext:{outlet:null,matches:f,isDataRoute:!0},onError:c}):g()},null)}(b&&b.map(e=>Object.assign({},e,{params:Object.assign({},u,e.params),pathname:F([h,o.encodeLocation?o.encodeLocation(e.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?h:F([h,o.encodeLocation?o.encodeLocation(e.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:e.pathnameBase])})),l,r,a,n);return t&&k?s.createElement(ae.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...m},navigationType:"POP"}},k):k}function ge(){let e=function(){var e;let t=s.useContext(ie),r=function(e){let t=s.useContext(ee);return g(t,_e(e)),t}("useRouteError"),a=ke("useRouteError");if(void 0!==t)return t;return null==(e=r.errors)?void 0:e[a]}(),t=function(e){return null!=e&&"number"==typeof e.status&&"string"==typeof e.statusText&&"boolean"==typeof e.internal&&"data"in e}(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,a="rgba(200,200,200, 0.5)",n={padding:"0.5rem",backgroundColor:a},i={padding:"2px 4px",backgroundColor:a},o=null;return o=s.createElement(s.Fragment,null,s.createElement("p",null,"ðŸ’¿ Hey developer ðŸ‘‹"),s.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",s.createElement("code",{style:i},"ErrorBoundary")," or"," ",s.createElement("code",{style:i},"errorElement")," prop on your route.")),s.createElement(s.Fragment,null,s.createElement("h2",null,"Unexpected Application Error!"),s.createElement("h3",{style:{fontStyle:"italic"}},t),r?s.createElement("pre",{style:n},r):null,o)}s.createContext(null);var ye=s.createElement(ge,null),we=class extends s.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){this.props.onError&&this.props.onError(e,t)}render(){let e=this.state.error;if(this.context&&"object"==typeof e&&e&&"digest"in e&&"string"==typeof e.digest){const t=function(e){if(e.startsWith(`${oe}:ROUTE_ERROR_RESPONSE:{`))try{let t=JSON.parse(e.slice(40));if("object"==typeof t&&t&&"number"==typeof t.status&&"string"==typeof t.statusText)return new H(t.status,t.statusText,t.data)}catch{}}(e.digest);t&&(e=t)}let t=void 0!==e?s.createElement(ne.Provider,{value:this.props.routeContext},s.createElement(ie.Provider,{value:e,children:this.props.component})):this.props.children;return this.context?s.createElement(be,{error:e},t):t}};we.contextType=te;var ve=new WeakMap;function be({children:e,error:t}){let{basename:r}=s.useContext(se);if("object"==typeof t&&t&&"digest"in t&&"string"==typeof t.digest){let e=function(e){if(e.startsWith(`${oe}:REDIRECT:{`))try{let t=JSON.parse(e.slice(28));if("object"==typeof t&&t&&"number"==typeof t.status&&"string"==typeof t.statusText&&"string"==typeof t.location&&"boolean"==typeof t.reloadDocument&&"boolean"==typeof t.replace)return t}catch{}}(t.digest);if(e){let a=ve.get(t);if(a)throw a;let n=Y(e.location,r);if(G&&!ve.get(t)){if(!n.isExternal&&!e.reloadDocument){const r=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(n.to,{replace:e.replace}));throw ve.set(t,r),r}window.location.href=n.absoluteURL||n.to}return s.createElement("meta",{httpEquiv:"refresh",content:`0;url=${n.absoluteURL||n.to}`})}}return e}function xe({routeContext:e,match:t,children:r}){let a=s.useContext(X);return a&&a.static&&a.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=t.route.id),s.createElement(ne.Provider,{value:e},r)}function _e(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function ke(e){let t=function(e){let t=s.useContext(ne);return g(t,_e(e)),t}(e),r=t.matches[t.matches.length-1];return g(r.route.id,`${e} can only be used on routes that contain a unique "id"`),r.route.id}var je={};function Se(e,t,r){t||je[e]||(je[e]=!0,y(!1,r))}function Ee(e){g(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function Ne({basename:e="/",children:t=null,location:r,navigationType:a="POP",navigator:n,static:i=!1,unstable_useTransitions:o}){g(!le(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let l=e.replace(/^\/*/,"/"),c=s.useMemo(()=>({basename:l,navigator:n,static:i,unstable_useTransitions:o,future:{}}),[l,n,i,o]);"string"==typeof r&&(r=x(r));let{pathname:u="/",search:d="",hash:h="",state:p=null,key:m="default"}=r,f=s.useMemo(()=>{let e=U(u,l);return null==e?null:{location:{pathname:e,search:d,hash:h,state:p,key:m},navigationType:a}},[l,u,d,h,p,m,a]);return y(null!=f,`<Router basename="${l}"> is not able to match the URL "${u}${d}${h}" because it does not start with the basename, so the <Router> won't render anything.`),null==f?null:s.createElement(se.Provider,{value:c},s.createElement(ae.Provider,{children:t,value:f}))}function Te({children:e,location:t}){return fe(Re(e),t)}function Re(e,t=[]){let r=[];return s.Children.forEach(e,(e,a)=>{if(!s.isValidElement(e))return;let n=[...t,a];if(e.type===s.Fragment)return void r.push.apply(r,Re(e.props.children,n));g(e.type===Ee,`[${"string"==typeof e.type?e.type:e.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),g(!e.props.index||!e.props.children,"An index route cannot have child routes.");let i={id:e.props.id||n.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,Component:e.props.Component,index:e.props.index,path:e.props.path,middleware:e.props.middleware,loader:e.props.loader,action:e.props.action,hydrateFallbackElement:e.props.hydrateFallbackElement,HydrateFallback:e.props.HydrateFallback,errorElement:e.props.errorElement,ErrorBoundary:e.props.ErrorBoundary,hasErrorBoundary:!0===e.props.hasErrorBoundary||null!=e.props.ErrorBoundary||null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle,lazy:e.props.lazy};e.props.children&&(i.children=Re(e.props.children,n)),r.push(i)}),r}s.memo(function({routes:e,future:t,state:r,onError:s}){return fe(e,void 0,r,s,t)});var Oe="get",Ce="application/x-www-form-urlencoded";function Ae(e){return"undefined"!=typeof HTMLElement&&e instanceof HTMLElement}var Pe=null;var Ie=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function $e(e){return null==e||Ie.has(e)?e:(y(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Ce}"`),null)}function Ue(e,t){let r,s,a,n,i;if(Ae(o=e)&&"form"===o.tagName.toLowerCase()){let i=e.getAttribute("action");s=i?U(i,t):null,r=e.getAttribute("method")||Oe,a=$e(e.getAttribute("enctype"))||Ce,n=new FormData(e)}else if(function(e){return Ae(e)&&"button"===e.tagName.toLowerCase()}(e)||function(e){return Ae(e)&&"input"===e.tagName.toLowerCase()}(e)&&("submit"===e.type||"image"===e.type)){let i=e.form;if(null==i)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let o=e.getAttribute("formaction")||i.getAttribute("action");if(s=o?U(o,t):null,r=e.getAttribute("formmethod")||i.getAttribute("method")||Oe,a=$e(e.getAttribute("formenctype"))||$e(i.getAttribute("enctype"))||Ce,n=new FormData(i,e),!function(){if(null===Pe)try{new FormData(document.createElement("form"),0),Pe=!1}catch(e){Pe=!0}return Pe}()){let{name:t,type:r,value:s}=e;if("image"===r){let e=t?`${t}.`:"";n.append(`${e}x`,"0"),n.append(`${e}y`,"0")}else t&&n.append(t,s)}}else{if(Ae(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');r=Oe,s=null,a=Ce,i=e}var o;return n&&"text/plain"===a&&(i=n,n=void 0),{action:s,method:r.toLowerCase(),encType:a,formData:n,body:i}}function De(e,t){if(!1===e||null==e)throw new Error(t)}function Le(e){return null!=e&&(null==e.href?"preload"===e.rel&&"string"==typeof e.imageSrcSet&&"string"==typeof e.imageSizes:"string"==typeof e.rel&&"string"==typeof e.href)}async function qe(e,t,r){return function(e,t){let r=new Set;return new Set(t),e.reduce((e,t)=>{let s=JSON.stringify(function(e){let t={},r=Object.keys(e).sort();for(let s of r)t[s]=e[s];return t}(t));return r.has(s)||(r.add(s),e.push({key:s,link:t})),e},[])}((await Promise.all(e.map(async e=>{let s=t.routes[e.route.id];if(s){let e=await async function(e,t){if(e.id in t)return t[e.id];try{let r=await import(e.module);return t[e.id]=r,r}catch(r){return window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}(s,r);return e.links?e.links():[]}return[]}))).flat(1).filter(Le).filter(e=>"stylesheet"===e.rel||"preload"===e.rel).map(e=>"stylesheet"===e.rel?{...e,rel:"prefetch",as:"style"}:{...e,rel:"prefetch"}))}function Me(e,t,r,s,a,n){let i=(e,t)=>!r[t]||e.route.id!==r[t].route.id,o=(e,t)=>{var s;return r[t].pathname!==e.pathname||(null==(s=r[t].route.path)?void 0:s.endsWith("*"))&&r[t].params["*"]!==e.params["*"]};return"assets"===n?t.filter((e,t)=>i(e,t)||o(e,t)):"data"===n?t.filter((t,n)=>{var l;let c=s.routes[t.route.id];if(!c||!c.hasLoader)return!1;if(i(t,n)||o(t,n))return!0;if(t.route.shouldRevalidate){let s=t.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:(null==(l=r[0])?void 0:l.params)||{},nextUrl:new URL(e,window.origin),nextParams:t.params,defaultShouldRevalidate:!0});if("boolean"==typeof s)return s}return!0}):[]}function Be(e,t,{includeHydrateFallback:r}={}){return s=e.map(e=>{let s=t.routes[e.route.id];if(!s)return[];let a=[s.module];return s.clientActionModule&&(a=a.concat(s.clientActionModule)),s.clientLoaderModule&&(a=a.concat(s.clientLoaderModule)),r&&s.hydrateFallbackModule&&(a=a.concat(s.hydrateFallbackModule)),s.imports&&(a=a.concat(s.imports)),a}).flat(1),[...new Set(s)];var s}function ze(){let e=s.useContext(X);return De(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var Fe=s.createContext(void 0);function We(){let e=s.useContext(Fe);return De(e,"You must render this element inside a <HydratedRouter> element"),e}function Ve(e,t){return r=>{e&&e(r),r.defaultPrevented||t(r)}}function Ke({page:e,...t}){let{router:r}=ze(),a=s.useMemo(()=>_(r.routes,e,r.basename),[r.routes,e,r.basename]);return a?s.createElement(He,{page:e,matches:a,...t}):null}function He({page:e,matches:t,...r}){let a=ce(),{manifest:n,routeModules:i}=We(),{basename:o}=ze(),{loaderData:l,matches:c}=function(){let e=s.useContext(ee);return De(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}(),u=s.useMemo(()=>Me(e,t,c,n,a,"data"),[e,t,c,n,a]),d=s.useMemo(()=>Me(e,t,c,n,a,"assets"),[e,t,c,n,a]),h=s.useMemo(()=>{if(e===a.pathname+a.search+a.hash)return[];let r=new Set,s=!1;if(t.forEach(e=>{var t;let a=n.routes[e.route.id];a&&a.hasLoader&&(!u.some(t=>t.route.id===e.route.id)&&e.route.id in l&&(null==(t=i[e.route.id])?void 0:t.shouldRevalidate)||a.hasClientLoader?s=!0:r.add(e.route.id))}),0===r.size)return[];let c=function(e,t,r){let s="string"==typeof e?new URL(e,"undefined"==typeof window?"server://singlefetch/":window.location.origin):e;return"/"===s.pathname?s.pathname=`_root.${r}`:t&&"/"===U(s.pathname,t)?s.pathname=`${t.replace(/\/$/,"")}/_root.${r}`:s.pathname=`${s.pathname.replace(/\/$/,"")}.${r}`,s}(e,o,"data");return s&&r.size>0&&c.searchParams.set("_routes",t.filter(e=>r.has(e.route.id)).map(e=>e.route.id).join(",")),[c.pathname+c.search]},[o,l,a,n,u,t,e,i]),p=s.useMemo(()=>Be(d,n),[d,n]),m=function(e){let{manifest:t,routeModules:r}=We(),[a,n]=s.useState([]);return s.useEffect(()=>{let s=!1;return qe(e,t,r).then(e=>{s||n(e)}),()=>{s=!0}},[e,t,r]),a}(d);return s.createElement(s.Fragment,null,h.map(e=>s.createElement("link",{key:e,rel:"prefetch",as:"fetch",href:e,...r})),p.map(e=>s.createElement("link",{key:e,rel:"modulepreload",href:e,...r})),m.map(({key:e,link:t})=>s.createElement("link",{key:e,nonce:r.nonce,...t})))}function Je(...e){return t=>{e.forEach(e=>{"function"==typeof e?e(t):null!=e&&(e.current=t)})}}Fe.displayName="FrameworkContext";var Ge="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement;try{Ge&&(window.__reactRouterVersion="7.11.0")}catch(Al){}function Ye({basename:e,children:t,unstable_useTransitions:r,window:a}){let n=s.useRef();null==n.current&&(n.current=f({window:a,v5Compat:!0}));let i=n.current,[o,l]=s.useState({action:i.action,location:i.location}),c=s.useCallback(e=>{!1===r?l(e):s.startTransition(()=>l(e))},[r]);return s.useLayoutEffect(()=>i.listen(c),[i,c]),s.createElement(Ne,{basename:e,children:t,location:o.location,navigationType:o.action,navigator:i,unstable_useTransitions:r})}var Qe=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Ze=s.forwardRef(function({onClick:e,discover:t="render",prefetch:r="none",relative:a,reloadDocument:n,replace:i,state:o,target:l,to:c,preventScrollReset:u,viewTransition:d,unstable_defaultShouldRevalidate:h,...p},m){let{basename:f,unstable_useTransitions:y}=s.useContext(se),w="string"==typeof c&&Qe.test(c),v=Y(c,f),x=function(e,{relative:t}={}){g(le(),"useHref() may be used only in the context of a <Router> component.");let{basename:r,navigator:a}=s.useContext(se),{hash:n,pathname:i,search:o}=me(e,{relative:t}),l=i;return"/"!==r&&(l="/"===i?r:F([r,i])),a.createHref({pathname:l,search:o,hash:n})}(c=v.to,{relative:a}),[_,k,j]=function(e,t){let r=s.useContext(Fe),[a,n]=s.useState(!1),[i,o]=s.useState(!1),{onFocus:l,onBlur:c,onMouseEnter:u,onMouseLeave:d,onTouchStart:h}=t,p=s.useRef(null);s.useEffect(()=>{if("render"===e&&o(!0),"viewport"===e){let e=new IntersectionObserver(e=>{e.forEach(e=>{o(e.isIntersecting)})},{threshold:.5});return p.current&&e.observe(p.current),()=>{e.disconnect()}}},[e]),s.useEffect(()=>{if(a){let e=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(e)}}},[a]);let m=()=>{n(!0)},f=()=>{n(!1),o(!1)};return r?"intent"!==e?[i,p,{}]:[i,p,{onFocus:Ve(l,m),onBlur:Ve(c,f),onMouseEnter:Ve(u,m),onMouseLeave:Ve(d,f),onTouchStart:Ve(h,m)}]:[!1,p,{}]}(r,p),S=function(e,{target:t,replace:r,state:a,preventScrollReset:n,relative:i,viewTransition:o,unstable_defaultShouldRevalidate:l,unstable_useTransitions:c}={}){let u=he(),d=ce(),h=me(e,{relative:i});return s.useCallback(p=>{if(function(e,t){return!(0!==e.button||t&&"_self"!==t||function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e))}(p,t)){p.preventDefault();let t=void 0!==r?r:b(d)===b(h),m=()=>u(e,{replace:t,state:a,preventScrollReset:n,relative:i,viewTransition:o,unstable_defaultShouldRevalidate:l});c?s.startTransition(()=>m()):m()}},[d,u,h,r,a,t,e,n,i,o,l,c])}(c,{replace:i,state:o,target:l,preventScrollReset:u,relative:a,viewTransition:d,unstable_defaultShouldRevalidate:h,unstable_useTransitions:y});let E=s.createElement("a",{...p,...j,href:v.absoluteURL||x,onClick:v.isExternal||n?e:function(t){e&&e(t),t.defaultPrevented||S(t)},ref:Je(m,k),target:l,"data-discover":w||"render"!==t?void 0:"true"});return _&&!w?s.createElement(s.Fragment,null,E,s.createElement(Ke,{page:x})):E});Ze.displayName="Link",s.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:r="",end:a=!1,style:n,to:i,viewTransition:o,children:l,...c},u){let d=me(i,{relative:c.relative}),h=ce(),p=s.useContext(ee),{navigator:m,basename:f}=s.useContext(se),y=null!=p&&function(e,{relative:t}={}){let r=s.useContext(re);g(null!=r,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:a}=et("useViewTransitionState"),n=me(e,{relative:t});if(!r.isTransitioning)return!1;let i=U(r.currentLocation.pathname,a)||r.currentLocation.pathname,o=U(r.nextLocation.pathname,a)||r.nextLocation.pathname;return null!=I(n.pathname,o)||null!=I(n.pathname,i)}
/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */(d)&&!0===o,w=m.encodeLocation?m.encodeLocation(d).pathname:d.pathname,v=h.pathname,b=p&&p.navigation&&p.navigation.location?p.navigation.location.pathname:null;t||(v=v.toLowerCase(),b=b?b.toLowerCase():null,w=w.toLowerCase()),b&&f&&(b=U(b,f)||b);const x="/"!==w&&w.endsWith("/")?w.length-1:w.length;let _,k=v===w||!a&&v.startsWith(w)&&"/"===v.charAt(x),j=null!=b&&(b===w||!a&&b.startsWith(w)&&"/"===b.charAt(w.length)),S={isActive:k,isPending:j,isTransitioning:y},E=k?e:void 0;_="function"==typeof r?r(S):[r,k?"active":null,j?"pending":null,y?"transitioning":null].filter(Boolean).join(" ");let N="function"==typeof n?n(S):n;return s.createElement(Ze,{...c,"aria-current":E,className:_,ref:u,style:N,to:i,viewTransition:o},"function"==typeof l?l(S):l)}).displayName="NavLink";var Xe=s.forwardRef(({discover:e="render",fetcherKey:t,navigate:r,reloadDocument:a,replace:n,state:i,method:o=Oe,action:l,onSubmit:c,relative:u,preventScrollReset:d,viewTransition:h,unstable_defaultShouldRevalidate:p,...m},f)=>{let{unstable_useTransitions:y}=s.useContext(se),w=function(){let{router:e}=et("useSubmit"),{basename:t}=s.useContext(se),r=ke("useRouteId"),a=e.fetch,n=e.navigate;return s.useCallback(async(e,s={})=>{let{action:i,method:o,encType:l,formData:c,body:u}=Ue(e,t);if(!1===s.navigate){let e=s.fetcherKey||rt();await a(e,r,s.action||i,{unstable_defaultShouldRevalidate:s.unstable_defaultShouldRevalidate,preventScrollReset:s.preventScrollReset,formData:c,body:u,formMethod:s.method||o,formEncType:s.encType||l,flushSync:s.flushSync})}else await n(s.action||i,{unstable_defaultShouldRevalidate:s.unstable_defaultShouldRevalidate,preventScrollReset:s.preventScrollReset,formData:c,body:u,formMethod:s.method||o,formEncType:s.encType||l,replace:s.replace,state:s.state,fromRouteId:r,flushSync:s.flushSync,viewTransition:s.viewTransition})},[a,n,t,r])}(),v=function(e,{relative:t}={}){let{basename:r}=s.useContext(se),a=s.useContext(ne);g(a,"useFormAction must be used inside a RouteContext");let[n]=a.matches.slice(-1),i={...me(e||".",{relative:t})},o=ce();if(null==e){i.search=o.search;let e=new URLSearchParams(i.search),t=e.getAll("index");if(t.some(e=>""===e)){e.delete("index"),t.filter(e=>e).forEach(t=>e.append("index",t));let r=e.toString();i.search=r?`?${r}`:""}}e&&"."!==e||!n.route.index||(i.search=i.search?i.search.replace(/^\?/,"?index&"):"?index");"/"!==r&&(i.pathname="/"===i.pathname?r:F([r,i.pathname]));return b(i)}(l,{relative:u}),x="get"===o.toLowerCase()?"get":"post",_="string"==typeof l&&Qe.test(l);return s.createElement("form",{ref:f,method:x,action:v,onSubmit:a?c:e=>{if(c&&c(e),e.defaultPrevented)return;e.preventDefault();let a=e.nativeEvent.submitter,l=(null==a?void 0:a.getAttribute("formmethod"))||o,m=()=>w(a||e.currentTarget,{fetcherKey:t,method:l,navigate:r,replace:n,state:i,relative:u,preventScrollReset:d,viewTransition:h,unstable_defaultShouldRevalidate:p});y&&!1!==r?s.startTransition(()=>m()):m()},...m,"data-discover":_||"render"!==e?void 0:"true"})});function et(e){let t=s.useContext(X);return g(t,function(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}(e)),t}Xe.displayName="Form";var tt=0,rt=()=>`__${String(++tt)}__`;const st=(...e)=>e.filter((e,t,r)=>Boolean(e)&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim();
/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
var at={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};
/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nt=s.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:a,className:n="",children:i,iconNode:o,...l},c)=>s.createElement("svg",{ref:c,...at,width:t,height:t,stroke:e,strokeWidth:a?24*Number(r)/Number(t):r,className:st("lucide",n),...l},[...o.map(([e,t])=>s.createElement(e,t)),...Array.isArray(i)?i:[i]])),it=(e,t)=>{const r=s.forwardRef(({className:r,...a},n)=>{return s.createElement(nt,{ref:n,iconNode:t,className:st(`lucide-${i=e,i.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,r),...a});var i});return r.displayName=`${e}`,r},ot=it("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]),lt=it("Award",[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]]),ct=it("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]),ut=it("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]),dt=it("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]),ht=it("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),pt=it("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),mt=it("Chrome",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["line",{x1:"21.17",x2:"12",y1:"8",y2:"8",key:"a0cw5f"}],["line",{x1:"3.95",x2:"8.54",y1:"6.06",y2:"14",key:"1kftof"}],["line",{x1:"10.88",x2:"15.46",y1:"21.94",y2:"14",key:"1ymyh8"}]]),ft=it("CirclePlus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]),gt=it("Coins",[["circle",{cx:"8",cy:"8",r:"6",key:"3yglwk"}],["path",{d:"M18.09 10.37A6 6 0 1 1 10.34 18",key:"t5s6rm"}],["path",{d:"M7 6h1v4",key:"1obek4"}],["path",{d:"m16.71 13.88.7.71-2.82 2.82",key:"1rbuyh"}]]),yt=it("Compass",[["path",{d:"m16.24 7.76-1.804 5.411a2 2 0 0 1-1.265 1.265L7.76 16.24l1.804-5.411a2 2 0 0 1 1.265-1.265z",key:"9ktpf1"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),wt=it("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]),vt=it("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]),bt=it("Facebook",[["path",{d:"M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z",key:"1jg4f8"}]]),xt=it("Gift",[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]]),_t=it("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]),kt=it("Instagram",[["rect",{width:"20",height:"20",x:"2",y:"2",rx:"5",ry:"5",key:"2e1cvw"}],["path",{d:"M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z",key:"9exkf1"}],["line",{x1:"17.5",x2:"17.51",y1:"6.5",y2:"6.5",key:"r4j83e"}]]),jt=it("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]),St=it("Linkedin",[["path",{d:"M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z",key:"c2jq9f"}],["rect",{width:"4",height:"12",x:"2",y:"9",key:"mk3on5"}],["circle",{cx:"4",cy:"4",r:"2",key:"bt5ra8"}]]),Et=it("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),Nt=it("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),Tt=it("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]),Rt=it("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]),Ot=it("Map",[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]]),Ct=it("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]),At=it("Newspaper",[["path",{d:"M4 22h16a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v16a2 2 0 0 1-2 2Zm0 0a2 2 0 0 1-2-2v-9c0-1.1.9-2 2-2h2",key:"7pis2x"}],["path",{d:"M18 14h-8",key:"sponae"}],["path",{d:"M15 18h-5",key:"95g1m2"}],["path",{d:"M10 6h8v4h-8V6Z",key:"smlsk5"}]]),Pt=it("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]),It=it("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),$t=it("Quote",[["path",{d:"M16 3a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2 1 1 0 0 1 1 1v1a2 2 0 0 1-2 2 1 1 0 0 0-1 1v2a1 1 0 0 0 1 1 6 6 0 0 0 6-6V5a2 2 0 0 0-2-2z",key:"rib7q0"}],["path",{d:"M5 3a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2 1 1 0 0 1 1 1v1a2 2 0 0 1-2 2 1 1 0 0 0-1 1v2a1 1 0 0 0 1 1 6 6 0 0 0 6-6V5a2 2 0 0 0-2-2z",key:"1ymkrd"}]]),Ut=it("Radar",[["path",{d:"M19.07 4.93A10 10 0 0 0 6.99 3.34",key:"z3du51"}],["path",{d:"M4 6h.01",key:"oypzma"}],["path",{d:"M2.29 9.62A10 10 0 1 0 21.31 8.35",key:"qzzz0"}],["path",{d:"M16.24 7.76A6 6 0 1 0 8.23 16.67",key:"1yjesh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M17.99 11.66A6 6 0 0 1 15.77 16.67",key:"1u2y91"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"m13.41 10.59 5.66-5.66",key:"mhq4k0"}]]),Dt=it("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]),Lt=it("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),qt=it("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),Mt=it("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]),Bt=it("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]),zt=it("Star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]),Ft=it("Ticket",[["path",{d:"M2 9a3 3 0 0 1 0 6v2a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-2a3 3 0 0 1 0-6V7a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z",key:"qn84l0"}],["path",{d:"M13 5v2",key:"dyzc3o"}],["path",{d:"M13 17v2",key:"1ont0d"}],["path",{d:"M13 11v2",key:"1wjjxi"}]]),Wt=it("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),Vt=it("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]),Kt=it("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),Ht=it("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]),Jt=it("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),Gt=it("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]);
/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */function Yt(e,t){var r={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(r[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(s=Object.getOwnPropertySymbols(e);a<s.length;a++)t.indexOf(s[a])<0&&Object.prototype.propertyIsEnumerable.call(e,s[a])&&(r[s[a]]=e[s[a]])}return r}function Qt(e,t,r,s){return new(r||(r=Promise))(function(a,n){function i(e){try{l(s.next(e))}catch(Al){n(Al)}}function o(e){try{l(s.throw(e))}catch(Al){n(Al)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(i,o)}l((s=s.apply(e,t||[])).next())})}"function"==typeof SuppressedError&&SuppressedError;class Zt extends Error{constructor(e,t="FunctionsError",r){super(e),this.name=t,this.context=r}}class Xt extends Zt{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class er extends Zt{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class tr extends Zt{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var rr,sr;(sr=rr||(rr={})).Any="any",sr.ApNortheast1="ap-northeast-1",sr.ApNortheast2="ap-northeast-2",sr.ApSouth1="ap-south-1",sr.ApSoutheast1="ap-southeast-1",sr.ApSoutheast2="ap-southeast-2",sr.CaCentral1="ca-central-1",sr.EuCentral1="eu-central-1",sr.EuWest1="eu-west-1",sr.EuWest2="eu-west-2",sr.EuWest3="eu-west-3",sr.SaEast1="sa-east-1",sr.UsEast1="us-east-1",sr.UsWest1="us-west-1",sr.UsWest2="us-west-2";class ar{constructor(e,{headers:t={},customFetch:r,region:s=rr.Any}={}){this.url=e,this.headers=t,this.region=s,this.fetch=(e=>e?(...t)=>e(...t):(...e)=>fetch(...e))(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){return Qt(this,arguments,void 0,function*(e,t={}){var r;let s,a;try{const{headers:n,method:i,body:o,signal:l,timeout:c}=t;let u={},{region:d}=t;d||(d=this.region);const h=new URL(`${this.url}/${e}`);let p;d&&"any"!==d&&(u["x-region"]=d,h.searchParams.set("forceFunctionRegion",d)),o&&(n&&!Object.prototype.hasOwnProperty.call(n,"Content-Type")||!n)?"undefined"!=typeof Blob&&o instanceof Blob||o instanceof ArrayBuffer?(u["Content-Type"]="application/octet-stream",p=o):"string"==typeof o?(u["Content-Type"]="text/plain",p=o):"undefined"!=typeof FormData&&o instanceof FormData?p=o:(u["Content-Type"]="application/json",p=JSON.stringify(o)):p=o;let m=l;c&&(a=new AbortController,s=setTimeout(()=>a.abort(),c),l?(m=a.signal,l.addEventListener("abort",()=>a.abort())):m=a.signal);const f=yield this.fetch(h.toString(),{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},u),this.headers),n),body:p,signal:m}).catch(e=>{throw new Xt(e)}),g=f.headers.get("x-relay-error");if(g&&"true"===g)throw new er(f);if(!f.ok)throw new tr(f);let y,w=(null!==(r=f.headers.get("Content-Type"))&&void 0!==r?r:"text/plain").split(";")[0].trim();return y="application/json"===w?yield f.json():"application/octet-stream"===w||"application/pdf"===w?yield f.blob():"text/event-stream"===w?f:"multipart/form-data"===w?yield f.formData():yield f.text(),{data:y,error:null,response:f}}catch(n){return{data:null,error:n,response:n instanceof tr||n instanceof er?n.context:void 0}}finally{s&&clearTimeout(s)}})}}var nr=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}},ir=class{constructor(e){var t,r;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=null!==(t=e.shouldThrowOnError)&&void 0!==t&&t,this.signal=e.signal,this.isMaybeSingle=null!==(r=e.isMaybeSingle)&&void 0!==r&&r,e.fetch?this.fetch=e.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=new Headers(this.headers),this.headers.set(e,t),this}then(e,t){var r=this;void 0===this.schema||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),"GET"!==this.method&&"HEAD"!==this.method&&this.headers.set("Content-Type","application/json");let s=(0,this.fetch)(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async e=>{let t=null,s=null,a=null,n=e.status,i=e.statusText;if(e.ok){var o,l;if("HEAD"!==r.method){var c;const t=await e.text();""===t||(s="text/csv"===r.headers.get("Accept")||r.headers.get("Accept")&&(null===(c=r.headers.get("Accept"))||void 0===c?void 0:c.includes("application/vnd.pgrst.plan+text"))?t:JSON.parse(t))}const u=null===(o=r.headers.get("Prefer"))||void 0===o?void 0:o.match(/count=(exact|planned|estimated)/),d=null===(l=e.headers.get("content-range"))||void 0===l?void 0:l.split("/");u&&d&&d.length>1&&(a=parseInt(d[1])),r.isMaybeSingle&&"GET"===r.method&&Array.isArray(s)&&(s.length>1?(t={code:"PGRST116",details:`Results contain ${s.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},s=null,a=null,n=406,i="Not Acceptable"):s=1===s.length?s[0]:null)}else{var u;const a=await e.text();try{t=JSON.parse(a),Array.isArray(t)&&404===e.status&&(s=[],t=null,n=200,i="OK")}catch(d){404===e.status&&""===a?(n=204,i="No Content"):t={message:a}}if(t&&r.isMaybeSingle&&(null==t||null===(u=t.details)||void 0===u?void 0:u.includes("0 rows"))&&(t=null,n=200,i="OK"),t&&r.shouldThrowOnError)throw new nr(t)}return{error:t,data:s,count:a,status:n,statusText:i}});return this.shouldThrowOnError||(s=s.catch(e=>{var t;let r="";const s=null==e?void 0:e.cause;if(s){var a,n,i,o;const t=null!==(a=null==s?void 0:s.message)&&void 0!==a?a:"",l=null!==(n=null==s?void 0:s.code)&&void 0!==n?n:"";r=`${null!==(i=null==e?void 0:e.name)&&void 0!==i?i:"FetchError"}: ${null==e?void 0:e.message}`,r+=`\n\nCaused by: ${null!==(o=null==s?void 0:s.name)&&void 0!==o?o:"Error"}: ${t}`,l&&(r+=` (${l})`),(null==s?void 0:s.stack)&&(r+=`\n${s.stack}`)}else{var l;r=null!==(l=null==e?void 0:e.stack)&&void 0!==l?l:""}return{error:{message:`${null!==(t=null==e?void 0:e.name)&&void 0!==t?t:"FetchError"}: ${null==e?void 0:e.message}`,details:r,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),s.then(e,t)}returns(){return this}overrideTypes(){return this}},or=class extends ir{select(e){let t=!1;const r=(null!=e?e:"*").split("").map(e=>/\s/.test(e)&&!t?"":('"'===e&&(t=!t),e)).join("");return this.url.searchParams.set("select",r),this.headers.append("Prefer","return=representation"),this}order(e,{ascending:t=!0,nullsFirst:r,foreignTable:s,referencedTable:a=s}={}){const n=a?`${a}.order`:"order",i=this.url.searchParams.get(n);return this.url.searchParams.set(n,`${i?`${i},`:""}${e}.${t?"asc":"desc"}${void 0===r?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:r=t}={}){const s=void 0===r?"limit":`${r}.limit`;return this.url.searchParams.set(s,`${e}`),this}range(e,t,{foreignTable:r,referencedTable:s=r}={}){const a=void 0===s?"offset":`${s}.offset`,n=void 0===s?"limit":`${s}.limit`;return this.url.searchParams.set(a,`${e}`),this.url.searchParams.set(n,""+(t-e+1)),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return"GET"===this.method?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:e=!1,verbose:t=!1,settings:r=!1,buffers:s=!1,wal:a=!1,format:n="text"}={}){var i;const o=[e?"analyze":null,t?"verbose":null,r?"settings":null,s?"buffers":null,a?"wal":null].filter(Boolean).join("|"),l=null!==(i=this.headers.get("Accept"))&&void 0!==i?i:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${n}; for="${l}"; options=${o};`),this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${e}`),this}};const lr=new RegExp("[,()]");var cr=class extends or{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}regexMatch(e,t){return this.url.searchParams.append(e,`match.${t}`),this}regexIMatch(e,t){return this.url.searchParams.append(e,`imatch.${t}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}isDistinct(e,t){return this.url.searchParams.append(e,`isdistinct.${t}`),this}in(e,t){const r=Array.from(new Set(t)).map(e=>"string"==typeof e&&lr.test(e)?`"${e}"`:`${e}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}notIn(e,t){const r=Array.from(new Set(t)).map(e=>"string"==typeof e&&lr.test(e)?`"${e}"`:`${e}`).join(",");return this.url.searchParams.append(e,`not.in.(${r})`),this}contains(e,t){return"string"==typeof t?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return"string"==typeof t?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return"string"==typeof t?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:r,type:s}={}){let a="";"plain"===s?a="pl":"phrase"===s?a="ph":"websearch"===s&&(a="w");const n=void 0===r?"":`(${r})`;return this.url.searchParams.append(e,`${a}fts${n}.${t}`),this}match(e){return Object.entries(e).forEach(([e,t])=>{this.url.searchParams.append(e,`eq.${t}`)}),this}not(e,t,r){return this.url.searchParams.append(e,`not.${t}.${r}`),this}or(e,{foreignTable:t,referencedTable:r=t}={}){const s=r?`${r}.or`:"or";return this.url.searchParams.append(s,`(${e})`),this}filter(e,t,r){return this.url.searchParams.append(e,`${t}.${r}`),this}},ur=class{constructor(e,{headers:t={},schema:r,fetch:s}){this.url=e,this.headers=new Headers(t),this.schema=r,this.fetch=s}select(e,t){const{head:r=!1,count:s}=null!=t?t:{},a=r?"HEAD":"GET";let n=!1;const i=(null!=e?e:"*").split("").map(e=>/\s/.test(e)&&!n?"":('"'===e&&(n=!n),e)).join("");return this.url.searchParams.set("select",i),s&&this.headers.append("Prefer",`count=${s}`),new cr({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(e,{count:t,defaultToNull:r=!0}={}){var s;if(t&&this.headers.append("Prefer",`count=${t}`),r||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const t=e.reduce((e,t)=>e.concat(Object.keys(t)),[]);if(t.length>0){const e=[...new Set(t)].map(e=>`"${e}"`);this.url.searchParams.set("columns",e.join(","))}}return new cr({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:null!==(s=this.fetch)&&void 0!==s?s:fetch})}upsert(e,{onConflict:t,ignoreDuplicates:r=!1,count:s,defaultToNull:a=!0}={}){var n;if(this.headers.append("Prefer",`resolution=${r?"ignore":"merge"}-duplicates`),void 0!==t&&this.url.searchParams.set("on_conflict",t),s&&this.headers.append("Prefer",`count=${s}`),a||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const t=e.reduce((e,t)=>e.concat(Object.keys(t)),[]);if(t.length>0){const e=[...new Set(t)].map(e=>`"${e}"`);this.url.searchParams.set("columns",e.join(","))}}return new cr({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:null!==(n=this.fetch)&&void 0!==n?n:fetch})}update(e,{count:t}={}){var r;return t&&this.headers.append("Prefer",`count=${t}`),new cr({method:"PATCH",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:null!==(r=this.fetch)&&void 0!==r?r:fetch})}delete({count:e}={}){var t;return e&&this.headers.append("Prefer",`count=${e}`),new cr({method:"DELETE",url:this.url,headers:this.headers,schema:this.schema,fetch:null!==(t=this.fetch)&&void 0!==t?t:fetch})}},dr=class e{constructor(e,{headers:t={},schema:r,fetch:s}={}){this.url=e,this.headers=new Headers(t),this.schemaName=r,this.fetch=s}from(e){if(!e||"string"!=typeof e||""===e.trim())throw new Error("Invalid relation name: relation must be a non-empty string.");return new ur(new URL(`${this.url}/${e}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new e(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(e,t={},{head:r=!1,get:s=!1,count:a}={}){var n;let i;const o=new URL(`${this.url}/rpc/${e}`);let l;r||s?(i=r?"HEAD":"GET",Object.entries(t).filter(([e,t])=>void 0!==t).map(([e,t])=>[e,Array.isArray(t)?`{${t.join(",")}}`:`${t}`]).forEach(([e,t])=>{o.searchParams.append(e,t)})):(i="POST",l=t);const c=new Headers(this.headers);return a&&c.set("Prefer",`count=${a}`),new cr({method:i,url:o,headers:c,schema:this.schemaName,body:l,fetch:null!==(n=this.fetch)&&void 0!==n?n:fetch})}};class hr{constructor(){}static detectEnvironment(){var e;if("undefined"!=typeof WebSocket)return{type:"native",constructor:WebSocket};if("undefined"!=typeof globalThis&&void 0!==globalThis.WebSocket)return{type:"native",constructor:globalThis.WebSocket};if("undefined"!=typeof global&&void 0!==global.WebSocket)return{type:"native",constructor:global.WebSocket};if("undefined"!=typeof globalThis&&void 0!==globalThis.WebSocketPair&&void 0===globalThis.WebSocket)return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if("undefined"!=typeof globalThis&&globalThis.EdgeRuntime||"undefined"!=typeof navigator&&(null===(e=navigator.userAgent)||void 0===e?void 0:e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if("undefined"!=typeof process){const e=process.versions;if(e&&e.node){const t=e.node,r=parseInt(t.replace(/^v/,"").split(".")[0]);return r>=22?void 0!==globalThis.WebSocket?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${r} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${r} detected without native WebSocket support.`,workaround:'For Node.js < 22, install "ws" package and provide it via the transport option:\nimport ws from "ws"\nnew RealtimeClient(url, { transport: ws })'}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let t=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(t+=`\n\nSuggested solution: ${e.workaround}`),new Error(t)}static createWebSocket(e,t){return new(this.getWebSocketConstructor())(e,t)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return"native"===e.type||"ws"===e.type}catch(e){return!1}}}const pr="1.0.0",mr=pr,fr=1e4;var gr,yr,wr,vr,br,xr,_r,kr,jr,Sr,Er;(yr=gr||(gr={}))[yr.connecting=0]="connecting",yr[yr.open=1]="open",yr[yr.closing=2]="closing",yr[yr.closed=3]="closed",(vr=wr||(wr={})).closed="closed",vr.errored="errored",vr.joined="joined",vr.joining="joining",vr.leaving="leaving",(xr=br||(br={})).close="phx_close",xr.error="phx_error",xr.join="phx_join",xr.reply="phx_reply",xr.leave="phx_leave",xr.access_token="access_token",(_r||(_r={})).websocket="websocket",(jr=kr||(kr={})).Connecting="connecting",jr.Open="open",jr.Closing="closing",jr.Closed="closed";class Nr{constructor(e){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=null!=e?e:[]}encode(e,t){if(e.event===this.BROADCAST_EVENT&&!(e.payload instanceof ArrayBuffer)&&"string"==typeof e.payload.event)return t(this._binaryEncodeUserBroadcastPush(e));let r=[e.join_ref,e.ref,e.topic,e.event,e.payload];return t(JSON.stringify(r))}_binaryEncodeUserBroadcastPush(e){var t;return this._isArrayBuffer(null===(t=e.payload)||void 0===t?void 0:t.payload)?this._encodeBinaryUserBroadcastPush(e):this._encodeJsonUserBroadcastPush(e)}_encodeBinaryUserBroadcastPush(e){var t,r;const s=null!==(r=null===(t=e.payload)||void 0===t?void 0:t.payload)&&void 0!==r?r:new ArrayBuffer(0);return this._encodeUserBroadcastPush(e,this.BINARY_ENCODING,s)}_encodeJsonUserBroadcastPush(e){var t,r;const s=null!==(r=null===(t=e.payload)||void 0===t?void 0:t.payload)&&void 0!==r?r:{},a=(new TextEncoder).encode(JSON.stringify(s)).buffer;return this._encodeUserBroadcastPush(e,this.JSON_ENCODING,a)}_encodeUserBroadcastPush(e,t,r){var s,a;const n=e.topic,i=null!==(s=e.ref)&&void 0!==s?s:"",o=null!==(a=e.join_ref)&&void 0!==a?a:"",l=e.payload.event,c=this.allowedMetadataKeys?this._pick(e.payload,this.allowedMetadataKeys):{},u=0===Object.keys(c).length?"":JSON.stringify(c);if(o.length>255)throw new Error(`joinRef length ${o.length} exceeds maximum of 255`);if(i.length>255)throw new Error(`ref length ${i.length} exceeds maximum of 255`);if(n.length>255)throw new Error(`topic length ${n.length} exceeds maximum of 255`);if(l.length>255)throw new Error(`userEvent length ${l.length} exceeds maximum of 255`);if(u.length>255)throw new Error(`metadata length ${u.length} exceeds maximum of 255`);const d=this.USER_BROADCAST_PUSH_META_LENGTH+o.length+i.length+n.length+l.length+u.length,h=new ArrayBuffer(this.HEADER_LENGTH+d);let p=new DataView(h),m=0;p.setUint8(m++,this.KINDS.userBroadcastPush),p.setUint8(m++,o.length),p.setUint8(m++,i.length),p.setUint8(m++,n.length),p.setUint8(m++,l.length),p.setUint8(m++,u.length),p.setUint8(m++,t),Array.from(o,e=>p.setUint8(m++,e.charCodeAt(0))),Array.from(i,e=>p.setUint8(m++,e.charCodeAt(0))),Array.from(n,e=>p.setUint8(m++,e.charCodeAt(0))),Array.from(l,e=>p.setUint8(m++,e.charCodeAt(0))),Array.from(u,e=>p.setUint8(m++,e.charCodeAt(0)));var f=new Uint8Array(h.byteLength+r.byteLength);return f.set(new Uint8Array(h),0),f.set(new Uint8Array(r),h.byteLength),f.buffer}decode(e,t){if(this._isArrayBuffer(e)){return t(this._binaryDecode(e))}if("string"==typeof e){const r=JSON.parse(e),[s,a,n,i,o]=r;return t({join_ref:s,ref:a,topic:n,event:i,payload:o})}return t({})}_binaryDecode(e){const t=new DataView(e),r=t.getUint8(0),s=new TextDecoder;if(r===this.KINDS.userBroadcast)return this._decodeUserBroadcast(e,t,s)}_decodeUserBroadcast(e,t,r){const s=t.getUint8(1),a=t.getUint8(2),n=t.getUint8(3),i=t.getUint8(4);let o=this.HEADER_LENGTH+4;const l=r.decode(e.slice(o,o+s));o+=s;const c=r.decode(e.slice(o,o+a));o+=a;const u=r.decode(e.slice(o,o+n));o+=n;const d=e.slice(o,e.byteLength),h=i===this.JSON_ENCODING?JSON.parse(r.decode(d)):d,p={type:this.BROADCAST_EVENT,event:c,payload:h};return n>0&&(p.meta=JSON.parse(u)),{join_ref:null,ref:null,topic:l,event:this.BROADCAST_EVENT,payload:p}}_isArrayBuffer(e){var t;return e instanceof ArrayBuffer||"ArrayBuffer"===(null===(t=null==e?void 0:e.constructor)||void 0===t?void 0:t.name)}_pick(e,t){return e&&"object"==typeof e?Object.fromEntries(Object.entries(e).filter(([e])=>t.includes(e))):{}}}class Tr{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}(Er=Sr||(Sr={})).abstime="abstime",Er.bool="bool",Er.date="date",Er.daterange="daterange",Er.float4="float4",Er.float8="float8",Er.int2="int2",Er.int4="int4",Er.int4range="int4range",Er.int8="int8",Er.int8range="int8range",Er.json="json",Er.jsonb="jsonb",Er.money="money",Er.numeric="numeric",Er.oid="oid",Er.reltime="reltime",Er.text="text",Er.time="time",Er.timestamp="timestamp",Er.timestamptz="timestamptz",Er.timetz="timetz",Er.tsrange="tsrange",Er.tstzrange="tstzrange";const Rr=(e,t,r={})=>{var s;const a=null!==(s=r.skipTypes)&&void 0!==s?s:[];return t?Object.keys(t).reduce((r,s)=>(r[s]=Or(s,e,t,a),r),{}):{}},Or=(e,t,r,s)=>{const a=t.find(t=>t.name===e),n=null==a?void 0:a.type,i=r[e];return n&&!s.includes(n)?Cr(n,i):Ar(i)},Cr=(e,t)=>{if("_"===e.charAt(0)){const r=e.slice(1,e.length);return Ur(t,r)}switch(e){case Sr.bool:return Pr(t);case Sr.float4:case Sr.float8:case Sr.int2:case Sr.int4:case Sr.int8:case Sr.numeric:case Sr.oid:return Ir(t);case Sr.json:case Sr.jsonb:return $r(t);case Sr.timestamp:return Dr(t);case Sr.abstime:case Sr.date:case Sr.daterange:case Sr.int4range:case Sr.int8range:case Sr.money:case Sr.reltime:case Sr.text:case Sr.time:case Sr.timestamptz:case Sr.timetz:case Sr.tsrange:case Sr.tstzrange:default:return Ar(t)}},Ar=e=>e,Pr=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},Ir=e=>{if("string"==typeof e){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},$r=e=>{if("string"==typeof e)try{return JSON.parse(e)}catch(t){return e}return e},Ur=(e,t)=>{if("string"!=typeof e)return e;const r=e.length-1,s=e[r];if("{"===e[0]&&"}"===s){let s;const n=e.slice(1,r);try{s=JSON.parse("["+n+"]")}catch(a){s=n?n.split(","):[]}return s.map(e=>Cr(t,e))}return e},Dr=e=>"string"==typeof e?e.replace(" ","T"):e,Lr=e=>{const t=new URL(e);return t.protocol=t.protocol.replace(/^ws/i,"http"),t.pathname=t.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),""===t.pathname||"/"===t.pathname?t.pathname="/api/broadcast":t.pathname=t.pathname+"/api/broadcast",t.href};class qr{constructor(e,t,r={},s=1e4){this.channel=e,this.event=t,this.payload=r,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var r;return this._hasReceived(e)&&t(null===(r=this.receivedResp)||void 0===r?void 0:r.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);this.channel._on(this.refEvent,{},e=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=e,this._matchReceive(e)}),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(t=>t.status===e).forEach(e=>e.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Mr,Br,zr,Fr,Wr,Vr,Kr,Hr;(Br=Mr||(Mr={})).SYNC="sync",Br.JOIN="join",Br.LEAVE="leave";class Jr{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(null==t?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},e=>{const{onJoin:t,onLeave:r,onSync:s}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Jr.syncState(this.state,e,t,r),this.pendingDiffs.forEach(e=>{this.state=Jr.syncDiff(this.state,e,t,r)}),this.pendingDiffs=[],s()}),this.channel._on(r.diff,{},e=>{const{onJoin:t,onLeave:r,onSync:s}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(e):(this.state=Jr.syncDiff(this.state,e,t,r),s())}),this.onJoin((e,t,r)=>{this.channel._trigger("presence",{event:"join",key:e,currentPresences:t,newPresences:r})}),this.onLeave((e,t,r)=>{this.channel._trigger("presence",{event:"leave",key:e,currentPresences:t,leftPresences:r})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,r,s){const a=this.cloneDeep(e),n=this.transformState(t),i={},o={};return this.map(a,(e,t)=>{n[e]||(o[e]=t)}),this.map(n,(e,t)=>{const r=a[e];if(r){const s=t.map(e=>e.presence_ref),a=r.map(e=>e.presence_ref),n=t.filter(e=>a.indexOf(e.presence_ref)<0),l=r.filter(e=>s.indexOf(e.presence_ref)<0);n.length>0&&(i[e]=n),l.length>0&&(o[e]=l)}else i[e]=t}),this.syncDiff(a,{joins:i,leaves:o},r,s)}static syncDiff(e,t,r,s){const{joins:a,leaves:n}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return r||(r=()=>{}),s||(s=()=>{}),this.map(a,(t,s)=>{var a;const n=null!==(a=e[t])&&void 0!==a?a:[];if(e[t]=this.cloneDeep(s),n.length>0){const r=e[t].map(e=>e.presence_ref),s=n.filter(e=>r.indexOf(e.presence_ref)<0);e[t].unshift(...s)}r(t,n,s)}),this.map(n,(t,r)=>{let a=e[t];if(!a)return;const n=r.map(e=>e.presence_ref);a=a.filter(e=>n.indexOf(e.presence_ref)<0),e[t]=a,s(t,a,r),0===a.length&&delete e[t]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(r=>t(r,e[r]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,r)=>{const s=e[r];return t[r]="metas"in s?s.metas.map(e=>(e.presence_ref=e.phx_ref,delete e.phx_ref,delete e.phx_ref_prev,e)):s,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}(Fr=zr||(zr={})).ALL="*",Fr.INSERT="INSERT",Fr.UPDATE="UPDATE",Fr.DELETE="DELETE",(Vr=Wr||(Wr={})).BROADCAST="broadcast",Vr.PRESENCE="presence",Vr.POSTGRES_CHANGES="postgres_changes",Vr.SYSTEM="system",(Hr=Kr||(Kr={})).SUBSCRIBED="SUBSCRIBED",Hr.TIMED_OUT="TIMED_OUT",Hr.CLOSED="CLOSED",Hr.CHANNEL_ERROR="CHANNEL_ERROR";class Gr{constructor(e,t={config:{}},r){var s,a;if(this.topic=e,this.params=t,this.socket=r,this.bindings={},this.state=wr.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new qr(this,br.join,this.params,this.timeout),this.rejoinTimer=new Tr(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=wr.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(e=>e.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=wr.closed,this.socket._remove(this)}),this._onError(e=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,e),this.state=wr.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=wr.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",e=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,e),this.state=wr.errored,this.rejoinTimer.scheduleTimeout())}),this._on(br.reply,{},(e,t)=>{this._trigger(this._replyEventName(t),e)}),this.presence=new Jr(this),this.broadcastEndpointURL=Lr(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(null===(a=null===(s=this.params.config)||void 0===s?void 0:s.broadcast)||void 0===a?void 0:a.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,t=this.timeout){var r,s,a;if(this.socket.isConnected()||this.socket.connect(),this.state==wr.closed){const{config:{broadcast:n,presence:i,private:o}}=this.params,l=null!==(s=null===(r=this.bindings.postgres_changes)||void 0===r?void 0:r.map(e=>e.filter))&&void 0!==s?s:[],c=!!this.bindings[Wr.PRESENCE]&&this.bindings[Wr.PRESENCE].length>0||!0===(null===(a=this.params.config.presence)||void 0===a?void 0:a.enabled),u={},d={broadcast:n,presence:Object.assign(Object.assign({},i),{enabled:c}),postgres_changes:l,private:o};this.socket.accessTokenValue&&(u.access_token=this.socket.accessTokenValue),this._onError(t=>null==e?void 0:e(Kr.CHANNEL_ERROR,t)),this._onClose(()=>null==e?void 0:e(Kr.CLOSED)),this.updateJoinPayload(Object.assign({config:d},u)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:t})=>{var r;if(this.socket._isManualToken()||this.socket.setAuth(),void 0!==t){const s=this.bindings.postgres_changes,a=null!==(r=null==s?void 0:s.length)&&void 0!==r?r:0,n=[];for(let r=0;r<a;r++){const a=s[r],{filter:{event:i,schema:o,table:l,filter:c}}=a,u=t&&t[r];if(!(u&&u.event===i&&Gr.isFilterValueEqual(u.schema,o)&&Gr.isFilterValueEqual(u.table,l)&&Gr.isFilterValueEqual(u.filter,c)))return this.unsubscribe(),this.state=wr.errored,void(null==e||e(Kr.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes")));n.push(Object.assign(Object.assign({},a),{id:u.id}))}return this.bindings.postgres_changes=n,void(e&&e(Kr.SUBSCRIBED))}null==e||e(Kr.SUBSCRIBED)}).receive("error",t=>{this.state=wr.errored,null==e||e(Kr.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(t).join(", ")||"error")))}).receive("timeout",()=>{null==e||e(Kr.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,r){return this.state===wr.joined&&e===Wr.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(e,t,r)}async httpSend(e,t,r={}){var s;if(null==t)return Promise.reject("Payload is required for httpSend()");const a={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(a.Authorization=`Bearer ${this.socket.accessTokenValue}`);const n={method:"POST",headers:a,body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:t,private:this.private}]})},i=await this._fetchWithTimeout(this.broadcastEndpointURL,n,null!==(s=r.timeout)&&void 0!==s?s:this.timeout);if(202===i.status)return{success:!0};let o=i.statusText;try{const e=await i.json();o=e.error||e.message||o}catch(l){}return Promise.reject(new Error(o))}async send(e,t={}){var r,s;if(this._canPush()||"broadcast"!==e.type)return new Promise(r=>{var s,a,n;const i=this._push(e.type,e,t.timeout||this.timeout);"broadcast"!==e.type||(null===(n=null===(a=null===(s=this.params)||void 0===s?void 0:s.config)||void 0===a?void 0:a.broadcast)||void 0===n?void 0:n.ack)||r("ok"),i.receive("ok",()=>r("ok")),i.receive("error",()=>r("error")),i.receive("timeout",()=>r("timed out"))});{const{event:n,payload:i}=e,o={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(o.Authorization=`Bearer ${this.socket.accessTokenValue}`);const l={method:"POST",headers:o,body:JSON.stringify({messages:[{topic:this.subTopic,event:n,payload:i,private:this.private}]})};try{const e=await this._fetchWithTimeout(this.broadcastEndpointURL,l,null!==(r=t.timeout)&&void 0!==r?r:this.timeout);return await(null===(s=e.body)||void 0===s?void 0:s.cancel()),e.ok?"ok":"error"}catch(a){return"AbortError"===a.name?"timed out":"error"}}}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=wr.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(br.close,"leave",this._joinRef())};this.joinPush.destroy();let r=null;return new Promise(s=>{r=new qr(this,br.leave,{},e),r.receive("ok",()=>{t(),s("ok")}).receive("timeout",()=>{t(),s("timed out")}).receive("error",()=>{s("error")}),r.send(),this._canPush()||r.trigger("ok",{})}).finally(()=>{null==r||r.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=wr.closed,this.bindings={}}async _fetchWithTimeout(e,t,r){const s=new AbortController,a=setTimeout(()=>s.abort(),r),n=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:s.signal}));return clearTimeout(a),n}_push(e,t,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new qr(this,e,t,r);return this._canPush()?s.send():this._addToPushBuffer(s),s}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>100){const e=this.pushBuffer.shift();e&&(e.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${e.event}`,e.payload))}}_onMessage(e,t,r){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,r){var s,a;const n=e.toLocaleLowerCase(),{close:i,error:o,leave:l,join:c}=br;if(r&&[i,o,l,c].indexOf(n)>=0&&r!==this._joinRef())return;let u=this._onMessage(n,t,r);if(t&&!u)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(n)?null===(s=this.bindings.postgres_changes)||void 0===s||s.filter(e=>{var t,r,s;return"*"===(null===(t=e.filter)||void 0===t?void 0:t.event)||(null===(s=null===(r=e.filter)||void 0===r?void 0:r.event)||void 0===s?void 0:s.toLocaleLowerCase())===n}).map(e=>e.callback(u,r)):null===(a=this.bindings[n])||void 0===a||a.filter(e=>{var r,s,a,i,o,l;if(["broadcast","presence","postgres_changes"].includes(n)){if("id"in e){const n=e.id,i=null===(r=e.filter)||void 0===r?void 0:r.event;return n&&(null===(s=t.ids)||void 0===s?void 0:s.includes(n))&&("*"===i||(null==i?void 0:i.toLocaleLowerCase())===(null===(a=t.data)||void 0===a?void 0:a.type.toLocaleLowerCase()))}{const r=null===(o=null===(i=null==e?void 0:e.filter)||void 0===i?void 0:i.event)||void 0===o?void 0:o.toLocaleLowerCase();return"*"===r||r===(null===(l=null==t?void 0:t.event)||void 0===l?void 0:l.toLocaleLowerCase())}}return e.type.toLocaleLowerCase()===n}).map(e=>{if("object"==typeof u&&"ids"in u){const e=u.data,{schema:t,table:r,commit_timestamp:s,type:a,errors:n}=e,i={schema:t,table:r,commit_timestamp:s,eventType:a,new:{},old:{},errors:n};u=Object.assign(Object.assign({},i),this._getPayloadRecords(e))}e.callback(u,r)})}_isClosed(){return this.state===wr.closed}_isJoined(){return this.state===wr.joined}_isJoining(){return this.state===wr.joining}_isLeaving(){return this.state===wr.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,r){const s=e.toLocaleLowerCase(),a={type:s,filter:t,callback:r};return this.bindings[s]?this.bindings[s].push(a):this.bindings[s]=[a],this}_off(e,t){const r=e.toLocaleLowerCase();return this.bindings[r]&&(this.bindings[r]=this.bindings[r].filter(e=>{var s;return!((null===(s=e.type)||void 0===s?void 0:s.toLocaleLowerCase())===r&&Gr.isEqual(e.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(e[r]!==t[r])return!1;return!0}static isFilterValueEqual(e,t){return(null!=e?e:void 0)===(null!=t?t:void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(br.close,{},e)}_onError(e){this._on(br.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=wr.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return"INSERT"!==e.type&&"UPDATE"!==e.type||(t.new=Rr(e.columns,e.record)),"UPDATE"!==e.type&&"DELETE"!==e.type||(t.old=Rr(e.columns,e.old_record)),t}}const Yr=()=>{},Qr=25e3,Zr=10,Xr=100,es=[1e3,2e3,5e3,1e4];class ts{constructor(e,t){var r;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=fr,this.transport=null,this.heartbeatIntervalMs=Qr,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Yr,this.ref=0,this.reconnectTimer=null,this.vsn=mr,this.logger=Yr,this.conn=null,this.sendBuffer=[],this.serializer=new Nr,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=e=>e?(...t)=>e(...t):(...e)=>fetch(...e),!(null===(r=null==t?void 0:t.params)||void 0===r?void 0:r.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=t.params.apikey,this.endPoint=`${e}/${_r.websocket}`,this.httpEndpoint=Lr(e),this._initializeOptions(t),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(null==t?void 0:t.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||null!==this.conn&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=hr.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const t=e.message;if(t.includes("Node.js"))throw new Error(`${t}\n\nTo use Realtime in Node.js, you need to provide a WebSocket implementation:\n\nOption 1: Use Node.js 22+ which has native WebSocket support\nOption 2: Install and provide the "ws" package:\n\n  npm install ws\n\n  import ws from "ws"\n  const client = new RealtimeClient(url, {\n    ...options,\n    transport: ws\n  })`);throw new Error(`WebSocket not available: ${t}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(e,t){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const r=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(r),this._setConnectionState("disconnected")},"function"==typeof this.conn.close&&(e?this.conn.close(e,null!=t?t:""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return 0===this.channels.length&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(e=>e.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,r){this.logger(e,t,r)}connectionState(){switch(this.conn&&this.conn.readyState){case gr.connecting:return kr.Connecting;case gr.open:return kr.Open;case gr.closing:return kr.Closing;default:return kr.Closed}}isConnected(){return this.connectionState()===kr.Open}isConnecting(){return"connecting"===this._connectionState}isDisconnecting(){return"disconnecting"===this._connectionState}channel(e,t={config:{}}){const r=`realtime:${e}`,s=this.getChannels().find(e=>e.topic===r);if(s)return s;{const r=new Gr(`realtime:${e}`,t,this);return this.channels.push(r),r}}push(e){const{topic:t,event:r,payload:s,ref:a}=e,n=()=>{this.encode(e,e=>{var t;null===(t=this.conn)||void 0===t||t.send(e)})};this.log("push",`${t} ${r} (${a})`,s),this.isConnected()?n():this.sendBuffer.push(n)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(Al){this.log("error","error in heartbeat callback",Al)}return this._wasManualDisconnect=!1,null===(e=this.conn)||void 0===e||e.close(1e3,"heartbeat timeout"),void setTimeout(()=>{var e;this.isConnected()||null===(e=this.reconnectTimer)||void 0===e||e.scheduleTimeout()},Xr)}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(Al){this.log("error","error in heartbeat callback",Al)}this._setAuthSafely("heartbeat")}else try{this.heartbeatCallback("disconnected")}catch(Al){this.log("error","error in heartbeat callback",Al)}}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(t=>t.topic===e&&(t._isJoined()||t._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,e=>{if("phoenix"===e.topic&&"phx_reply"===e.event)try{this.heartbeatCallback("ok"===e.payload.status?"ok":"error")}catch(Al){this.log("error","error in heartbeat callback",Al)}e.ref&&e.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:t,event:r,payload:s,ref:a}=e,n=a?`(${a})`:"",i=s.status||"";this.log("receive",`${i} ${t} ${r} ${n}`.trim(),s),this.channels.filter(e=>e._isMember(t)).forEach(e=>e._trigger(r,s,a)),this._triggerStateCallbacks("message",e)})}_clearTimer(e){var t;"heartbeat"===e&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):"reconnect"===e&&(null===(t=this.reconnectTimer)||void 0===t||t.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e),this.conn.readyState===gr.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===gr.open||this.conn.readyState===gr.connecting)try{this.conn.close()}catch(Al){this.log("error","Error closing connection",Al)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`);(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(e=>{this.log("error","error waiting for auth on connect",e),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=e=>{this.log("worker","worker error",e.message),this._terminateWorker()},this.workerRef.onmessage=e=>{"keepAlive"===e.data.event&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(e){var t;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||null===(t=this.reconnectTimer)||void 0===t||t.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(br.error))}_appendParams(e,t){if(0===Object.keys(t).length)return e;const r=e.match(/\?/)?"&":"?";return`${e}${r}${new URLSearchParams(t)}`}_workerObjectUrl(e){let t;if(e)t=e;else{const e=new Blob(['\n  addEventListener("message", (e) => {\n    if (e.data.event === "start") {\n      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);\n    }\n  });'],{type:"application/javascript"});t=URL.createObjectURL(e)}return t}_setConnectionState(e,t=!1){this._connectionState=e,"connecting"===e?this._wasManualDisconnect=!1:"disconnecting"===e&&(this._wasManualDisconnect=t)}async _performAuth(e=null){let t,r=!1;if(e)t=e,r=!0;else if(this.accessToken)try{t=await this.accessToken()}catch(Al){this.log("error","Error fetching access token from callback",Al),t=this.accessTokenValue}else t=this.accessTokenValue;r?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(e=>{const r={access_token:t,version:"realtime-js/2.88.0"};t&&e.updateJoinPayload(r),e.joinedOnce&&e._isJoined()&&e._push(br.access_token,{access_token:t})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this._isManualToken()||this.setAuth().catch(t=>{this.log("error",`Error setting auth in ${e}`,t)})}_triggerStateCallbacks(e,t){try{this.stateChangeCallbacks[e].forEach(r=>{try{r(t)}catch(Al){this.log("error",`error in ${e} callback`,Al)}})}catch(Al){this.log("error",`error triggering ${e} callbacks`,Al)}}_setupReconnectionTimer(){this.reconnectTimer=new Tr(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Zr)},this.reconnectAfterMs)}_initializeOptions(e){var t,r,s,a,n,i,o,l,c,u,d,h;switch(this.transport=null!==(t=null==e?void 0:e.transport)&&void 0!==t?t:null,this.timeout=null!==(r=null==e?void 0:e.timeout)&&void 0!==r?r:fr,this.heartbeatIntervalMs=null!==(s=null==e?void 0:e.heartbeatIntervalMs)&&void 0!==s?s:Qr,this.worker=null!==(a=null==e?void 0:e.worker)&&void 0!==a&&a,this.accessToken=null!==(n=null==e?void 0:e.accessToken)&&void 0!==n?n:null,this.heartbeatCallback=null!==(i=null==e?void 0:e.heartbeatCallback)&&void 0!==i?i:Yr,this.vsn=null!==(o=null==e?void 0:e.vsn)&&void 0!==o?o:mr,(null==e?void 0:e.params)&&(this.params=e.params),(null==e?void 0:e.logger)&&(this.logger=e.logger),((null==e?void 0:e.logLevel)||(null==e?void 0:e.log_level))&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=null!==(l=null==e?void 0:e.reconnectAfterMs)&&void 0!==l?l:e=>es[e-1]||1e4,this.vsn){case pr:this.encode=null!==(c=null==e?void 0:e.encode)&&void 0!==c?c:(e,t)=>t(JSON.stringify(e)),this.decode=null!==(u=null==e?void 0:e.decode)&&void 0!==u?u:(e,t)=>t(JSON.parse(e));break;case"2.0.0":this.encode=null!==(d=null==e?void 0:e.encode)&&void 0!==d?d:this.serializer.encode.bind(this.serializer),this.decode=null!==(h=null==e?void 0:e.decode)&&void 0!==h?h:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if("undefined"!=typeof window&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=null==e?void 0:e.workerUrl}}}var rs=class extends Error{constructor(e,t){var r;super(e),this.name="IcebergError",this.status=t.status,this.icebergType=t.icebergType,this.icebergCode=t.icebergCode,this.details=t.details,this.isCommitStateUnknown="CommitStateUnknownException"===t.icebergType||[500,502,504].includes(t.status)&&!0===(null==(r=t.icebergType)?void 0:r.includes("CommitState"))}isNotFound(){return 404===this.status}isConflict(){return 409===this.status}isAuthenticationTimeout(){return 419===this.status}};function ss(e){const t=e.fetchImpl??globalThis.fetch;return{async request({method:r,path:s,query:a,body:n,headers:i}){const o=function(e,t,r){const s=new URL(t,e);if(r)for(const[a,n]of Object.entries(r))void 0!==n&&s.searchParams.set(a,n);return s.toString()}(e.baseUrl,s,a),l=await async function(e){return e&&"none"!==e.type?"bearer"===e.type?{Authorization:`Bearer ${e.token}`}:"header"===e.type?{[e.name]:e.value}:"custom"===e.type?await e.getHeaders():{}:{}}(e.auth),c=await t(o,{method:r,headers:{...n?{"Content-Type":"application/json"}:{},...l,...i},body:n?JSON.stringify(n):void 0}),u=await c.text(),d=(c.headers.get("content-type")||"").includes("application/json"),h=d&&u?JSON.parse(u):u;if(!c.ok){const e=d?h:void 0,t=null==e?void 0:e.error;throw new rs((null==t?void 0:t.message)??`Request failed with status ${c.status}`,{status:c.status,icebergType:null==t?void 0:t.type,icebergCode:null==t?void 0:t.code,details:e})}return{status:c.status,headers:c.headers,data:h}}}}function as(e){return e.join("")}var ns=class{constructor(e,t=""){this.client=e,this.prefix=t}async listNamespaces(e){const t=e?{parent:as(e.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:t})).data.namespaces.map(e=>({namespace:e}))}async createNamespace(e,t){const r={namespace:e.namespace,properties:null==t?void 0:t.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:r})).data}async dropNamespace(e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${as(e.namespace)}`})}async loadNamespaceMetadata(e){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${as(e.namespace)}`})).data.properties}}async namespaceExists(e){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${as(e.namespace)}`}),!0}catch(t){if(t instanceof rs&&404===t.status)return!1;throw t}}async createNamespaceIfNotExists(e,t){try{return await this.createNamespace(e,t)}catch(r){if(r instanceof rs&&409===r.status)return;throw r}}};function is(e){return e.join("")}var os=class{constructor(e,t="",r){this.client=e,this.prefix=t,this.accessDelegation=r}async listTables(e){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${is(e.namespace)}/tables`})).data.identifiers}async createTable(e,t){const r={};this.accessDelegation&&(r["X-Iceberg-Access-Delegation"]=this.accessDelegation);return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${is(e.namespace)}/tables`,body:t,headers:r})).data.metadata}async updateTable(e,t){const r=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${is(e.namespace)}/tables/${e.name}`,body:t});return{"metadata-location":r.data["metadata-location"],metadata:r.data.metadata}}async dropTable(e,t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${is(e.namespace)}/tables/${e.name}`,query:{purgeRequested:String((null==t?void 0:t.purge)??!1)}})}async loadTable(e){const t={};this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation);return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${is(e.namespace)}/tables/${e.name}`,headers:t})).data.metadata}async tableExists(e){const t={};this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${is(e.namespace)}/tables/${e.name}`,headers:t}),!0}catch(r){if(r instanceof rs&&404===r.status)return!1;throw r}}async createTableIfNotExists(e,t){try{return await this.createTable(e,t)}catch(r){if(r instanceof rs&&409===r.status)return await this.loadTable({namespace:e.namespace,name:t.name});throw r}}},ls=class{constructor(e){var t;let r="v1";e.catalogName&&(r+=`/${e.catalogName}`);const s=e.baseUrl.endsWith("/")?e.baseUrl:`${e.baseUrl}/`;this.client=ss({baseUrl:s,auth:e.auth,fetchImpl:e.fetch}),this.accessDelegation=null==(t=e.accessDelegation)?void 0:t.join(","),this.namespaceOps=new ns(this.client,r),this.tableOps=new os(this.client,r,this.accessDelegation)}async listNamespaces(e){return this.namespaceOps.listNamespaces(e)}async createNamespace(e,t){return this.namespaceOps.createNamespace(e,t)}async dropNamespace(e){await this.namespaceOps.dropNamespace(e)}async loadNamespaceMetadata(e){return this.namespaceOps.loadNamespaceMetadata(e)}async listTables(e){return this.tableOps.listTables(e)}async createTable(e,t){return this.tableOps.createTable(e,t)}async updateTable(e,t){return this.tableOps.updateTable(e,t)}async dropTable(e,t){await this.tableOps.dropTable(e,t)}async loadTable(e){return this.tableOps.loadTable(e)}async namespaceExists(e){return this.namespaceOps.namespaceExists(e)}async tableExists(e){return this.tableOps.tableExists(e)}async createNamespaceIfNotExists(e,t){return this.namespaceOps.createNamespaceIfNotExists(e,t)}async createTableIfNotExists(e,t){return this.tableOps.createTableIfNotExists(e,t)}},cs=class extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}};function us(e){return"object"==typeof e&&null!==e&&"__isStorageError"in e}var ds=class extends cs{constructor(e,t,r){super(e),this.name="StorageApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},hs=class extends cs{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}};const ps=e=>e?(...t)=>e(...t):(...e)=>fetch(...e),ms=e=>{if(Array.isArray(e))return e.map(e=>ms(e));if("function"==typeof e||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([e,r])=>{const s=e.replace(/([-_][a-z])/gi,e=>e.toUpperCase().replace(/[-_]/g,""));t[s]=ms(r)}),t};function fs(e){return(fs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function gs(e){var t=function(e,t){if("object"!=fs(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var s=r.call(e,t);if("object"!=fs(s))return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==fs(t)?t:t+""}function ys(e,t,r){return(t=gs(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ws(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,s)}return r}function vs(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ws(Object(r),!0).forEach(function(t){ys(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ws(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}const bs=e=>{var t;return e.msg||e.message||e.error_description||("string"==typeof e.error?e.error:null===(t=e.error)||void 0===t?void 0:t.message)||JSON.stringify(e)},xs=async(e,t,r)=>{e instanceof await Response&&!(null==r?void 0:r.noResolveJson)?e.json().then(r=>{const s=e.status||500,a=(null==r?void 0:r.statusCode)||s+"";t(new ds(bs(r),s,a))}).catch(e=>{t(new hs(bs(e),e))}):t(new hs(bs(e),e))},_s=(e,t,r,s)=>{const a={method:e,headers:(null==t?void 0:t.headers)||{}};return"GET"!==e&&s?((e=>{if("object"!=typeof e||null===e)return!1;const t=Object.getPrototypeOf(e);return!(null!==t&&t!==Object.prototype&&null!==Object.getPrototypeOf(t)||Symbol.toStringTag in e||Symbol.iterator in e)})(s)?(a.headers=vs({"Content-Type":"application/json"},null==t?void 0:t.headers),a.body=JSON.stringify(s)):a.body=s,(null==t?void 0:t.duplex)&&(a.duplex=t.duplex),vs(vs({},a),r)):a};async function ks(e,t,r,s,a,n){return new Promise((i,o)=>{e(r,_s(t,s,a,n)).then(e=>{if(!e.ok)throw e;return(null==s?void 0:s.noResolveJson)?e:e.json()}).then(e=>i(e)).catch(e=>xs(e,o,s))})}async function js(e,t,r,s){return ks(e,"GET",t,r,s)}async function Ss(e,t,r,s,a){return ks(e,"POST",t,s,a,r)}async function Es(e,t,r,s,a){return ks(e,"PUT",t,s,a,r)}async function Ns(e,t,r,s,a){return ks(e,"DELETE",t,s,a,r)}var Ts=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t}then(e,t){return this.execute().then(e,t)}async execute(){try{return{data:(await this.downloadFn()).body,error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(us(e))return{data:null,error:e};throw e}}};let Rs;Rs=Symbol.toStringTag;var Os=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t,this[Rs]="BlobDownloadBuilder",this.promise=null}asStream(){return new Ts(this.downloadFn,this.shouldThrowOnError)}then(e,t){return this.getPromise().then(e,t)}catch(e){return this.getPromise().catch(e)}finally(e){return this.getPromise().finally(e)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){try{return{data:await(await this.downloadFn()).blob(),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(us(e))return{data:null,error:e};throw e}}};const Cs={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},As={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var Ps=class{constructor(e,t={},r,s){this.shouldThrowOnError=!1,this.url=e,this.headers=t,this.bucketId=r,this.fetch=ps(s)}throwOnError(){return this.shouldThrowOnError=!0,this}async uploadOrUpdate(e,t,r,s){var a=this;try{let n;const i=vs(vs({},As),s);let o=vs(vs({},a.headers),"POST"===e&&{"x-upsert":String(i.upsert)});const l=i.metadata;"undefined"!=typeof Blob&&r instanceof Blob?(n=new FormData,n.append("cacheControl",i.cacheControl),l&&n.append("metadata",a.encodeMetadata(l)),n.append("",r)):"undefined"!=typeof FormData&&r instanceof FormData?(n=r,n.has("cacheControl")||n.append("cacheControl",i.cacheControl),l&&!n.has("metadata")&&n.append("metadata",a.encodeMetadata(l))):(n=r,o["cache-control"]=`max-age=${i.cacheControl}`,o["content-type"]=i.contentType,l&&(o["x-metadata"]=a.toBase64(a.encodeMetadata(l))),("undefined"!=typeof ReadableStream&&n instanceof ReadableStream||n&&"object"==typeof n&&"pipe"in n&&"function"==typeof n.pipe)&&!i.duplex&&(i.duplex="half")),(null==s?void 0:s.headers)&&(o=vs(vs({},o),s.headers));const c=a._removeEmptyFolders(t),u=a._getFinalPath(c),d=await("PUT"==e?Es:Ss)(a.fetch,`${a.url}/object/${u}`,n,vs({headers:o},(null==i?void 0:i.duplex)?{duplex:i.duplex}:{}));return{data:{path:c,id:d.Id,fullPath:d.Key},error:null}}catch(n){if(a.shouldThrowOnError)throw n;if(us(n))return{data:null,error:n};throw n}}async upload(e,t,r){return this.uploadOrUpdate("POST",e,t,r)}async uploadToSignedUrl(e,t,r,s){var a=this;const n=a._removeEmptyFolders(e),i=a._getFinalPath(n),o=new URL(a.url+`/object/upload/sign/${i}`);o.searchParams.set("token",t);try{let e;const t=vs({upsert:As.upsert},s),i=vs(vs({},a.headers),{"x-upsert":String(t.upsert)});return"undefined"!=typeof Blob&&r instanceof Blob?(e=new FormData,e.append("cacheControl",t.cacheControl),e.append("",r)):"undefined"!=typeof FormData&&r instanceof FormData?(e=r,e.append("cacheControl",t.cacheControl)):(e=r,i["cache-control"]=`max-age=${t.cacheControl}`,i["content-type"]=t.contentType),{data:{path:n,fullPath:(await Es(a.fetch,o.toString(),e,{headers:i})).Key},error:null}}catch(l){if(a.shouldThrowOnError)throw l;if(us(l))return{data:null,error:l};throw l}}async createSignedUploadUrl(e,t){var r=this;try{let s=r._getFinalPath(e);const a=vs({},r.headers);(null==t?void 0:t.upsert)&&(a["x-upsert"]="true");const n=await Ss(r.fetch,`${r.url}/object/upload/sign/${s}`,{},{headers:a}),i=new URL(r.url+n.url),o=i.searchParams.get("token");if(!o)throw new cs("No token returned by API");return{data:{signedUrl:i.toString(),path:e,token:o},error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(us(s))return{data:null,error:s};throw s}}async update(e,t,r){return this.uploadOrUpdate("PUT",e,t,r)}async move(e,t,r){var s=this;try{return{data:await Ss(s.fetch,`${s.url}/object/move`,{bucketId:s.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null==r?void 0:r.destinationBucket},{headers:s.headers}),error:null}}catch(a){if(s.shouldThrowOnError)throw a;if(us(a))return{data:null,error:a};throw a}}async copy(e,t,r){var s=this;try{return{data:{path:(await Ss(s.fetch,`${s.url}/object/copy`,{bucketId:s.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null==r?void 0:r.destinationBucket},{headers:s.headers})).Key},error:null}}catch(a){if(s.shouldThrowOnError)throw a;if(us(a))return{data:null,error:a};throw a}}async createSignedUrl(e,t,r){var s=this;try{let a=s._getFinalPath(e),n=await Ss(s.fetch,`${s.url}/object/sign/${a}`,vs({expiresIn:t},(null==r?void 0:r.transform)?{transform:r.transform}:{}),{headers:s.headers});const i=(null==r?void 0:r.download)?`&download=${!0===r.download?"":r.download}`:"";return n={signedUrl:encodeURI(`${s.url}${n.signedURL}${i}`)},{data:n,error:null}}catch(a){if(s.shouldThrowOnError)throw a;if(us(a))return{data:null,error:a};throw a}}async createSignedUrls(e,t,r){var s=this;try{const a=await Ss(s.fetch,`${s.url}/object/sign/${s.bucketId}`,{expiresIn:t,paths:e},{headers:s.headers}),n=(null==r?void 0:r.download)?`&download=${!0===r.download?"":r.download}`:"";return{data:a.map(e=>vs(vs({},e),{},{signedUrl:e.signedURL?encodeURI(`${s.url}${e.signedURL}${n}`):null})),error:null}}catch(a){if(s.shouldThrowOnError)throw a;if(us(a))return{data:null,error:a};throw a}}download(e,t){const r=void 0!==(null==t?void 0:t.transform)?"render/image/authenticated":"object",s=this.transformOptsToQueryString((null==t?void 0:t.transform)||{}),a=s?`?${s}`:"",n=this._getFinalPath(e);return new Os(()=>js(this.fetch,`${this.url}/${r}/${n}${a}`,{headers:this.headers,noResolveJson:!0}),this.shouldThrowOnError)}async info(e){var t=this;const r=t._getFinalPath(e);try{return{data:ms(await js(t.fetch,`${t.url}/object/info/${r}`,{headers:t.headers})),error:null}}catch(s){if(t.shouldThrowOnError)throw s;if(us(s))return{data:null,error:s};throw s}}async exists(e){var t=this;const r=t._getFinalPath(e);try{return await async function(e,t,r,s){return ks(e,"HEAD",t,vs(vs({},r),{},{noResolveJson:!0}),s)}(t.fetch,`${t.url}/object/${r}`,{headers:t.headers}),{data:!0,error:null}}catch(s){if(t.shouldThrowOnError)throw s;if(us(s)&&s instanceof hs){const e=s.originalError;if([400,404].includes(null==e?void 0:e.status))return{data:!1,error:s}}throw s}}getPublicUrl(e,t){const r=this._getFinalPath(e),s=[],a=(null==t?void 0:t.download)?`download=${!0===t.download?"":t.download}`:"";""!==a&&s.push(a);const n=void 0!==(null==t?void 0:t.transform)?"render/image":"object",i=this.transformOptsToQueryString((null==t?void 0:t.transform)||{});""!==i&&s.push(i);let o=s.join("&");return""!==o&&(o=`?${o}`),{data:{publicUrl:encodeURI(`${this.url}/${n}/public/${r}${o}`)}}}async remove(e){var t=this;try{return{data:await Ns(t.fetch,`${t.url}/object/${t.bucketId}`,{prefixes:e},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(us(r))return{data:null,error:r};throw r}}async list(e,t,r){var s=this;try{const a=vs(vs(vs({},Cs),t),{},{prefix:e||""});return{data:await Ss(s.fetch,`${s.url}/object/list/${s.bucketId}`,a,{headers:s.headers},r),error:null}}catch(a){if(s.shouldThrowOnError)throw a;if(us(a))return{data:null,error:a};throw a}}async listV2(e,t){var r=this;try{const s=vs({},e);return{data:await Ss(r.fetch,`${r.url}/object/list-v2/${r.bucketId}`,s,{headers:r.headers},t),error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(us(s))return{data:null,error:s};throw s}}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return"undefined"!=typeof Buffer?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}};const Is="2.88.0",$s={"X-Client-Info":`storage-js/${Is}`};var Us=class{constructor(e,t={},r,s){this.shouldThrowOnError=!1;const a=new URL(e);(null==s?void 0:s.useNewHostname)&&/supabase\.(co|in|red)$/.test(a.hostname)&&!a.hostname.includes("storage.supabase.")&&(a.hostname=a.hostname.replace("supabase.","storage.supabase.")),this.url=a.href.replace(/\/$/,""),this.headers=vs(vs({},$s),t),this.fetch=ps(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async listBuckets(e){var t=this;try{const r=t.listBucketOptionsToQueryString(e);return{data:await js(t.fetch,`${t.url}/bucket${r}`,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(us(r))return{data:null,error:r};throw r}}async getBucket(e){var t=this;try{return{data:await js(t.fetch,`${t.url}/bucket/${e}`,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(us(r))return{data:null,error:r};throw r}}async createBucket(e,t={public:!1}){var r=this;try{return{data:await Ss(r.fetch,`${r.url}/bucket`,{id:e,name:e,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:r.headers}),error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(us(s))return{data:null,error:s};throw s}}async updateBucket(e,t){var r=this;try{return{data:await Es(r.fetch,`${r.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:r.headers}),error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(us(s))return{data:null,error:s};throw s}}async emptyBucket(e){var t=this;try{return{data:await Ss(t.fetch,`${t.url}/bucket/${e}/empty`,{},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(us(r))return{data:null,error:r};throw r}}async deleteBucket(e){var t=this;try{return{data:await Ns(t.fetch,`${t.url}/bucket/${e}`,{},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(us(r))return{data:null,error:r};throw r}}listBucketOptionsToQueryString(e){const t={};return e&&("limit"in e&&(t.limit=String(e.limit)),"offset"in e&&(t.offset=String(e.offset)),e.search&&(t.search=e.search),e.sortColumn&&(t.sortColumn=e.sortColumn),e.sortOrder&&(t.sortOrder=e.sortOrder)),Object.keys(t).length>0?"?"+new URLSearchParams(t).toString():""}},Ds=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=vs(vs({},$s),t),this.fetch=ps(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(e){var t=this;try{return{data:await Ss(t.fetch,`${t.url}/bucket`,{name:e},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(us(r))return{data:null,error:r};throw r}}async listBuckets(e){var t=this;try{const r=new URLSearchParams;void 0!==(null==e?void 0:e.limit)&&r.set("limit",e.limit.toString()),void 0!==(null==e?void 0:e.offset)&&r.set("offset",e.offset.toString()),(null==e?void 0:e.sortColumn)&&r.set("sortColumn",e.sortColumn),(null==e?void 0:e.sortOrder)&&r.set("sortOrder",e.sortOrder),(null==e?void 0:e.search)&&r.set("search",e.search);const s=r.toString(),a=s?`${t.url}/bucket?${s}`:`${t.url}/bucket`;return{data:await js(t.fetch,a,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(us(r))return{data:null,error:r};throw r}}async deleteBucket(e){var t=this;try{return{data:await Ns(t.fetch,`${t.url}/bucket/${e}`,{},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(us(r))return{data:null,error:r};throw r}}from(e){var t=this;if(!(e=>!(!e||"string"!=typeof e)&&!(0===e.length||e.length>100)&&e.trim()===e&&!e.includes("/")&&!e.includes("\\")&&/^[\w!.\*'() &$@=;:+,?-]+$/.test(e))(e))throw new cs("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const r=new ls({baseUrl:this.url,catalogName:e,auth:{type:"custom",getHeaders:async()=>t.headers},fetch:this.fetch}),s=this.shouldThrowOnError;return new Proxy(r,{get(e,t){const r=e[t];return"function"!=typeof r?r:async(...t)=>{try{return{data:await r.apply(e,t),error:null}}catch(a){if(s)throw a;return{data:null,error:a}}}}})}};const Ls={"X-Client-Info":`storage-js/${Is}`,"Content-Type":"application/json"};var qs=class extends Error{constructor(e){super(e),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}};function Ms(e){return"object"==typeof e&&null!==e&&"__isStorageVectorsError"in e}var Bs=class extends qs{constructor(e,t,r){super(e),this.name="StorageVectorsApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},zs=class extends qs{constructor(e,t){super(e),this.name="StorageVectorsUnknownError",this.originalError=t}};const Fs=e=>e?(...t)=>e(...t):(...e)=>fetch(...e),Ws=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),Vs=(e,t,r,s)=>{const a={method:e,headers:(null==t?void 0:t.headers)||{}};return s?((e=>{if("object"!=typeof e||null===e)return!1;const t=Object.getPrototypeOf(e);return!(null!==t&&t!==Object.prototype&&null!==Object.getPrototypeOf(t)||Symbol.toStringTag in e||Symbol.iterator in e)})(s)?(a.headers=vs({"Content-Type":"application/json"},null==t?void 0:t.headers),a.body=JSON.stringify(s)):a.body=s,vs(vs({},a),r)):a};async function Ks(e,t,r,s,a,n){return new Promise((i,o)=>{e(r,Vs(t,s,a,n)).then(e=>{if(!e.ok)throw e;if(null==s?void 0:s.noResolveJson)return e;const t=e.headers.get("content-type");return t&&t.includes("application/json")?e.json():{}}).then(e=>i(e)).catch(e=>(async(e,t,r)=>{if(e&&"object"==typeof e&&"status"in e&&"ok"in e&&"number"==typeof e.status&&!(null==r?void 0:r.noResolveJson)){const r=e.status||500,s=e;if("function"==typeof s.json)s.json().then(e=>{const s=(null==e?void 0:e.statusCode)||(null==e?void 0:e.code)||r+"";t(new Bs(Ws(e),r,s))}).catch(()=>{const e=r+"";t(new Bs(s.statusText||`HTTP ${r} error`,r,e))});else{const e=r+"";t(new Bs(s.statusText||`HTTP ${r} error`,r,e))}}else t(new zs(Ws(e),e))})(e,o,s))})}async function Hs(e,t,r,s,a){return Ks(e,"POST",t,s,a,r)}var Js=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=vs(vs({},Ls),t),this.fetch=Fs(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createIndex(e){var t=this;try{return{data:await Hs(t.fetch,`${t.url}/CreateIndex`,e,{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ms(r))return{data:null,error:r};throw r}}async getIndex(e,t){var r=this;try{return{data:await Hs(r.fetch,`${r.url}/GetIndex`,{vectorBucketName:e,indexName:t},{headers:r.headers}),error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(Ms(s))return{data:null,error:s};throw s}}async listIndexes(e){var t=this;try{return{data:await Hs(t.fetch,`${t.url}/ListIndexes`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ms(r))return{data:null,error:r};throw r}}async deleteIndex(e,t){var r=this;try{return{data:await Hs(r.fetch,`${r.url}/DeleteIndex`,{vectorBucketName:e,indexName:t},{headers:r.headers})||{},error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(Ms(s))return{data:null,error:s};throw s}}},Gs=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=vs(vs({},Ls),t),this.fetch=Fs(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async putVectors(e){var t=this;try{if(e.vectors.length<1||e.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:await Hs(t.fetch,`${t.url}/PutVectors`,e,{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ms(r))return{data:null,error:r};throw r}}async getVectors(e){var t=this;try{return{data:await Hs(t.fetch,`${t.url}/GetVectors`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ms(r))return{data:null,error:r};throw r}}async listVectors(e){var t=this;try{if(void 0!==e.segmentCount){if(e.segmentCount<1||e.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(void 0!==e.segmentIndex&&(e.segmentIndex<0||e.segmentIndex>=e.segmentCount))throw new Error("segmentIndex must be between 0 and "+(e.segmentCount-1))}return{data:await Hs(t.fetch,`${t.url}/ListVectors`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ms(r))return{data:null,error:r};throw r}}async queryVectors(e){var t=this;try{return{data:await Hs(t.fetch,`${t.url}/QueryVectors`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ms(r))return{data:null,error:r};throw r}}async deleteVectors(e){var t=this;try{if(e.keys.length<1||e.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:await Hs(t.fetch,`${t.url}/DeleteVectors`,e,{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ms(r))return{data:null,error:r};throw r}}},Ys=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=vs(vs({},Ls),t),this.fetch=Fs(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(e){var t=this;try{return{data:await Hs(t.fetch,`${t.url}/CreateVectorBucket`,{vectorBucketName:e},{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ms(r))return{data:null,error:r};throw r}}async getBucket(e){var t=this;try{return{data:await Hs(t.fetch,`${t.url}/GetVectorBucket`,{vectorBucketName:e},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ms(r))return{data:null,error:r};throw r}}async listBuckets(e={}){var t=this;try{return{data:await Hs(t.fetch,`${t.url}/ListVectorBuckets`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ms(r))return{data:null,error:r};throw r}}async deleteBucket(e){var t=this;try{return{data:await Hs(t.fetch,`${t.url}/DeleteVectorBucket`,{vectorBucketName:e},{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ms(r))return{data:null,error:r};throw r}}},Qs=class extends Ys{constructor(e,t={}){super(e,t.headers||{},t.fetch)}from(e){return new Zs(this.url,this.headers,e,this.fetch)}async createBucket(e){return(()=>super.createBucket)().call(this,e)}async getBucket(e){return(()=>super.getBucket)().call(this,e)}async listBuckets(e={}){return(()=>super.listBuckets)().call(this,e)}async deleteBucket(e){return(()=>super.deleteBucket)().call(this,e)}},Zs=class extends Js{constructor(e,t,r,s){super(e,t,s),this.vectorBucketName=r}async createIndex(e){return(()=>super.createIndex)().call(this,vs(vs({},e),{},{vectorBucketName:this.vectorBucketName}))}async listIndexes(e={}){return(()=>super.listIndexes)().call(this,vs(vs({},e),{},{vectorBucketName:this.vectorBucketName}))}async getIndex(e){return(()=>super.getIndex)().call(this,this.vectorBucketName,e)}async deleteIndex(e){return(()=>super.deleteIndex)().call(this,this.vectorBucketName,e)}index(e){return new Xs(this.url,this.headers,this.vectorBucketName,e,this.fetch)}},Xs=class extends Gs{constructor(e,t,r,s,a){super(e,t,a),this.vectorBucketName=r,this.indexName=s}async putVectors(e){var t=this;return(()=>super.putVectors)().call(t,vs(vs({},e),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async getVectors(e){var t=this;return(()=>super.getVectors)().call(t,vs(vs({},e),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async listVectors(e={}){var t=this;return(()=>super.listVectors)().call(t,vs(vs({},e),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async queryVectors(e){var t=this;return(()=>super.queryVectors)().call(t,vs(vs({},e),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async deleteVectors(e){var t=this;return(()=>super.deleteVectors)().call(t,vs(vs({},e),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}},ea=class extends Us{constructor(e,t={},r,s){super(e,t,r,s)}from(e){return new Ps(this.url,this.headers,e,this.fetch)}get vectors(){return new Qs(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new Ds(this.url+"/iceberg",this.headers,this.fetch)}};const ta="2.88.0",ra=3e4,sa=9e4,aa={"X-Client-Info":`gotrue-js/${ta}`},na="X-Supabase-Api-Version",ia={timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"},oa=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i;class la extends Error{constructor(e,t,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=r}}function ca(e){return"object"==typeof e&&null!==e&&"__isAuthError"in e}class ua extends la{constructor(e,t,r){super(e,t,r),this.name="AuthApiError",this.status=t,this.code=r}}class da extends la{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class ha extends la{constructor(e,t,r,s){super(e,r,s),this.name=t,this.status=r}}class pa extends ha{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}class ma extends ha{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class fa extends ha{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class ga extends ha{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class ya extends ha{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class wa extends ha{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class va extends ha{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function ba(e){return ca(e)&&"AuthRetryableFetchError"===e.name}class xa extends ha{constructor(e,t,r){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=r}}class _a extends ha{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const ka="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),ja=" \t\n\r=".split(""),Sa=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<ja.length;t+=1)e[ja[t].charCodeAt(0)]=-2;for(let t=0;t<ka.length;t+=1)e[ka[t].charCodeAt(0)]=t;return e})();function Ea(e,t,r){if(null!==e)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const e=t.queue>>t.queuedBits-6&63;r(ka[e]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const e=t.queue>>t.queuedBits-6&63;r(ka[e]),t.queuedBits-=6}}function Na(e,t,r){const s=Sa[e];if(!(s>-1)){if(-2===s)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}for(t.queue=t.queue<<6|s,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8}function Ta(e){const t=[],r=e=>{t.push(String.fromCodePoint(e))},s={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},n=e=>{!function(e,t,r){if(0===t.utf8seq){if(e<=127)return void r(e);for(let r=1;r<6;r+=1)if(!(e>>7-r&1)){t.utf8seq=r;break}if(2===t.utf8seq)t.codepoint=31&e;else if(3===t.utf8seq)t.codepoint=15&e;else{if(4!==t.utf8seq)throw new Error("Invalid UTF-8 sequence");t.codepoint=7&e}t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|63&e,t.utf8seq-=1,0===t.utf8seq&&r(t.codepoint)}}(e,s,r)};for(let i=0;i<e.length;i+=1)Na(e.charCodeAt(i),a,n);return t.join("")}function Ra(e,t){if(!(e<=127)){if(e<=2047)return t(192|e>>6),void t(128|63&e);if(e<=65535)return t(224|e>>12),t(128|e>>6&63),void t(128|63&e);if(e<=1114111)return t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),void t(128|63&e);throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}t(e)}function Oa(e){const t=[],r={queue:0,queuedBits:0},s=e=>{t.push(e)};for(let a=0;a<e.length;a+=1)Na(e.charCodeAt(a),r,s);return new Uint8Array(t)}function Ca(e){const t=[];return function(e,t){for(let r=0;r<e.length;r+=1){let s=e.charCodeAt(r);if(s>55295&&s<=56319){const t=1024*(s-55296)&65535;s=65536+(e.charCodeAt(r+1)-56320&65535|t),r+=1}Ra(s,t)}}(e,e=>t.push(e)),new Uint8Array(t)}function Aa(e){const t=[],r={queue:0,queuedBits:0},s=e=>{t.push(e)};return e.forEach(e=>Ea(e,r,s)),Ea(null,r,s),t.join("")}const Pa=()=>"undefined"!=typeof window&&"undefined"!=typeof document,Ia={tested:!1,writable:!1},$a=()=>{if(!Pa())return!1;try{if("object"!=typeof globalThis.localStorage)return!1}catch(Al){return!1}if(Ia.tested)return Ia.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Ia.tested=!0,Ia.writable=!0}catch(Al){Ia.tested=!0,Ia.writable=!1}return Ia.writable};const Ua=e=>e?(...t)=>e(...t):(...e)=>fetch(...e),Da=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},La=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch(s){return r}},qa=async(e,t)=>{await e.removeItem(t)};class Ma{constructor(){this.promise=new Ma.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}function Ba(e){const t=e.split(".");if(3!==t.length)throw new _a("Invalid JWT structure");for(let r=0;r<t.length;r++)if(!oa.test(t[r]))throw new _a("JWT not in base64url format");return{header:JSON.parse(Ta(t[0])),payload:JSON.parse(Ta(t[1])),signature:Oa(t[2]),raw:{header:t[0],payload:t[1]}}}function za(e){return("0"+e.toString(16)).substr(-2)}async function Fa(e){if(!("undefined"!=typeof crypto&&void 0!==crypto.subtle&&"undefined"!=typeof TextEncoder))return e;const t=await async function(e){const t=(new TextEncoder).encode(e),r=await crypto.subtle.digest("SHA-256",t),s=new Uint8Array(r);return Array.from(s).map(e=>String.fromCharCode(e)).join("")}(e);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Wa(e,t,r=!1){const s=function(){const e=new Uint32Array(56);if("undefined"==typeof crypto){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",t=e.length;let r="";for(let s=0;s<56;s++)r+=e.charAt(Math.floor(Math.random()*t));return r}return crypto.getRandomValues(e),Array.from(e,za).join("")}();let a=s;r&&(a+="/PASSWORD_RECOVERY"),await Da(e,`${t}-code-verifier`,a);const n=await Fa(s);return[n,s===n?"plain":"s256"]}Ma.promiseConstructor=Promise;const Va=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;const Ka=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Ha(e){if(!Ka.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Ja(){return new Proxy({},{get:(e,t)=>{if("__isUserNotAvailableProxy"===t)return!0;if("symbol"==typeof t){const e=t.toString();if("Symbol(Symbol.toPrimitive)"===e||"Symbol(Symbol.toStringTag)"===e||"Symbol(util.inspect.custom)"===e)return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${t}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function Ga(e){return JSON.parse(JSON.stringify(e))}const Ya=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),Qa=[502,503,504];async function Za(e){var t,r;if(!("object"==typeof(r=e)&&null!==r&&"status"in r&&"ok"in r&&"json"in r&&"function"==typeof r.json))throw new va(Ya(e),0);if(Qa.includes(e.status))throw new va(Ya(e),e.status);let s,a;try{s=await e.json()}catch(Al){throw new da(Ya(Al),Al)}const n=function(e){const t=e.headers.get(na);if(!t)return null;if(!t.match(Va))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch(Al){return null}}(e);if(n&&n.getTime()>=ia.timestamp&&"object"==typeof s&&s&&"string"==typeof s.code?a=s.code:"object"==typeof s&&s&&"string"==typeof s.error_code&&(a=s.error_code),a){if("weak_password"===a)throw new xa(Ya(s),e.status,(null===(t=s.weak_password)||void 0===t?void 0:t.reasons)||[]);if("session_not_found"===a)throw new pa}else if("object"==typeof s&&s&&"object"==typeof s.weak_password&&s.weak_password&&Array.isArray(s.weak_password.reasons)&&s.weak_password.reasons.length&&s.weak_password.reasons.reduce((e,t)=>e&&"string"==typeof t,!0))throw new xa(Ya(s),e.status,s.weak_password.reasons);throw new ua(Ya(s),e.status||500,a)}async function Xa(e,t,r,s){var a;const n=Object.assign({},null==s?void 0:s.headers);n[na]||(n[na]=ia.name),(null==s?void 0:s.jwt)&&(n.Authorization=`Bearer ${s.jwt}`);const i=null!==(a=null==s?void 0:s.query)&&void 0!==a?a:{};(null==s?void 0:s.redirectTo)&&(i.redirect_to=s.redirectTo);const o=Object.keys(i).length?"?"+new URLSearchParams(i).toString():"",l=await async function(e,t,r,s,a,n){const i=((e,t,r,s)=>{const a={method:e,headers:(null==t?void 0:t.headers)||{}};return"GET"===e?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},null==t?void 0:t.headers),a.body=JSON.stringify(s),Object.assign(Object.assign({},a),r))})(t,s,a,n);let o;try{o=await e(r,Object.assign({},i))}catch(Al){throw new va(Ya(Al),0)}o.ok||await Za(o);if(null==s?void 0:s.noResolveJson)return o;try{return await o.json()}catch(Al){await Za(Al)}}(e,t,r+o,{headers:n,noResolveJson:null==s?void 0:s.noResolveJson},{},null==s?void 0:s.body);return(null==s?void 0:s.xform)?null==s?void 0:s.xform(l):{data:Object.assign({},l),error:null}}function en(e){var t;let r=null;var s;(function(e){return e.access_token&&e.refresh_token&&e.expires_in})(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=(s=e.expires_in,Math.round(Date.now()/1e3)+s)));return{data:{session:r,user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function tn(e){const t=en(e);return!t.error&&e.weak_password&&"object"==typeof e.weak_password&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&"string"==typeof e.weak_password.message&&e.weak_password.reasons.reduce((e,t)=>e&&"string"==typeof t,!0)&&(t.data.weak_password=e.weak_password),t}function rn(e){var t;return{data:{user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function sn(e){return{data:e,error:null}}function an(e){const{action_link:t,email_otp:r,hashed_token:s,redirect_to:a,verification_type:n}=e,i=Yt(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]);return{data:{properties:{action_link:t,email_otp:r,hashed_token:s,redirect_to:a,verification_type:n},user:Object.assign({},i)},error:null}}function nn(e){return e}const on=["global","local","others"];class ln{constructor({url:e="",headers:t={},fetch:r}){this.url=e,this.headers=t,this.fetch=Ua(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e,t=on[0]){if(on.indexOf(t)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${on.join(", ")}`);try{return await Xa(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(r){if(ca(r))return{data:null,error:r};throw r}}async inviteUserByEmail(e,t={}){try{return await Xa(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:rn})}catch(r){if(ca(r))return{data:{user:null},error:r};throw r}}async generateLink(e){try{const{options:t}=e,r=Yt(e,["options"]),s=Object.assign(Object.assign({},r),t);return"newEmail"in r&&(s.new_email=null==r?void 0:r.newEmail,delete s.newEmail),await Xa(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:an,redirectTo:null==t?void 0:t.redirectTo})}catch(t){if(ca(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await Xa(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:rn})}catch(t){if(ca(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,r,s,a,n,i,o;try{const l={nextPage:null,lastPage:0,total:0},c=await Xa(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:null!==(r=null===(t=null==e?void 0:e.page)||void 0===t?void 0:t.toString())&&void 0!==r?r:"",per_page:null!==(a=null===(s=null==e?void 0:e.perPage)||void 0===s?void 0:s.toString())&&void 0!==a?a:""},xform:nn});if(c.error)throw c.error;const u=await c.json(),d=null!==(n=c.headers.get("x-total-count"))&&void 0!==n?n:0,h=null!==(o=null===(i=c.headers.get("link"))||void 0===i?void 0:i.split(","))&&void 0!==o?o:[];return h.length>0&&(h.forEach(e=>{const t=parseInt(e.split(";")[0].split("=")[1].substring(0,1)),r=JSON.parse(e.split(";")[1].split("=")[1]);l[`${r}Page`]=t}),l.total=parseInt(d)),{data:Object.assign(Object.assign({},u),l),error:null}}catch(l){if(ca(l))return{data:{users:[]},error:l};throw l}}async getUserById(e){Ha(e);try{return await Xa(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:rn})}catch(t){if(ca(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){Ha(e);try{return await Xa(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:rn})}catch(r){if(ca(r))return{data:{user:null},error:r};throw r}}async deleteUser(e,t=!1){Ha(e);try{return await Xa(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:rn})}catch(r){if(ca(r))return{data:{user:null},error:r};throw r}}async _listFactors(e){Ha(e.userId);try{const{data:t,error:r}=await Xa(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:e=>({data:{factors:e},error:null})});return{data:t,error:r}}catch(t){if(ca(t))return{data:null,error:t};throw t}}async _deleteFactor(e){Ha(e.userId),Ha(e.id);try{return{data:await Xa(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(ca(t))return{data:null,error:t};throw t}}async _listOAuthClients(e){var t,r,s,a,n,i,o;try{const l={nextPage:null,lastPage:0,total:0},c=await Xa(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:null!==(r=null===(t=null==e?void 0:e.page)||void 0===t?void 0:t.toString())&&void 0!==r?r:"",per_page:null!==(a=null===(s=null==e?void 0:e.perPage)||void 0===s?void 0:s.toString())&&void 0!==a?a:""},xform:nn});if(c.error)throw c.error;const u=await c.json(),d=null!==(n=c.headers.get("x-total-count"))&&void 0!==n?n:0,h=null!==(o=null===(i=c.headers.get("link"))||void 0===i?void 0:i.split(","))&&void 0!==o?o:[];return h.length>0&&(h.forEach(e=>{const t=parseInt(e.split(";")[0].split("=")[1].substring(0,1)),r=JSON.parse(e.split(";")[1].split("=")[1]);l[`${r}Page`]=t}),l.total=parseInt(d)),{data:Object.assign(Object.assign({},u),l),error:null}}catch(l){if(ca(l))return{data:{clients:[]},error:l};throw l}}async _createOAuthClient(e){try{return await Xa(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:e,headers:this.headers,xform:e=>({data:e,error:null})})}catch(t){if(ca(t))return{data:null,error:t};throw t}}async _getOAuthClient(e){try{return await Xa(this.fetch,"GET",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:e=>({data:e,error:null})})}catch(t){if(ca(t))return{data:null,error:t};throw t}}async _updateOAuthClient(e,t){try{return await Xa(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${e}`,{body:t,headers:this.headers,xform:e=>({data:e,error:null})})}catch(r){if(ca(r))return{data:null,error:r};throw r}}async _deleteOAuthClient(e){try{return await Xa(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(t){if(ca(t))return{data:null,error:t};throw t}}async _regenerateOAuthClientSecret(e){try{return await Xa(this.fetch,"POST",`${this.url}/admin/oauth/clients/${e}/regenerate_secret`,{headers:this.headers,xform:e=>({data:e,error:null})})}catch(t){if(ca(t))return{data:null,error:t};throw t}}}function cn(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}const un=!!(globalThis&&$a()&&globalThis.localStorage&&"true"===globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug"));class dn extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class hn extends dn{}async function pn(e,t,r){const s=new globalThis.AbortController;return t>0&&setTimeout(()=>{s.abort()},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,0===t?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:s.signal},async s=>{if(!s){if(0===t)throw new hn(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(un)try{await globalThis.navigator.locks.query()}catch(Al){}return await r()}try{return await r()}finally{}}))}function mn(e){if(!/^0x[a-fA-F0-9]{40}$/.test(e))throw new Error(`@supabase/auth-js: Address "${e}" is invalid.`);return e.toLowerCase()}function fn(e){const t=(new TextEncoder).encode(e);return"0x"+Array.from(t,e=>e.toString(16).padStart(2,"0")).join("")}class gn extends Error{constructor({message:e,code:t,cause:r,name:s}){var a;super(e,{cause:r}),this.__isWebAuthnError=!0,this.name=null!==(a=null!=s?s:r instanceof Error?r.name:void 0)&&void 0!==a?a:"Unknown Error",this.code=t}}class yn extends gn{constructor(e,t){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t,message:e}),this.name="WebAuthnUnknownError",this.originalError=t}}function wn({error:e,options:t}){var r,s,a;const{publicKey:n}=t;if(!n)throw Error("options was missing required publicKey property");if("AbortError"===e.name){if(t.signal instanceof AbortSignal)return new gn({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if("ConstraintError"===e.name){if(!0===(null===(r=n.authenticatorSelection)||void 0===r?void 0:r.requireResidentKey))return new gn({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:e});if("conditional"===t.mediation&&"required"===(null===(s=n.authenticatorSelection)||void 0===s?void 0:s.userVerification))return new gn({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:e});if("required"===(null===(a=n.authenticatorSelection)||void 0===a?void 0:a.userVerification))return new gn({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:e})}else{if("InvalidStateError"===e.name)return new gn({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:e});if("NotAllowedError"===e.name)return new gn({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if("NotSupportedError"===e.name){return 0===n.pubKeyCredParams.filter(e=>"public-key"===e.type).length?new gn({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:e}):new gn({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:e})}if("SecurityError"===e.name){const t=window.location.hostname;if(!Sn(t))return new gn({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e});if(n.rp.id!==t)return new gn({message:`The RP ID "${n.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else if("TypeError"===e.name){if(n.user.id.byteLength<1||n.user.id.byteLength>64)return new gn({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:e})}else if("UnknownError"===e.name)return new gn({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new gn({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}function vn({error:e,options:t}){const{publicKey:r}=t;if(!r)throw Error("options was missing required publicKey property");if("AbortError"===e.name){if(t.signal instanceof AbortSignal)return new gn({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else{if("NotAllowedError"===e.name)return new gn({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if("SecurityError"===e.name){const t=window.location.hostname;if(!Sn(t))return new gn({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e});if(r.rpId!==t)return new gn({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else if("UnknownError"===e.name)return new gn({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new gn({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}const bn=new class{createNewAbortSignal(){if(this.controller){const e=new Error("Cancelling existing WebAuthn API call for new one");e.name="AbortError",this.controller.abort(e)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}};function xn(e){if(!e)throw new Error("Credential creation options are required");if("undefined"!=typeof PublicKeyCredential&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&"function"==typeof PublicKeyCredential.parseCreationOptionsFromJSON)return PublicKeyCredential.parseCreationOptionsFromJSON(e);const{challenge:t,user:r,excludeCredentials:s}=e,a=Yt(e,["challenge","user","excludeCredentials"]),n=Oa(t).buffer,i=Object.assign(Object.assign({},r),{id:Oa(r.id).buffer}),o=Object.assign(Object.assign({},a),{challenge:n,user:i});if(s&&s.length>0){o.excludeCredentials=new Array(s.length);for(let e=0;e<s.length;e++){const t=s[e];o.excludeCredentials[e]=Object.assign(Object.assign({},t),{id:Oa(t.id).buffer,type:t.type||"public-key",transports:t.transports})}}return o}function _n(e){if(!e)throw new Error("Credential request options are required");if("undefined"!=typeof PublicKeyCredential&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&"function"==typeof PublicKeyCredential.parseRequestOptionsFromJSON)return PublicKeyCredential.parseRequestOptionsFromJSON(e);const{challenge:t,allowCredentials:r}=e,s=Yt(e,["challenge","allowCredentials"]),a=Oa(t).buffer,n=Object.assign(Object.assign({},s),{challenge:a});if(r&&r.length>0){n.allowCredentials=new Array(r.length);for(let e=0;e<r.length;e++){const t=r[e];n.allowCredentials[e]=Object.assign(Object.assign({},t),{id:Oa(t.id).buffer,type:t.type||"public-key",transports:t.transports})}}return n}function kn(e){var t;if("toJSON"in e&&"function"==typeof e.toJSON)return e.toJSON();const r=e;return{id:e.id,rawId:e.id,response:{attestationObject:Aa(new Uint8Array(e.response.attestationObject)),clientDataJSON:Aa(new Uint8Array(e.response.clientDataJSON))},type:"public-key",clientExtensionResults:e.getClientExtensionResults(),authenticatorAttachment:null!==(t=r.authenticatorAttachment)&&void 0!==t?t:void 0}}function jn(e){var t;if("toJSON"in e&&"function"==typeof e.toJSON)return e.toJSON();const r=e,s=e.getClientExtensionResults(),a=e.response;return{id:e.id,rawId:e.id,response:{authenticatorData:Aa(new Uint8Array(a.authenticatorData)),clientDataJSON:Aa(new Uint8Array(a.clientDataJSON)),signature:Aa(new Uint8Array(a.signature)),userHandle:a.userHandle?Aa(new Uint8Array(a.userHandle)):void 0},type:"public-key",clientExtensionResults:s,authenticatorAttachment:null!==(t=r.authenticatorAttachment)&&void 0!==t?t:void 0}}function Sn(e){return"localhost"===e||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(e)}function En(){var e,t;return!!(Pa()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&"function"==typeof(null===(e=null===navigator||void 0===navigator?void 0:navigator.credentials)||void 0===e?void 0:e.create)&&"function"==typeof(null===(t=null===navigator||void 0===navigator?void 0:navigator.credentials)||void 0===t?void 0:t.get))}const Nn={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},Tn={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function Rn(...e){const t=e=>null!==e&&"object"==typeof e&&!Array.isArray(e),r=e=>e instanceof ArrayBuffer||ArrayBuffer.isView(e),s={};for(const a of e)if(a)for(const e in a){const n=a[e];if(void 0!==n)if(Array.isArray(n))s[e]=n;else if(r(n))s[e]=n;else if(t(n)){const r=s[e];t(r)?s[e]=Rn(r,n):s[e]=Rn(n)}else s[e]=n}return s}class On{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge({factorId:e,webauthn:t,friendlyName:r,signal:s},a){try{const{data:n,error:i}=await this.client.mfa.challenge({factorId:e,webauthn:t});if(!n)return{data:null,error:i};const o=null!=s?s:bn.createNewAbortSignal();if("create"===n.webauthn.type){const{user:e}=n.webauthn.credential_options.publicKey;e.name||(e.name=`${e.id}:${r}`),e.displayName||(e.displayName=e.name)}switch(n.webauthn.type){case"create":{const t=function(e,t){return Rn(Nn,e,t||{})}(n.webauthn.credential_options.publicKey,null==a?void 0:a.create),{data:r,error:s}=await async function(e){try{const t=await navigator.credentials.create(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new yn("Browser returned unexpected credential type",t)}:{data:null,error:new yn("Empty credential response",t)}}catch(t){return{data:null,error:wn({error:t,options:e})}}}({publicKey:t,signal:o});return r?{data:{factorId:e,challengeId:n.id,webauthn:{type:n.webauthn.type,credential_response:r}},error:null}:{data:null,error:s}}case"request":{const t=function(e,t){return Rn(Tn,e,t||{})}(n.webauthn.credential_options.publicKey,null==a?void 0:a.request),{data:r,error:s}=await async function(e){try{const t=await navigator.credentials.get(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new yn("Browser returned unexpected credential type",t)}:{data:null,error:new yn("Empty credential response",t)}}catch(t){return{data:null,error:vn({error:t,options:e})}}}(Object.assign(Object.assign({},n.webauthn.credential_options),{publicKey:t,signal:o}));return r?{data:{factorId:e,challengeId:n.id,webauthn:{type:n.webauthn.type,credential_response:r}},error:null}:{data:null,error:s}}}}catch(n){return ca(n)?{data:null,error:n}:{data:null,error:new da("Unexpected error in challenge",n)}}}async _verify({challengeId:e,factorId:t,webauthn:r}){return this.client.mfa.verify({factorId:t,challengeId:e,webauthn:r})}async _authenticate({factorId:e,webauthn:{rpId:t=("undefined"!=typeof window?window.location.hostname:void 0),rpOrigins:r=("undefined"!=typeof window?[window.location.origin]:void 0),signal:s}={}},a){if(!t)return{data:null,error:new la("rpId is required for WebAuthn authentication")};try{if(!En())return{data:null,error:new da("Browser does not support WebAuthn",null)};const{data:n,error:i}=await this.challenge({factorId:e,webauthn:{rpId:t,rpOrigins:r},signal:s},{request:a});if(!n)return{data:null,error:i};const{webauthn:o}=n;return this._verify({factorId:e,challengeId:n.challengeId,webauthn:{type:o.type,rpId:t,rpOrigins:r,credential_response:o.credential_response}})}catch(n){return ca(n)?{data:null,error:n}:{data:null,error:new da("Unexpected error in authenticate",n)}}}async _register({friendlyName:e,webauthn:{rpId:t=("undefined"!=typeof window?window.location.hostname:void 0),rpOrigins:r=("undefined"!=typeof window?[window.location.origin]:void 0),signal:s}={}},a){if(!t)return{data:null,error:new la("rpId is required for WebAuthn registration")};try{if(!En())return{data:null,error:new da("Browser does not support WebAuthn",null)};const{data:n,error:i}=await this._enroll({friendlyName:e});if(!n)return await this.client.mfa.listFactors().then(t=>{var r;return null===(r=t.data)||void 0===r?void 0:r.all.find(t=>"webauthn"===t.factor_type&&t.friendly_name===e&&"unverified"!==t.status)}).then(e=>e?this.client.mfa.unenroll({factorId:null==e?void 0:e.id}):void 0),{data:null,error:i};const{data:o,error:l}=await this._challenge({factorId:n.id,friendlyName:n.friendly_name,webauthn:{rpId:t,rpOrigins:r},signal:s},{create:a});return o?this._verify({factorId:n.id,challengeId:o.challengeId,webauthn:{rpId:t,rpOrigins:r,type:o.webauthn.type,credential_response:o.webauthn.credential_response}}):{data:null,error:l}}catch(n){return ca(n)?{data:null,error:n}:{data:null,error:new da("Unexpected error in register",n)}}}}!function(){if("object"!=typeof globalThis)try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch(Al){"undefined"!=typeof self&&(self.globalThis=self)}}();const Cn={url:"http://localhost:9999",storageKey:"supabase.auth.token",autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:aa,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function An(e,t,r){return await r()}const Pn={};class In{get jwks(){var e,t;return null!==(t=null===(e=Pn[this.storageKey])||void 0===e?void 0:e.jwks)&&void 0!==t?t:{keys:[]}}set jwks(e){Pn[this.storageKey]=Object.assign(Object.assign({},Pn[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,t;return null!==(t=null===(e=Pn[this.storageKey])||void 0===e?void 0:e.cachedAt)&&void 0!==t?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Pn[this.storageKey]=Object.assign(Object.assign({},Pn[this.storageKey]),{cachedAt:e})}constructor(e){var t,r,s;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const a=Object.assign(Object.assign({},Cn),e);if(this.storageKey=a.storageKey,this.instanceID=null!==(t=In.nextInstanceID[this.storageKey])&&void 0!==t?t:0,In.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!a.debug,"function"==typeof a.debug&&(this.logger=a.debug),this.instanceID>0&&Pa()){this._logPrefix();this.logDebugMessages}if(this.persistSession=a.persistSession,this.autoRefreshToken=a.autoRefreshToken,this.admin=new ln({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=Ua(a.fetch),this.lock=a.lock||An,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,this.throwOnError=a.throwOnError,a.lock?this.lock=a.lock:this.persistSession&&Pa()&&(null===(r=null===globalThis||void 0===globalThis?void 0:globalThis.navigator)||void 0===r?void 0:r.locks)?this.lock=pn:this.lock=An,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new On(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(a.storage?this.storage=a.storage:$a()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=cn(this.memoryStorage)),a.userStorage&&(this.userStorage=a.userStorage)):(this.memoryStorage={},this.storage=cn(this.memoryStorage)),Pa()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(Al){}null===(s=this.broadcastChannel)||void 0===s||s.addEventListener("message",async e=>{this._debug("received broadcast notification from other tab or client",e),await this._notifyAllSubscribers(e.data.event,e.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(e){if(this.throwOnError&&e&&e.error)throw e.error;return e}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${ta}) ${(new Date).toISOString()}`}_debug(...e){return this.logDebugMessages&&this.logger(this._logPrefix(),...e),this}async initialize(){return this.initializePromise||(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))()),await this.initializePromise}async _initialize(){var e;try{let t={},r="none";if(Pa()&&(t=function(e){const t={},r=new URL(e);if(r.hash&&"#"===r.hash[0])try{new URLSearchParams(r.hash.substring(1)).forEach((e,r)=>{t[r]=e})}catch(Al){}return r.searchParams.forEach((e,r)=>{t[r]=e}),t}(window.location.href),this._isImplicitGrantCallback(t)?r="implicit":await this._isPKCECallback(t)&&(r="pkce")),Pa()&&this.detectSessionInUrl&&"none"!==r){const{data:s,error:a}=await this._getSessionFromURL(t,r);if(a){if(this._debug("#_initialize()","error detecting session from URL",a),function(e){return ca(e)&&"AuthImplicitGrantRedirectError"===e.name}(a)){const t=null===(e=a.details)||void 0===e?void 0:e.code;if("identity_already_exists"===t||"identity_not_found"===t||"single_identity_not_deletable"===t)return{error:a}}return await this._removeSession(),{error:a}}const{session:n,redirectType:i}=s;return this._debug("#_initialize()","detected session in URL",n,"redirect type",i),await this._saveSession(n),setTimeout(async()=>{"recovery"===i?await this._notifyAllSubscribers("PASSWORD_RECOVERY",n):await this._notifyAllSubscribers("SIGNED_IN",n)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return ca(t)?this._returnResult({error:t}):this._returnResult({error:new da("Unexpected error during initialization",t)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,r,s;try{const a=await Xa(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:null!==(r=null===(t=null==e?void 0:e.options)||void 0===t?void 0:t.data)&&void 0!==r?r:{},gotrue_meta_security:{captcha_token:null===(s=null==e?void 0:e.options)||void 0===s?void 0:s.captchaToken}},xform:en}),{data:n,error:i}=a;if(i||!n)return this._returnResult({data:{user:null,session:null},error:i});const o=n.session,l=n.user;return n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",o)),this._returnResult({data:{user:l,session:o},error:null})}catch(a){if(ca(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signUp(e){var t,r,s;try{let a;if("email"in e){const{email:r,password:s,options:n}=e;let i=null,o=null;"pkce"===this.flowType&&([i,o]=await Wa(this.storage,this.storageKey)),a=await Xa(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:null==n?void 0:n.emailRedirectTo,body:{email:r,password:s,data:null!==(t=null==n?void 0:n.data)&&void 0!==t?t:{},gotrue_meta_security:{captcha_token:null==n?void 0:n.captchaToken},code_challenge:i,code_challenge_method:o},xform:en})}else{if(!("phone"in e))throw new fa("You must provide either an email or phone number and a password");{const{phone:t,password:n,options:i}=e;a=await Xa(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:t,password:n,data:null!==(r=null==i?void 0:i.data)&&void 0!==r?r:{},channel:null!==(s=null==i?void 0:i.channel)&&void 0!==s?s:"sms",gotrue_meta_security:{captcha_token:null==i?void 0:i.captchaToken}},xform:en})}}const{data:n,error:i}=a;if(i||!n)return await qa(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:i});const o=n.session,l=n.user;return n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",o)),this._returnResult({data:{user:l,session:o},error:null})}catch(a){if(await qa(this.storage,`${this.storageKey}-code-verifier`),ca(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signInWithPassword(e){try{let t;if("email"in e){const{email:r,password:s,options:a}=e;t=await Xa(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:r,password:s,gotrue_meta_security:{captcha_token:null==a?void 0:a.captchaToken}},xform:tn})}else{if(!("phone"in e))throw new fa("You must provide either an email or phone number and a password");{const{phone:r,password:s,options:a}=e;t=await Xa(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:r,password:s,gotrue_meta_security:{captcha_token:null==a?void 0:a.captchaToken}},xform:tn})}}const{data:r,error:s}=t;if(s)return this._returnResult({data:{user:null,session:null},error:s});if(!r||!r.session||!r.user){const e=new ma;return this._returnResult({data:{user:null,session:null},error:e})}return r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),this._returnResult({data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:s})}catch(t){if(ca(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async signInWithOAuth(e){var t,r,s,a;return await this._handleProviderSignIn(e.provider,{redirectTo:null===(t=e.options)||void 0===t?void 0:t.redirectTo,scopes:null===(r=e.options)||void 0===r?void 0:r.scopes,queryParams:null===(s=e.options)||void 0===s?void 0:s.queryParams,skipBrowserRedirect:null===(a=e.options)||void 0===a?void 0:a.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;switch(t){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${t}"`)}}async signInWithEthereum(e){var t,r,s,a,n,i,o,l,c,u,d;let h,p;if("message"in e)h=e.message,p=e.signature;else{const{chain:u,wallet:d,statement:m,options:f}=e;let g;if(Pa())if("object"==typeof d)g=d;else{const e=window;if(!("ethereum"in e)||"object"!=typeof e.ethereum||!("request"in e.ethereum)||"function"!=typeof e.ethereum.request)throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.");g=e.ethereum}else{if("object"!=typeof d||!(null==f?void 0:f.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");g=d}const y=new URL(null!==(t=null==f?void 0:f.url)&&void 0!==t?t:window.location.href),w=await g.request({method:"eth_requestAccounts"}).then(e=>e).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!w||0===w.length)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const v=mn(w[0]);let b=null===(r=null==f?void 0:f.signInWithEthereum)||void 0===r?void 0:r.chainId;if(!b){const e=await g.request({method:"eth_chainId"});b=parseInt(e,16)}h=function(e){var t;const{chainId:r,domain:s,expirationTime:a,issuedAt:n=new Date,nonce:i,notBefore:o,requestId:l,resources:c,scheme:u,uri:d,version:h}=e;if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!s)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(i&&i.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${i}`);if(!d)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if("1"!==h)throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${h}`);if(null===(t=e.statement)||void 0===t?void 0:t.includes("\n"))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${e.statement}`);const p=`${u?`${u}://${s}`:s} wants you to sign in with your Ethereum account:\n${mn(e.address)}\n\n${e.statement?`${e.statement}\n`:""}`;let m=`URI: ${d}\nVersion: ${h}\nChain ID: ${r}${i?`\nNonce: ${i}`:""}\nIssued At: ${n.toISOString()}`;if(a&&(m+=`\nExpiration Time: ${a.toISOString()}`),o&&(m+=`\nNot Before: ${o.toISOString()}`),l&&(m+=`\nRequest ID: ${l}`),c){let e="\nResources:";for(const t of c){if(!t||"string"!=typeof t)throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${t}`);e+=`\n- ${t}`}m+=e}return`${p}\n${m}`}({domain:y.host,address:v,statement:m,uri:y.href,version:"1",chainId:b,nonce:null===(s=null==f?void 0:f.signInWithEthereum)||void 0===s?void 0:s.nonce,issuedAt:null!==(n=null===(a=null==f?void 0:f.signInWithEthereum)||void 0===a?void 0:a.issuedAt)&&void 0!==n?n:new Date,expirationTime:null===(i=null==f?void 0:f.signInWithEthereum)||void 0===i?void 0:i.expirationTime,notBefore:null===(o=null==f?void 0:f.signInWithEthereum)||void 0===o?void 0:o.notBefore,requestId:null===(l=null==f?void 0:f.signInWithEthereum)||void 0===l?void 0:l.requestId,resources:null===(c=null==f?void 0:f.signInWithEthereum)||void 0===c?void 0:c.resources}),p=await g.request({method:"personal_sign",params:[fn(h),v]})}try{const{data:t,error:r}=await Xa(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:h,signature:p},(null===(u=e.options)||void 0===u?void 0:u.captchaToken)?{gotrue_meta_security:{captcha_token:null===(d=e.options)||void 0===d?void 0:d.captchaToken}}:null),xform:en});if(r)throw r;if(!t||!t.session||!t.user){const e=new ma;return this._returnResult({data:{user:null,session:null},error:e})}return t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),this._returnResult({data:Object.assign({},t),error:r})}catch(m){if(ca(m))return this._returnResult({data:{user:null,session:null},error:m});throw m}}async signInWithSolana(e){var t,r,s,a,n,i,o,l,c,u,d,h;let p,m;if("message"in e)p=e.message,m=e.signature;else{const{chain:d,wallet:h,statement:f,options:g}=e;let y;if(Pa())if("object"==typeof h)y=h;else{const e=window;if(!("solana"in e)||"object"!=typeof e.solana||!("signIn"in e.solana&&"function"==typeof e.solana.signIn||"signMessage"in e.solana&&"function"==typeof e.solana.signMessage))throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.");y=e.solana}else{if("object"!=typeof h||!(null==g?void 0:g.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");y=h}const w=new URL(null!==(t=null==g?void 0:g.url)&&void 0!==t?t:window.location.href);if("signIn"in y&&y.signIn){const e=await y.signIn(Object.assign(Object.assign(Object.assign({issuedAt:(new Date).toISOString()},null==g?void 0:g.signInWithSolana),{version:"1",domain:w.host,uri:w.href}),f?{statement:f}:null));let t;if(Array.isArray(e)&&e[0]&&"object"==typeof e[0])t=e[0];else{if(!(e&&"object"==typeof e&&"signedMessage"in e&&"signature"in e))throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");t=e}if(!("signedMessage"in t&&"signature"in t&&("string"==typeof t.signedMessage||t.signedMessage instanceof Uint8Array)&&t.signature instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields");p="string"==typeof t.signedMessage?t.signedMessage:(new TextDecoder).decode(t.signedMessage),m=t.signature}else{if(!("signMessage"in y&&"function"==typeof y.signMessage&&"publicKey"in y&&"object"==typeof y&&y.publicKey&&"toBase58"in y.publicKey&&"function"==typeof y.publicKey.toBase58))throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");p=[`${w.host} wants you to sign in with your Solana account:`,y.publicKey.toBase58(),...f?["",f,""]:[""],"Version: 1",`URI: ${w.href}`,`Issued At: ${null!==(s=null===(r=null==g?void 0:g.signInWithSolana)||void 0===r?void 0:r.issuedAt)&&void 0!==s?s:(new Date).toISOString()}`,...(null===(a=null==g?void 0:g.signInWithSolana)||void 0===a?void 0:a.notBefore)?[`Not Before: ${g.signInWithSolana.notBefore}`]:[],...(null===(n=null==g?void 0:g.signInWithSolana)||void 0===n?void 0:n.expirationTime)?[`Expiration Time: ${g.signInWithSolana.expirationTime}`]:[],...(null===(i=null==g?void 0:g.signInWithSolana)||void 0===i?void 0:i.chainId)?[`Chain ID: ${g.signInWithSolana.chainId}`]:[],...(null===(o=null==g?void 0:g.signInWithSolana)||void 0===o?void 0:o.nonce)?[`Nonce: ${g.signInWithSolana.nonce}`]:[],...(null===(l=null==g?void 0:g.signInWithSolana)||void 0===l?void 0:l.requestId)?[`Request ID: ${g.signInWithSolana.requestId}`]:[],...(null===(u=null===(c=null==g?void 0:g.signInWithSolana)||void 0===c?void 0:c.resources)||void 0===u?void 0:u.length)?["Resources",...g.signInWithSolana.resources.map(e=>`- ${e}`)]:[]].join("\n");const e=await y.signMessage((new TextEncoder).encode(p),"utf8");if(!(e&&e instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");m=e}}try{const{data:t,error:r}=await Xa(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:p,signature:Aa(m)},(null===(d=e.options)||void 0===d?void 0:d.captchaToken)?{gotrue_meta_security:{captcha_token:null===(h=e.options)||void 0===h?void 0:h.captchaToken}}:null),xform:en});if(r)throw r;if(!t||!t.session||!t.user){const e=new ma;return this._returnResult({data:{user:null,session:null},error:e})}return t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),this._returnResult({data:Object.assign({},t),error:r})}catch(f){if(ca(f))return this._returnResult({data:{user:null,session:null},error:f});throw f}}async _exchangeCodeForSession(e){const t=await La(this.storage,`${this.storageKey}-code-verifier`),[r,s]=(null!=t?t:"").split("/");try{if(!r&&"pkce"===this.flowType)throw new wa;const{data:t,error:a}=await Xa(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:en});if(await qa(this.storage,`${this.storageKey}-code-verifier`),a)throw a;if(!t||!t.session||!t.user){const e=new ma;return this._returnResult({data:{user:null,session:null,redirectType:null},error:e})}return t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),this._returnResult({data:Object.assign(Object.assign({},t),{redirectType:null!=s?s:null}),error:a})}catch(a){if(await qa(this.storage,`${this.storageKey}-code-verifier`),ca(a))return this._returnResult({data:{user:null,session:null,redirectType:null},error:a});throw a}}async signInWithIdToken(e){try{const{options:t,provider:r,token:s,access_token:a,nonce:n}=e,i=await Xa(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:s,access_token:a,nonce:n,gotrue_meta_security:{captcha_token:null==t?void 0:t.captchaToken}},xform:en}),{data:o,error:l}=i;if(l)return this._returnResult({data:{user:null,session:null},error:l});if(!o||!o.session||!o.user){const e=new ma;return this._returnResult({data:{user:null,session:null},error:e})}return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",o.session)),this._returnResult({data:o,error:l})}catch(t){if(ca(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async signInWithOtp(e){var t,r,s,a,n;try{if("email"in e){const{email:s,options:a}=e;let n=null,i=null;"pkce"===this.flowType&&([n,i]=await Wa(this.storage,this.storageKey));const{error:o}=await Xa(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:s,data:null!==(t=null==a?void 0:a.data)&&void 0!==t?t:{},create_user:null===(r=null==a?void 0:a.shouldCreateUser)||void 0===r||r,gotrue_meta_security:{captcha_token:null==a?void 0:a.captchaToken},code_challenge:n,code_challenge_method:i},redirectTo:null==a?void 0:a.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:o})}if("phone"in e){const{phone:t,options:r}=e,{data:i,error:o}=await Xa(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:t,data:null!==(s=null==r?void 0:r.data)&&void 0!==s?s:{},create_user:null===(a=null==r?void 0:r.shouldCreateUser)||void 0===a||a,gotrue_meta_security:{captcha_token:null==r?void 0:r.captchaToken},channel:null!==(n=null==r?void 0:r.channel)&&void 0!==n?n:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:null==i?void 0:i.message_id},error:o})}throw new fa("You must provide either an email or phone number.")}catch(i){if(await qa(this.storage,`${this.storageKey}-code-verifier`),ca(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async verifyOtp(e){var t,r;try{let s,a;"options"in e&&(s=null===(t=e.options)||void 0===t?void 0:t.redirectTo,a=null===(r=e.options)||void 0===r?void 0:r.captchaToken);const{data:n,error:i}=await Xa(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:a}}),redirectTo:s,xform:en});if(i)throw i;if(!n){throw new Error("An error occurred on token verification.")}const o=n.session,l=n.user;return(null==o?void 0:o.access_token)&&(await this._saveSession(o),await this._notifyAllSubscribers("recovery"==e.type?"PASSWORD_RECOVERY":"SIGNED_IN",o)),this._returnResult({data:{user:l,session:o},error:null})}catch(s){if(ca(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signInWithSSO(e){var t,r,s,a,n;try{let i=null,o=null;"pkce"===this.flowType&&([i,o]=await Wa(this.storage,this.storageKey));const l=await Xa(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:null!==(r=null===(t=e.options)||void 0===t?void 0:t.redirectTo)&&void 0!==r?r:void 0}),(null===(s=null==e?void 0:e.options)||void 0===s?void 0:s.captchaToken)?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:o}),headers:this.headers,xform:sn});return(null===(a=l.data)||void 0===a?void 0:a.url)&&Pa()&&!(null===(n=e.options)||void 0===n?void 0:n.skipBrowserRedirect)&&window.location.assign(l.data.url),this._returnResult(l)}catch(i){if(await qa(this.storage,`${this.storageKey}-code-verifier`),ca(i))return this._returnResult({data:null,error:i});throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:r}=e;if(r)throw r;if(!t)throw new pa;const{error:s}=await Xa(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return this._returnResult({data:{user:null,session:null},error:s})})}catch(e){if(ca(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:r,type:s,options:a}=e,{error:n}=await Xa(this.fetch,"POST",t,{headers:this.headers,body:{email:r,type:s,gotrue_meta_security:{captcha_token:null==a?void 0:a.captchaToken}},redirectTo:null==a?void 0:a.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:n})}if("phone"in e){const{phone:r,type:s,options:a}=e,{data:n,error:i}=await Xa(this.fetch,"POST",t,{headers:this.headers,body:{phone:r,type:s,gotrue_meta_security:{captcha_token:null==a?void 0:a.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:null==n?void 0:n.message_id},error:i})}throw new fa("You must provide either an email or phone number and a type")}catch(t){if(ca(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async getSession(){await this.initializePromise;return await this._acquireLock(-1,async()=>this._useSession(async e=>e))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const e=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),r=(async()=>(await e,await t()))();return this.pendingInLock.push((async()=>{try{await r}catch(Al){}})()),r}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const e=t();for(this.pendingInLock.push((async()=>{try{await e}catch(Al){}})()),await e;this.pendingInLock.length;){const e=[...this.pendingInLock];await Promise.all(e),this.pendingInLock.splice(0,e.length)}return await e}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",(new Error).stack);try{let e=null;const t=await La(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),null!==t&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const r=!!e.expires_at&&1e3*e.expires_at-Date.now()<sa;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r){if(this.userStorage){const t=await La(this.userStorage,this.storageKey+"-user");(null==t?void 0:t.user)?e.user=t.user:e.user=Ja()}if(this.storage.isServer&&e.user&&!e.user.__isUserNotAvailableProxy){const t={value:this.suppressGetSessionWarning};e.user=function(e,t){return new Proxy(e,{get:(e,r,s)=>{if("__isInsecureUserWarningProxy"===r)return!0;if("symbol"==typeof r){const t=r.toString();if("Symbol(Symbol.toPrimitive)"===t||"Symbol(Symbol.toStringTag)"===t||"Symbol(util.inspect.custom)"===t||"Symbol(nodejs.util.inspect.custom)"===t)return Reflect.get(e,r,s)}return t.value||"string"!=typeof r||(t.value=!0),Reflect.get(e,r,s)}})}(e.user,t),t.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:e},error:null}}const{data:s,error:a}=await this._callRefreshToken(e.refresh_token);return a?this._returnResult({data:{session:null},error:a}):this._returnResult({data:{session:s},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(e){if(e)return await this._getUser(e);await this.initializePromise;const t=await this._acquireLock(-1,async()=>await this._getUser());return t.data.user&&(this.suppressGetSessionWarning=!0),t}async _getUser(e){try{return e?await Xa(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:rn}):await this._useSession(async e=>{var t,r,s;const{data:a,error:n}=e;if(n)throw n;return(null===(t=a.session)||void 0===t?void 0:t.access_token)||this.hasCustomAuthorizationHeader?await Xa(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:null!==(s=null===(r=a.session)||void 0===r?void 0:r.access_token)&&void 0!==s?s:void 0,xform:rn}):{data:{user:null},error:new pa}})}catch(t){if(ca(t))return function(e){return ca(e)&&"AuthSessionMissingError"===e.name}(t)&&(await this._removeSession(),await qa(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:t});throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async r=>{const{data:s,error:a}=r;if(a)throw a;if(!s.session)throw new pa;const n=s.session;let i=null,o=null;"pkce"===this.flowType&&null!=e.email&&([i,o]=await Wa(this.storage,this.storageKey));const{data:l,error:c}=await Xa(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:null==t?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:i,code_challenge_method:o}),jwt:n.access_token,xform:rn});if(c)throw c;return n.user=l.user,await this._saveSession(n),await this._notifyAllSubscribers("USER_UPDATED",n),this._returnResult({data:{user:n.user},error:null})})}catch(r){if(await qa(this.storage,`${this.storageKey}-code-verifier`),ca(r))return this._returnResult({data:{user:null},error:r});throw r}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new pa;const t=Date.now()/1e3;let r=t,s=!0,a=null;const{payload:n}=Ba(e.access_token);if(n.exp&&(r=n.exp,s=r<=t),s){const{data:t,error:r}=await this._callRefreshToken(e.refresh_token);if(r)return this._returnResult({data:{user:null,session:null},error:r});if(!t)return{data:{user:null,session:null},error:null};a=t}else{const{data:s,error:n}=await this._getUser(e.access_token);if(n)throw n;a={access_token:e.access_token,refresh_token:e.refresh_token,user:s.user,token_type:"bearer",expires_in:r-t,expires_at:r},await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)}return this._returnResult({data:{user:a.user,session:a},error:null})}catch(t){if(ca(t))return this._returnResult({data:{session:null,user:null},error:t});throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var r;if(!e){const{data:s,error:a}=t;if(a)throw a;e=null!==(r=s.session)&&void 0!==r?r:void 0}if(!(null==e?void 0:e.refresh_token))throw new pa;const{data:s,error:a}=await this._callRefreshToken(e.refresh_token);return a?this._returnResult({data:{user:null,session:null},error:a}):s?this._returnResult({data:{user:s.user,session:s},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(t){if(ca(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async _getSessionFromURL(e,t){try{if(!Pa())throw new ga("No browser detected.");if(e.error||e.error_description||e.error_code)throw new ga(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if("pkce"===this.flowType)throw new ya("Not a valid PKCE flow url.");break;case"pkce":if("implicit"===this.flowType)throw new ga("Not a valid implicit grant flow url.")}if("pkce"===t){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new ya("No code detected.");const{data:t,error:r}=await this._exchangeCodeForSession(e.code);if(r)throw r;const s=new URL(window.location.href);return s.searchParams.delete("code"),window.history.replaceState(window.history.state,"",s.toString()),{data:{session:t.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:s,access_token:a,refresh_token:n,expires_in:i,expires_at:o,token_type:l}=e;if(!(a&&i&&n&&l))throw new ga("No session defined in URL");const c=Math.round(Date.now()/1e3),u=parseInt(i);let d=c+u;o&&(d=parseInt(o));const{data:h,error:p}=await this._getUser(a);if(p)throw p;const m={provider_token:r,provider_refresh_token:s,access_token:a,expires_in:u,expires_at:d,refresh_token:n,token_type:l,user:h.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:m,redirectType:e.type},error:null})}catch(r){if(ca(r))return this._returnResult({data:{session:null,redirectType:null},error:r});throw r}}_isImplicitGrantCallback(e){return"function"==typeof this.detectSessionInUrl?this.detectSessionInUrl(new URL(window.location.href),e):Boolean(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await La(this.storage,`${this.storageKey}-code-verifier`);return!(!e.code||!t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var r;const{data:s,error:a}=t;if(a)return this._returnResult({error:a});const n=null===(r=s.session)||void 0===r?void 0:r.access_token;if(n){const{error:t}=await this.admin.signOut(n,e);if(t&&(!function(e){return ca(e)&&"AuthApiError"===e.name}(t)||404!==t.status&&401!==t.status&&403!==t.status))return this._returnResult({error:t})}return"others"!==e&&(await this._removeSession(),await qa(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(e){const t=Symbol("auth-callback"),r={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,r),(async()=>{await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})})(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async t=>{var r,s;try{const{data:{session:s},error:a}=t;if(a)throw a;await(null===(r=this.stateChangeEmitters.get(e))||void 0===r?void 0:r.callback("INITIAL_SESSION",s)),this._debug("INITIAL_SESSION","callback id",e,"session",s)}catch(a){await(null===(s=this.stateChangeEmitters.get(e))||void 0===s?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",a)}})}async resetPasswordForEmail(e,t={}){let r=null,s=null;"pkce"===this.flowType&&([r,s]=await Wa(this.storage,this.storageKey,!0));try{return await Xa(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:s,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(a){if(await qa(this.storage,`${this.storageKey}-code-verifier`),ca(a))return this._returnResult({data:null,error:a});throw a}}async getUserIdentities(){var e;try{const{data:t,error:r}=await this.getUser();if(r)throw r;return this._returnResult({data:{identities:null!==(e=t.user.identities)&&void 0!==e?e:[]},error:null})}catch(t){if(ca(t))return this._returnResult({data:null,error:t});throw t}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var t;try{const{data:r,error:s}=await this._useSession(async t=>{var r,s,a,n,i;const{data:o,error:l}=t;if(l)throw l;const c=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:null===(r=e.options)||void 0===r?void 0:r.redirectTo,scopes:null===(s=e.options)||void 0===s?void 0:s.scopes,queryParams:null===(a=e.options)||void 0===a?void 0:a.queryParams,skipBrowserRedirect:!0});return await Xa(this.fetch,"GET",c,{headers:this.headers,jwt:null!==(i=null===(n=o.session)||void 0===n?void 0:n.access_token)&&void 0!==i?i:void 0})});if(s)throw s;return Pa()&&!(null===(t=e.options)||void 0===t?void 0:t.skipBrowserRedirect)&&window.location.assign(null==r?void 0:r.url),this._returnResult({data:{provider:e.provider,url:null==r?void 0:r.url},error:null})}catch(r){if(ca(r))return this._returnResult({data:{provider:e.provider,url:null},error:r});throw r}}async linkIdentityIdToken(e){return await this._useSession(async t=>{var r;try{const{error:s,data:{session:a}}=t;if(s)throw s;const{options:n,provider:i,token:o,access_token:l,nonce:c}=e,u=await Xa(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:null!==(r=null==a?void 0:a.access_token)&&void 0!==r?r:void 0,body:{provider:i,id_token:o,access_token:l,nonce:c,link_identity:!0,gotrue_meta_security:{captcha_token:null==n?void 0:n.captchaToken}},xform:en}),{data:d,error:h}=u;return h?this._returnResult({data:{user:null,session:null},error:h}):d&&d.session&&d.user?(d.session&&(await this._saveSession(d.session),await this._notifyAllSubscribers("USER_UPDATED",d.session)),this._returnResult({data:d,error:h})):this._returnResult({data:{user:null,session:null},error:new ma})}catch(s){if(await qa(this.storage,`${this.storageKey}-code-verifier`),ca(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}})}async unlinkIdentity(e){try{return await this._useSession(async t=>{var r,s;const{data:a,error:n}=t;if(n)throw n;return await Xa(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:null!==(s=null===(r=a.session)||void 0===r?void 0:r.access_token)&&void 0!==s?s:void 0})})}catch(t){if(ca(t))return this._returnResult({data:null,error:t});throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const a=Date.now();return await(r=async r=>(r>0&&await async function(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}(200*Math.pow(2,r-1)),this._debug(t,"refreshing attempt",r),await Xa(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:en})),s=(e,t)=>{const r=200*Math.pow(2,e);return t&&ba(t)&&Date.now()+r-a<ra},new Promise((e,t)=>{(async()=>{for(let a=0;a<1/0;a++)try{const t=await r(a);if(!s(a,null,t))return void e(t)}catch(Al){if(!s(a,Al))return void t(Al)}})()}))}catch(a){if(this._debug(t,"error",a),ca(a))return this._returnResult({data:{session:null,user:null},error:a});throw a}finally{this._debug(t,"end")}var r,s}_isValidSession(e){return"object"==typeof e&&null!==e&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",r),Pa()&&!t.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e,t;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const a=await La(this.storage,this.storageKey);if(a&&this.userStorage){let t=await La(this.userStorage,this.storageKey+"-user");this.storage.isServer||!Object.is(this.storage,this.userStorage)||t||(t={user:a.user},await Da(this.userStorage,this.storageKey+"-user",t)),a.user=null!==(e=null==t?void 0:t.user)&&void 0!==e?e:Ja()}else if(a&&!a.user&&!a.user){const e=await La(this.storage,this.storageKey+"-user");e&&(null==e?void 0:e.user)?(a.user=e.user,await qa(this.storage,this.storageKey+"-user"),await Da(this.storage,this.storageKey,a)):a.user=Ja()}if(this._debug(r,"session from storage",a),!this._isValidSession(a))return this._debug(r,"session is not valid"),void(null!==a&&await this._removeSession());const n=1e3*(null!==(t=a.expires_at)&&void 0!==t?t:1/0)-Date.now()<sa;if(this._debug(r,`session has${n?"":" not"} expired with margin of 90000s`),n){if(this.autoRefreshToken&&a.refresh_token){const{error:e}=await this._callRefreshToken(a.refresh_token);e&&(ba(e)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",e),await this._removeSession()))}}else if(a.user&&!0===a.user.__isUserNotAvailableProxy)try{const{data:e,error:t}=await this._getUser(a.access_token);!t&&(null==e?void 0:e.user)?(a.user=e.user,await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)):this._debug(r,"could not get user data, skipping SIGNED_IN notification")}catch(s){this._debug(r,"error getting user data, skipping SIGNED_IN notification",s)}else await this._notifyAllSubscribers("SIGNED_IN",a)}catch(a){return void this._debug(r,"error",a)}finally{this._debug(r,"end")}}async _callRefreshToken(e){var t,r;if(!e)throw new pa;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new Ma;const{data:t,error:r}=await this._refreshAccessToken(e);if(r)throw r;if(!t.session)throw new pa;await this._saveSession(t.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",t.session);const s={data:t.session,error:null};return this.refreshingDeferred.resolve(s),s}catch(a){if(this._debug(s,"error",a),ca(a)){const e={data:null,error:a};return ba(a)||await this._removeSession(),null===(t=this.refreshingDeferred)||void 0===t||t.resolve(e),e}throw null===(r=this.refreshingDeferred)||void 0===r||r.reject(a),a}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(e,t,r=!0){const s=`#_notifyAllSubscribers(${e})`;this._debug(s,"begin",t,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:t});const s=[],a=Array.from(this.stateChangeEmitters.values()).map(async r=>{try{await r.callback(e,t)}catch(Al){s.push(Al)}});if(await Promise.all(a),s.length>0){for(let e=0;e<s.length;e+=1);throw s[0]}}finally{this._debug(s,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await qa(this.storage,`${this.storageKey}-code-verifier`);const t=Object.assign({},e),r=t.user&&!0===t.user.__isUserNotAvailableProxy;if(this.userStorage){!r&&t.user&&await Da(this.userStorage,this.storageKey+"-user",{user:t.user});const e=Object.assign({},t);delete e.user;const s=Ga(e);await Da(this.storage,this.storageKey,s)}else{const e=Ga(t);await Da(this.storage,this.storageKey,e)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await qa(this.storage,this.storageKey),await qa(this.storage,this.storageKey+"-code-verifier"),await qa(this.storage,this.storageKey+"-user"),this.userStorage&&await qa(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Pa()&&(null===window||void 0===window?void 0:window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(Al){}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),ra);this.autoRefreshTicker=e,e&&"object"==typeof e&&"function"==typeof e.unref?e.unref():"undefined"!=typeof Deno&&"function"==typeof Deno.unrefTimer&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:r}}=t;if(!r||!r.refresh_token||!r.expires_at)return void this._debug("#_autoRefreshTokenTick()","no session");const s=Math.floor((1e3*r.expires_at-e)/ra);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts 30000ms, refresh threshold is 3 ticks`),s<=3&&await this._callRefreshToken(r.refresh_token)})}catch(Al){}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(Al){if(!(Al.isAcquireTimeout||Al instanceof dn))throw Al;this._debug("auto refresh token tick lock not available")}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Pa()||!(null===window||void 0===window?void 0:window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),null===window||void 0===window||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),"visible"===document.visibilityState?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{"visible"===document.visibilityState?await this._recoverAndRefresh():this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting")}))):"hidden"===document.visibilityState&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,r){const s=[`provider=${encodeURIComponent(t)}`];if((null==r?void 0:r.redirectTo)&&s.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),(null==r?void 0:r.scopes)&&s.push(`scopes=${encodeURIComponent(r.scopes)}`),"pkce"===this.flowType){const[e,t]=await Wa(this.storage,this.storageKey),r=new URLSearchParams({code_challenge:`${encodeURIComponent(e)}`,code_challenge_method:`${encodeURIComponent(t)}`});s.push(r.toString())}if(null==r?void 0:r.queryParams){const e=new URLSearchParams(r.queryParams);s.push(e.toString())}return(null==r?void 0:r.skipBrowserRedirect)&&s.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${s.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var r;const{data:s,error:a}=t;return a?this._returnResult({data:null,error:a}):await Xa(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:null===(r=null==s?void 0:s.session)||void 0===r?void 0:r.access_token})})}catch(t){if(ca(t))return this._returnResult({data:null,error:t});throw t}}async _enroll(e){try{return await this._useSession(async t=>{var r,s;const{data:a,error:n}=t;if(n)return this._returnResult({data:null,error:n});const i=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},"phone"===e.factorType?{phone:e.phone}:"totp"===e.factorType?{issuer:e.issuer}:{}),{data:o,error:l}=await Xa(this.fetch,"POST",`${this.url}/factors`,{body:i,headers:this.headers,jwt:null===(r=null==a?void 0:a.session)||void 0===r?void 0:r.access_token});return l?this._returnResult({data:null,error:l}):("totp"===e.factorType&&"totp"===o.type&&(null===(s=null==o?void 0:o.totp)||void 0===s?void 0:s.qr_code)&&(o.totp.qr_code=`data:image/svg+xml;utf-8,${o.totp.qr_code}`),this._returnResult({data:o,error:null}))})}catch(t){if(ca(t))return this._returnResult({data:null,error:t});throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;const{data:s,error:a}=t;if(a)return this._returnResult({data:null,error:a});const n=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:"create"===e.webauthn.type?kn(e.webauthn.credential_response):jn(e.webauthn.credential_response)})}:{code:e.code}),{data:i,error:o}=await Xa(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:n,headers:this.headers,jwt:null===(r=null==s?void 0:s.session)||void 0===r?void 0:r.access_token});return o?this._returnResult({data:null,error:o}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+i.expires_in},i)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",i),this._returnResult({data:i,error:o}))})}catch(t){if(ca(t))return this._returnResult({data:null,error:t});throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;const{data:s,error:a}=t;if(a)return this._returnResult({data:null,error:a});const n=await Xa(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:null===(r=null==s?void 0:s.session)||void 0===r?void 0:r.access_token});if(n.error)return n;const{data:i}=n;if("webauthn"!==i.type)return{data:i,error:null};switch(i.webauthn.type){case"create":return{data:Object.assign(Object.assign({},i),{webauthn:Object.assign(Object.assign({},i.webauthn),{credential_options:Object.assign(Object.assign({},i.webauthn.credential_options),{publicKey:xn(i.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},i),{webauthn:Object.assign(Object.assign({},i.webauthn),{credential_options:Object.assign(Object.assign({},i.webauthn.credential_options),{publicKey:_n(i.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(t){if(ca(t))return this._returnResult({data:null,error:t});throw t}})}async _challengeAndVerify(e){const{data:t,error:r}=await this._challenge({factorId:e.factorId});return r?this._returnResult({data:null,error:r}):await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){var e;const{data:{user:t},error:r}=await this.getUser();if(r)return{data:null,error:r};const s={all:[],phone:[],totp:[],webauthn:[]};for(const a of null!==(e=null==t?void 0:t.factors)&&void 0!==e?e:[])s.all.push(a),"verified"===a.status&&s[a.factor_type].push(a);return{data:s,error:null}}async _getAuthenticatorAssuranceLevel(){var e,t;const{data:{session:r},error:s}=await this.getSession();if(s)return this._returnResult({data:null,error:s});if(!r)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:a}=Ba(r.access_token);let n=null;a.aal&&(n=a.aal);let i=n;(null!==(t=null===(e=r.user.factors)||void 0===e?void 0:e.filter(e=>"verified"===e.status))&&void 0!==t?t:[]).length>0&&(i="aal2");return{data:{currentLevel:n,nextLevel:i,currentAuthenticationMethods:a.amr||[]},error:null}}async _getAuthorizationDetails(e){try{return await this._useSession(async t=>{const{data:{session:r},error:s}=t;return s?this._returnResult({data:null,error:s}):r?await Xa(this.fetch,"GET",`${this.url}/oauth/authorizations/${e}`,{headers:this.headers,jwt:r.access_token,xform:e=>({data:e,error:null})}):this._returnResult({data:null,error:new pa})})}catch(t){if(ca(t))return this._returnResult({data:null,error:t});throw t}}async _approveAuthorization(e,t){try{return await this._useSession(async r=>{const{data:{session:s},error:a}=r;if(a)return this._returnResult({data:null,error:a});if(!s)return this._returnResult({data:null,error:new pa});const n=await Xa(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:s.access_token,body:{action:"approve"},xform:e=>({data:e,error:null})});return n.data&&n.data.redirect_url&&Pa()&&!(null==t?void 0:t.skipBrowserRedirect)&&window.location.assign(n.data.redirect_url),n})}catch(r){if(ca(r))return this._returnResult({data:null,error:r});throw r}}async _denyAuthorization(e,t){try{return await this._useSession(async r=>{const{data:{session:s},error:a}=r;if(a)return this._returnResult({data:null,error:a});if(!s)return this._returnResult({data:null,error:new pa});const n=await Xa(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:s.access_token,body:{action:"deny"},xform:e=>({data:e,error:null})});return n.data&&n.data.redirect_url&&Pa()&&!(null==t?void 0:t.skipBrowserRedirect)&&window.location.assign(n.data.redirect_url),n})}catch(r){if(ca(r))return this._returnResult({data:null,error:r});throw r}}async _listOAuthGrants(){try{return await this._useSession(async e=>{const{data:{session:t},error:r}=e;return r?this._returnResult({data:null,error:r}):t?await Xa(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:t.access_token,xform:e=>({data:e,error:null})}):this._returnResult({data:null,error:new pa})})}catch(e){if(ca(e))return this._returnResult({data:null,error:e});throw e}}async _revokeOAuthGrant(e){try{return await this._useSession(async t=>{const{data:{session:r},error:s}=t;return s?this._returnResult({data:null,error:s}):r?(await Xa(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:r.access_token,query:{client_id:e.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new pa})})}catch(t){if(ca(t))return this._returnResult({data:null,error:t});throw t}}async fetchJwk(e,t={keys:[]}){let r=t.keys.find(t=>t.kid===e);if(r)return r;const s=Date.now();if(r=this.jwks.keys.find(t=>t.kid===e),r&&this.jwks_cached_at+6e5>s)return r;const{data:a,error:n}=await Xa(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(n)throw n;return a.keys&&0!==a.keys.length?(this.jwks=a,this.jwks_cached_at=s,r=a.keys.find(t=>t.kid===e),r||null):null}async getClaims(e,t={}){try{let r=e;if(!r){const{data:e,error:t}=await this.getSession();if(t||!e.session)return this._returnResult({data:null,error:t});r=e.session.access_token}const{header:s,payload:a,signature:n,raw:{header:i,payload:o}}=Ba(r);(null==t?void 0:t.allowExpired)||function(e){if(!e)throw new Error("Missing exp claim");if(e<=Math.floor(Date.now()/1e3))throw new Error("JWT has expired")}(a.exp);const l=s.alg&&!s.alg.startsWith("HS")&&s.kid&&"crypto"in globalThis&&"subtle"in globalThis.crypto?await this.fetchJwk(s.kid,(null==t?void 0:t.keys)?{keys:t.keys}:null==t?void 0:t.jwks):null;if(!l){const{error:e}=await this.getUser(r);if(e)throw e;return{data:{claims:a,header:s,signature:n},error:null}}const c=function(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}(s.alg),u=await crypto.subtle.importKey("jwk",l,c,!0,["verify"]);if(!(await crypto.subtle.verify(c,u,n,Ca(`${i}.${o}`))))throw new _a("Invalid JWT signature");return{data:{claims:a,header:s,signature:n},error:null}}catch(r){if(ca(r))return this._returnResult({data:null,error:r});throw r}}}In.nextInstanceID={};const $n=In;let Un="";Un="undefined"!=typeof Deno?"deno":"undefined"!=typeof document?"web":"undefined"!=typeof navigator&&"ReactNative"===navigator.product?"react-native":"node";const Dn={headers:{"X-Client-Info":`supabase-js-${Un}/2.88.0`}},Ln={schema:"public"},qn={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Mn={};function Bn(e){return(Bn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function zn(e){var t=function(e,t){if("object"!=Bn(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var s=r.call(e,t);if("object"!=Bn(s))return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Bn(t)?t:t+""}function Fn(e,t,r){return(t=zn(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Wn(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,s)}return r}function Vn(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Wn(Object(r),!0).forEach(function(t){Fn(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Wn(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}const Kn=(e,t,r)=>{const s=(e=>e?(...t)=>e(...t):(...e)=>fetch(...e))(r),a=Headers;return async(r,n)=>{var i;const o=null!==(i=await t())&&void 0!==i?i:e;let l=new a(null==n?void 0:n.headers);return l.has("apikey")||l.set("apikey",e),l.has("Authorization")||l.set("Authorization",`Bearer ${o}`),s(r,Vn(Vn({},n),{},{headers:l}))}};var Hn=class extends $n{constructor(e){super(e)}},Jn=class{constructor(e,t,r){var s,a;this.supabaseUrl=e,this.supabaseKey=t;const n=function(e){const t=null==e?void 0:e.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL((r=t).endsWith("/")?r:r+"/")}catch(s){throw Error("Invalid supabaseUrl: Provided URL is malformed.")}var r}(e);if(!t)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",n),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",n),this.storageUrl=new URL("storage/v1",n),this.functionsUrl=new URL("functions/v1",n);const i=`sb-${n.hostname.split(".")[0]}-auth-token`,o=function(e,t){var r,s;const{db:a,auth:n,realtime:i,global:o}=e,{db:l,auth:c,realtime:u,global:d}=t,h={db:Vn(Vn({},l),a),auth:Vn(Vn({},c),n),realtime:Vn(Vn({},u),i),storage:{},global:Vn(Vn(Vn({},d),o),{},{headers:Vn(Vn({},null!==(r=null==d?void 0:d.headers)&&void 0!==r?r:{}),null!==(s=null==o?void 0:o.headers)&&void 0!==s?s:{})}),accessToken:async()=>""};return e.accessToken?h.accessToken=e.accessToken:delete h.accessToken,h}(null!=r?r:{},{db:Ln,realtime:Mn,auth:Vn(Vn({},qn),{},{storageKey:i}),global:Dn});var l;(this.storageKey=null!==(s=o.auth.storageKey)&&void 0!==s?s:"",this.headers=null!==(a=o.global.headers)&&void 0!==a?a:{},o.accessToken)?(this.accessToken=o.accessToken,this.auth=new Proxy({},{get:(e,t)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(t)} is not possible`)}})):this.auth=this._initSupabaseAuthClient(null!==(l=o.auth)&&void 0!==l?l:{},this.headers,o.global.fetch);this.fetch=Kn(t,this._getAccessToken.bind(this),o.global.fetch),this.realtime=this._initRealtimeClient(Vn({headers:this.headers,accessToken:this._getAccessToken.bind(this)},o.realtime)),this.accessToken&&this.accessToken().then(e=>this.realtime.setAuth(e)).catch(e=>{}),this.rest=new dr(new URL("rest/v1",n).href,{headers:this.headers,schema:o.db.schema,fetch:this.fetch}),this.storage=new ea(this.storageUrl.href,this.headers,this.fetch,null==r?void 0:r.storage),o.accessToken||this._listenForAuthEvents()}get functions(){return new ar(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={head:!1,get:!1,count:void 0}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var e,t,r=this;if(r.accessToken)return await r.accessToken();const{data:s}=await r.auth.getSession();return null!==(e=null===(t=s.session)||void 0===t?void 0:t.access_token)&&void 0!==e?e:r.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:s,userStorage:a,storageKey:n,flowType:i,lock:o,debug:l,throwOnError:c},u,d){const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Hn({url:this.authUrl.href,headers:Vn(Vn({},h),u),storageKey:n,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:s,userStorage:a,flowType:i,lock:o,debug:l,throwOnError:c,fetch:d,hasCustomAuthorizationHeader:Object.keys(this.headers).some(e=>"authorization"===e.toLowerCase())})}_initRealtimeClient(e){return new ts(this.realtimeUrl.href,Vn(Vn({},e),{},{params:Vn(Vn({},{apikey:this.supabaseKey}),null==e?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,t)=>{this._handleTokenChanged(e,"CLIENT",null==t?void 0:t.access_token)})}_handleTokenChanged(e,t,r){"TOKEN_REFRESHED"!==e&&"SIGNED_IN"!==e||this.changedAccessToken===r?"SIGNED_OUT"===e&&(this.realtime.setAuth(),"STORAGE"==t&&this.auth.signOut(),this.changedAccessToken=void 0):(this.changedAccessToken=r,this.realtime.setAuth(r))}};!function(){if("undefined"!=typeof window)return!1;if("undefined"==typeof process)return!1;const e=process.version;if(null==e)return!1;const t=e.match(/^v(\d+)\./);!!t&&parseInt(t[1],10)}();if("undefined"!=typeof window)try{["sb-anlivujgkjmajkcgbaxw-auth-token","supabase.auth.token"].forEach(e=>{localStorage.getItem(e)&&localStorage.removeItem(e)})}catch(Al){}const Gn=(Yn="https://anlivujgkjmajkcgbaxw.supabase.co",Qn="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFubGl2dWpna2ptYWprY2diYXh3Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjU5OTY0OTQsImV4cCI6MjA4MTU3MjQ5NH0.5SzkZg_PMqgdMClS1ftg4ZT_Ddyq1zOi-ZOLe1yuRgY",Zn={auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0,storage:"undefined"!=typeof window?window.localStorage:void 0,storageKey:"eventnexus-auth-token",flowType:"pkce"},global:{headers:{"X-Client-Info":"eventnexus-web"}}},new Jn(Yn,Qn,Zn));var Yn,Qn,Zn;const Xn=Object.freeze(Object.defineProperty({__proto__:null,supabase:Gn},Symbol.toStringTag,{value:"Module"})),ei=e=>({id:e.id,name:e.name,category:e.category,description:e.description,aboutText:e.about_text||void 0,date:e.date,time:e.time||"",location:e.location,price:e.price,visibility:e.visibility||"public",organizerId:e.organizer_id,imageUrl:e.image||"",attendeesCount:e.attendees_count||0,maxAttendees:e.max_capacity||0,isFeatured:e.is_featured||!1,customBranding:e.custom_branding||void 0,translations:e.translations||void 0}),ti=async()=>{const{data:e,error:t}=await Gn.from("events").select("*").eq("status","active").order("date",{ascending:!0});return t?[]:(e||[]).map(ei)},ri=async e=>{const{data:t,error:r}=await Gn.from("events").select("*").eq("organizer_id",e).order("date",{ascending:!0});return r?[]:(t||[]).map(ei)},si=async()=>{const{data:e,error:t}=await Gn.from("users").select("*").order("created_at",{ascending:!1});return t?[]:e||[]},ai=async e=>{let t;try{const r=e.date,s=`${r}T${e.time}:00`;t=new Date(s).toISOString()}catch(n){throw new Error("Invalid date or time format")}const r={name:e.name,description:e.description,about_text:e.aboutText||null,category:e.category,date:t,time:e.time,location:e.location,price:e.price,visibility:e.visibility,organizer_id:e.organizerId,image:e.imageUrl||null,attendees_count:e.attendeesCount||0,max_capacity:e.maxAttendees||100,status:"active"};if(e.end_date&&e.end_time)try{const t=`${e.end_date}T${e.end_time}:00`;r.end_date=new Date(t).toISOString()}catch(n){}void 0!==e.isFeatured&&(r.is_featured=e.isFeatured),e.customBranding&&(r.custom_branding=e.customBranding),e.translations&&(r.translations=e.translations);const{data:s,error:a}=await Gn.from("events").insert([r]).select().single();if(a)return null;try{const{data:t,error:r}=await Gn.from("users").select("id, name").filter("followed_organizers","cs",`["${e.organizerId}"]`);if(!r&&t&&t.length>0){const{data:r}=await Gn.from("users").select("name").eq("id",e.organizerId).single(),a=t.map(t=>({user_id:t.id,title:"New Event from Organizer You Follow",message:`${(null==r?void 0:r.name)||"An organizer"} just created "${e.name}". Check it out!`,type:"new_event_from_followed",sender_name:(null==r?void 0:r.name)||"EventNexus",event_id:s.id,is_read:!1,created_at:(new Date).toISOString()}));await Gn.from("notifications").insert(a)}}catch(i){}return ei(s)},ni=async(e,t)=>{const{data:r,error:s}=await Gn.from("events").update(t).eq("id",e).select().single();return s?null:r},ii=async e=>{const{error:t}=await Gn.from("events").delete().eq("id",e);return!t},oi=async e=>{try{const{data:t,error:r}=await Gn.from("tickets").select("id").eq("event_id",e).eq("payment_status","paid");if(r)return{canDelete:!1,ticketsSold:0,reason:"Failed to check ticket status"};const s=(null==t?void 0:t.length)||0;return s>0?{canDelete:!1,ticketsSold:s,reason:`Cannot delete: ${s} ticket${s>1?"s":""} already sold`}:{canDelete:!0,ticketsSold:0}}catch(t){return{canDelete:!1,ticketsSold:0,reason:"Unexpected error"}}},li=async e=>{const t=await oi(e);if(!t.canDelete)return{success:!1,message:t.reason||"Cannot delete event"};return await ii(e)?{success:!0,message:"Event deleted successfully"}:{success:!1,message:"Failed to delete event"}},ci=async(e,t)=>{try{const{error:r}=await Gn.from("event_likes").insert([{user_id:e,event_id:t}]);return!r}catch(r){return!1}},ui=async(e,t)=>{try{const{error:r}=await Gn.from("event_likes").delete().eq("user_id",e).eq("event_id",t);return!r}catch(r){return!1}},di=async(e,t)=>{try{const{data:r,error:s}=await Gn.from("event_likes").select("id").eq("user_id",e).eq("event_id",t).maybeSingle();return!s&&!!r}catch(r){return!1}},hi=async e=>{var t;try{const r=new Promise(e=>{setTimeout(()=>{e(null)},3e4)}),s=Date.now(),a=Gn.from("users").select("*").eq("id",e).single(),n=await Promise.race([a,r]);if(null===n){Date.now();return null}Date.now();const{data:i,error:o}=n;if(o){if("PGRST116"===o.code){const{data:{user:e}}=await Gn.auth.getUser();if(e){const r={id:e.id,name:(null==(t=e.email)?void 0:t.split("@")[0])||"User",email:e.email||"",role:"attendee",subscription_tier:"free",credits:0,credits_balance:0,avatar:`https://api.dicebear.com/7.x/avataaars/svg?seed=${e.id}`,notification_prefs:{pushEnabled:!0,emailEnabled:!0,proximityAlerts:!0,alertRadius:10,interestedCategories:[],notifyActiveEvents:!0,notifyUpcomingEvents:!0,upcomingEventWindow:24,minAvailableTickets:1}},s=await mi(r);if(s)return s}}return null}if(!i)return null;const l=i;return l.notification_prefs&&"object"==typeof l.notification_prefs?(Array.isArray(l.notification_prefs.interestedCategories)||(l.notification_prefs.interestedCategories=[]),void 0===l.notification_prefs.notifyActiveEvents&&(l.notification_prefs.notifyActiveEvents=!0),void 0===l.notification_prefs.notifyUpcomingEvents&&(l.notification_prefs.notifyUpcomingEvents=!0),l.notification_prefs.upcomingEventWindow||(l.notification_prefs.upcomingEventWindow=24),l.notification_prefs.minAvailableTickets||(l.notification_prefs.minAvailableTickets=1)):l.notification_prefs={pushEnabled:!0,emailEnabled:!0,proximityAlerts:!0,alertRadius:10,interestedCategories:[],notifyActiveEvents:!0,notifyUpcomingEvents:!0,upcomingEventWindow:24,minAvailableTickets:1},Array.isArray(l.followed_organizers)||(l.followed_organizers=[]),l.followedOrganizers=l.followed_organizers,l}catch(r){return null}},pi=async()=>{try{const{data:e,error:t}=await Gn.from("users").select("*").order("created_at",{ascending:!1});return t?[]:e||[]}catch(e){return[]}},mi=async e=>{const t={...e,credits_balance:e.credits_balance??e.credits??0,credits:e.credits??e.credits_balance??0},{data:r,error:s}=await Gn.from("users").insert([t]).select().single();return s?null:r},fi=async(e,t)=>{try{const r=t.name.split(".").pop(),s=`avatars/${`${e}-${Date.now()}.${r}`}`,{error:a}=await Gn.storage.from("avatars").upload(s,t,{cacheControl:"3600",upsert:!0});if(a)return null;const{data:{publicUrl:n}}=Gn.storage.from("avatars").getPublicUrl(s);return n}catch(r){return null}},gi=async(e,t)=>{try{const r=t.name.split(".").pop(),s=`banners/${`${e}-banner-${Date.now()}.${r}`}`,{error:a}=await Gn.storage.from("avatars").upload(s,t,{cacheControl:"3600",upsert:!0});if(a)return null;const{data:{publicUrl:n}}=Gn.storage.from("avatars").getPublicUrl(s);return n}catch(r){return null}},yi=async(e,t)=>{try{const r=t.name.split(".").pop(),s=`event-images/${`${e}-${Date.now()}.${r}`}`,{error:a}=await Gn.storage.from("event-images").upload(s,t,{cacheControl:"3600",upsert:!0});if(a)return null;const{data:{publicUrl:n}}=Gn.storage.from("event-images").getPublicUrl(s);return n}catch(r){return null}},wi=async(e,t)=>{const r={};for(const[n,i]of Object.entries(t))if(void 0!==i)switch(n){case"agencySlug":r.agency_slug=i;break;case"subscriptionTier":r.subscription_tier=i;break;case"notificationPrefs":r.notification_prefs=i;break;case"agencyProfile":r.agency_profile=i;break;case"createdAt":r.created_at=i;break;case"updatedAt":r.updated_at=i;break;case"lastLogin":r.last_login=i;break;case"stripeCustomerId":r.stripe_customer_id=i;break;case"stripeAccountId":r.stripe_account_id=i;break;case"stripeSubscriptionId":r.stripe_subscription_id=i;break;case"subscriptionStatus":r.subscription_status=i;break;default:r[n]=i}const{data:s,error:a}=await Gn.from("users").update(r).eq("id",e).select().single();return a?null:s},vi=async e=>{try{const{data:t,error:r}=await Gn.from("users").select("*").eq("agency_slug",e).single();return r?null:t}catch(t){return null}},bi=e=>({id:e.id,title:e.title,message:e.message,type:e.type,eventId:e.event_id,senderName:e.sender_name,timestamp:e.timestamp,isRead:e.isRead,metadata:e.metadata}),xi=async e=>{const{data:t,error:r}=await Gn.from("notifications").select("*").eq("user_id",e).order("timestamp",{ascending:!1});return r?[]:(t||[]).map(bi)},_i=async e=>{const t=new Set(["proximity_radar","event_update","ticket_purchase","system","admin","contact_inquiry"]).has(e.type)?e.type:"system",r={user_id:e.user_id,title:e.title,message:e.message,type:t,event_id:e.eventId,sender_name:e.senderName,isRead:e.isRead,timestamp:e.timestamp,metadata:e.metadata},{data:s,error:a}=await Gn.from("notifications").insert([r]).select().single();return a?null:bi(s)},ki=async e=>{const{error:t}=await Gn.from("notifications").update({isRead:!0}).eq("id",e);return!t},ji=async e=>{const{error:t}=await Gn.from("notifications").delete().eq("id",e);return!t},Si=async(e,t)=>{const r="undefined"!=typeof window?`${window.location.origin}${window.location.pathname}#/profile`:void 0,{data:s,error:a}=await Gn.auth.signUp({email:e,password:t,options:{emailRedirectTo:r}});return a?{user:null,error:a}:{user:s.user,error:null}},Ei=async(e,t)=>{const{data:r,error:s}=await Gn.auth.signInWithPassword({email:e,password:t});return s?{user:null,error:s}:r.user&&!r.user.email_confirmed_at?{user:null,error:{message:"Please confirm your email address before logging in. Check your inbox for the confirmation link.",name:"EmailNotConfirmed",status:400}}:{user:r.user,error:null}},Ni=async()=>{const{error:e}=await Gn.auth.signOut();return!e},Ti=async e=>{const{data:t,error:r}=await Gn.from("tickets").select("\n      *,\n      event:event_id(\n        id,\n        name,\n        date,\n        time,\n        location,\n        image\n      )\n    ").eq("user_id",e).eq("payment_status","paid").order("purchase_date",{ascending:!1});return r?[]:t||[]},Ri=async e=>{const{data:t,error:r}=await Gn.from("tickets").select("\n      *,\n      event:events!tickets_event_id_fkey(\n        id,\n        name,\n        date,\n        time,\n        location,\n        image\n      )\n    ").eq("id",e).limit(1).maybeSingle();return r?null:t||null},Oi=async e=>{try{const{data:{session:t}}=await Gn.auth.getSession();if(!(null==t?void 0:t.access_token))throw new Error("Not authenticated - please sign in again");const{data:r,error:s}=await Gn.functions.invoke("validate-ticket",{body:{qrCode:e},headers:{Authorization:`Bearer ${t.access_token}`}});if(s)throw s;return r}catch(t){return{valid:!1,error:t.message||"Validation failed"}}},Ci=async()=>{try{const{data:{session:e}}=await Gn.auth.getSession();if(null==e?void 0:e.access_token){const{data:t,error:r}=await Gn.functions.invoke("platform-stats",{body:{},headers:{Authorization:`Bearer ${e.access_token}`}});if(!r&&t)return t}const{data:t,error:r}=await Gn.rpc("get_platform_statistics");if(r)throw r;return t}catch(e){return{totalEvents:150,totalUsers:2800,totalTickets:4500,totalOrganizers:85,totalRevenue:0,monthlyGPV:"â‚¬0k",platformConversion:"0.0",creditPool:"0M",retentionRate:0,globalFee:2.5,revenueByTier:[]}}},Ai=async()=>{try{const{data:{session:e}}=await Gn.auth.getSession();if(!(null==e?void 0:e.access_token))throw new Error("Not authenticated");const{data:t,error:r}=await Gn.functions.invoke("infrastructure-stats",{body:{},headers:{Authorization:`Bearer ${e.access_token}`}});if(r)throw r;return t}catch(e){return{clusterUptime:0,apiLatency:0,dbConnections:0,storageBurn:"0.0",protocolStatus:"Offline",maintenanceMode:!0,securityStatus:"UNKNOWN",systemLogs:["[ERROR] Unable to fetch system metrics."],systemIntegrity:"System monitoring unavailable.",lastUpdated:(new Date).toISOString()}}},Pi=async(e,t)=>{try{const{error:r}=await Gn.from("users").update({status:"suspended",suspended_at:(new Date).toISOString(),suspension_reason:t}).eq("id",e);if(r)throw r;return!0}catch(r){return!1}},Ii=async(e,t)=>{try{const{error:r}=await Gn.from("users").update({status:"banned",banned_at:(new Date).toISOString(),ban_reason:t}).eq("id",e);if(r)throw r;return!0}catch(r){return!1}},$i=async(e,t)=>{try{const{data:r,error:s}=await Gn.from("users").select("credits_balance").eq("id",e).single();if(s)throw s;const a=((null==r?void 0:r.credits_balance)||0)+t,{error:n}=await Gn.from("users").update({credits_balance:a}).eq("id",e);if(n)throw n;return!0}catch(r){return!1}},Ui=async(e,t)=>{try{const{data:r,error:s}=await Gn.from("users").select("credits_balance").eq("id",e).single();if(s)throw s;const a=(null==r?void 0:r.credits_balance)||0;if(a<t)return!1;const n=a-t,{error:i}=await Gn.from("users").update({credits_balance:n}).eq("id",e);if(i)throw i;return!0}catch(r){return!1}},Di=async(e,t)=>{try{const{data:r,error:s}=await Gn.from("users").select("credits_balance").eq("id",e).single();if(s)throw s;return((null==r?void 0:r.credits_balance)||0)>=t}catch(r){return!1}},Li=async(e,t,r)=>{try{let s=Gn.from("users").select("id");"organizers"===r?s=s.eq("role","organizer"):"attendees"===r&&(s=s.eq("role","attendee"));const{data:a,error:n}=await s;if(n)throw n;if(!a||0===a.length)return 0;const i=a.map(r=>({user_id:r.id,title:e,message:t,type:"system",sender_name:"EventNexus Admin",isRead:!1,timestamp:(new Date).toISOString()})),{error:o}=await Gn.from("notifications").insert(i);if(o)throw o;return a.length}catch(s){return 0}},qi=e=>{const{imageUrl:t,trackingCode:r,...s}=e;return{...s,image_url:t,tracking_code:r}},Mi=e=>{const{image_url:t,tracking_code:r,...s}=e;return{...s,imageUrl:t,trackingCode:r}},Bi=async()=>{try{const{data:e,error:t}=await Gn.from("campaigns").select("*").order("created_at",{ascending:!1});if(t)throw t;return(e||[]).map(Mi)}catch(e){return[]}},zi=async e=>{try{const t=qi(e),{data:r,error:s}=await Gn.from("campaigns").insert([t]).select().single();if(s)throw s;return r?Mi(r):null}catch(t){return null}},Fi=async(e,t)=>{try{const r=qi(t),{data:s,error:a}=await Gn.from("campaigns").update(r).eq("id",e).select().single();if(a)throw a;return s?Mi(s):null}catch(r){return null}},Wi=async e=>{try{const{error:t}=await Gn.from("campaigns").delete().eq("id",e);if(t)throw t;return!0}catch(t){return!1}},Vi=async(e,t)=>{try{const{data:r,error:s}=await Gn.rpc("claim_campaign_incentive",{p_user_id:e,p_campaign_id:t});if(s)throw s;return r}catch(r){return null}},Ki=async(e,t)=>{try{const r="string"==typeof t?JSON.stringify(t):t,{error:s}=await Gn.from("system_config").upsert({key:e,value:r,updated_at:(new Date).toISOString()});if(s)throw s;return!0}catch(r){return!1}},Hi=async()=>{try{const{data:e,error:t}=await Gn.from("system_config").select("key, value");if(t)throw t;const r={};return null==e||e.forEach(e=>{r[e.key]=e.value}),r}catch(e){return{}}},Ji=async()=>{try{const{data:e,error:t}=await Gn.rpc("get_financial_ledger");if(t)throw t;return e||[]}catch(e){return[]}},Gi=async e=>{try{let t=Gn.from("admin_inbox").select("*").order("created_at",{ascending:!1});e&&"all"!==e&&(t=t.eq("status",e));const{data:r,error:s}=await t;if(s)throw s;return r||[]}catch(t){return[]}},Yi=async()=>{try{const{data:e,error:t}=await Gn.rpc("get_inbox_stats");if(t)throw t;return e||{total:0,unread:0,replied:0,high_priority:0}}catch(e){return{total:0,unread:0,replied:0,high_priority:0}}},Qi=async e=>{try{const{error:t}=await Gn.from("admin_inbox").update({status:"read"}).eq("id",e);if(t)throw t}catch(t){throw t}},Zi=async(e,t)=>{var r;try{const{data:s,error:a}=await Gn.from("admin_inbox").select("*").eq("id",e).single();if(a)throw a;const{data:{user:n}}=await Gn.auth.getUser();if(!(await fetch(`${Gn.supabaseUrl}/functions/v1/send-email-reply`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${null==(r=(await Gn.auth.getSession()).data.session)?void 0:r.access_token}`},body:JSON.stringify({to:s.from_email,subject:`Re: ${s.subject}`,body:t,inReplyTo:s.message_id})})).ok)throw new Error("Failed to send email reply");const{error:i}=await Gn.from("admin_inbox").update({status:"replied",replied_by:null==n?void 0:n.id,replied_at:(new Date).toISOString(),reply_body:t}).eq("id",e);if(i)throw i}catch(s){throw s}},Xi=async e=>{try{const{error:t}=await Gn.from("admin_inbox").delete().eq("id",e);if(t)throw t}catch(t){throw t}},eo=async(e,t)=>{try{const{data:r,error:s}=await Gn.functions.invoke("create-connect-account",{body:{userId:e,email:t,businessType:"individual",country:"EE"}});return s?null:{url:r.url,accountId:r.accountId}}catch(r){return null}},to=async e=>{try{const{data:t,error:r}=await Gn.functions.invoke("get-connect-dashboard-link",{body:{userId:e}});return r?null:t.url}catch(t){return null}},ro=async e=>{try{const{data:t,error:r}=await Gn.rpc("get_organizer_revenue",{org_id:e});return r?[]:t||[]}catch(t){return[]}},so=async e=>{try{const{data:t,error:r}=await Gn.rpc("get_organizer_revenue_summary",{org_id:e});return r?null:(null==t?void 0:t[0])||null}catch(t){return null}},ao=async e=>{try{const{data:t,error:r}=await Gn.from("tickets").select("\n        event_id,\n        status,\n        event:events!inner(id, name, date, organizer_id)\n      ").eq("event.organizer_id",e);if(r)return[];const s={};return(t||[]).forEach(e=>{const t=e.event;t&&(s[t.id]||(s[t.id]={event_id:t.id,name:t.name,date:t.date,total_tickets:0,checked_in:0}),s[t.id].total_tickets+=1,"used"===e.status&&(s[t.id].checked_in+=1))}),Object.values(s).sort((e,t)=>(t.date||"").localeCompare(e.date||""))}catch(t){return[]}},no=async e=>{try{const{data:t,error:r}=await Gn.from("users").select("stripe_connect_account_id, stripe_connect_onboarding_complete, stripe_connect_charges_enabled, stripe_connect_payouts_enabled").eq("id",e).single();return r?null:{hasAccount:!!t.stripe_connect_account_id,onboardingComplete:t.stripe_connect_onboarding_complete||!1,chargesEnabled:t.stripe_connect_charges_enabled||!1,payoutsEnabled:t.stripe_connect_payouts_enabled||!1}}catch(t){return null}},io=async e=>{try{const{data:t,error:r}=await Gn.functions.invoke("verify-connect-onboarding",{body:{userId:e}});return r?null:{success:t.success||!1,hasAccount:t.hasAccount||!1,onboardingComplete:t.onboardingComplete||!1,chargesEnabled:t.chargesEnabled||!1,payoutsEnabled:t.payoutsEnabled||!1}}catch(t){return null}},oo=async(e,t=30)=>{try{const r=[],s=new Date,a=new Date(s.getTime()+24*t*60*60*1e3);for(let t=0;t<e;t++){const e=`BETA-${Date.now()}-${Math.random().toString(36).substring(2,9).toUpperCase()}`;r.push(e)}const n=r.map(e=>({code:e,status:"active",created_at:s.toISOString(),expires_at:a.toISOString()})),{error:i}=await Gn.from("beta_invitations").insert(n);if(i)throw i;return r}catch(r){return[]}},lo=async(e,t,r=1e3)=>{try{const{data:s,error:a}=await Gn.from("beta_invitations").select("*").eq("code",t).single();if(a||!s)return{success:!1,message:"Invalid invitation code"};if("active"!==s.status)return{success:!1,message:"This invitation code has already been used or expired"};const n=new Date;if(new Date(s.expires_at)<n)return{success:!1,message:"This invitation code has expired"};const{error:i}=await Gn.from("beta_invitations").update({status:"used",used_by:e,redeemed_at:n.toISOString()}).eq("id",s.id);if(i)throw i;const o=await $i(e,r),{error:l}=await Gn.from("users").update({is_beta_tester:!0}).eq("id",e);return o?{success:!0,message:`ðŸŽ‰ Welcome to the beta! You've received ${r} credits and beta tester status!`}:{success:!1,message:"Code validated but failed to add credits. Please contact support."}}catch(s){return{success:!1,message:"An error occurred while redeeming the code"}}},co=async()=>{try{const{data:e,error:t}=await Gn.from("beta_invitations").select("*").order("created_at",{ascending:!1});if(t)throw t;return e||[]}catch(e){return[]}},uo=async()=>{try{const{data:e,error:t}=await Gn.from("beta_invitations").select("status");if(t)throw t;return{total:(null==e?void 0:e.length)||0,active:(null==e?void 0:e.filter(e=>"active"===e.status).length)||0,used:(null==e?void 0:e.filter(e=>"used"===e.status).length)||0,expired:(null==e?void 0:e.filter(e=>"expired"===e.status).length)||0,creditsDistributed:1e3*((null==e?void 0:e.filter(e=>"used"===e.status).length)||0)}}catch(e){return{total:0,active:0,used:0,expired:0,creditsDistributed:0}}},ho=async e=>{try{const{error:t}=await Gn.from("beta_invitations").update({status:"expired"}).eq("id",e);if(t)throw t;return!0}catch(t){return!1}},po=async e=>{try{const{data:t}=await Gn.from("users").select("referral_code").eq("id",e).single();if(null==t?void 0:t.referral_code)return t.referral_code;const r=Math.random().toString(36).substring(2,10).toUpperCase(),{error:s}=await Gn.from("users").update({referral_code:r}).eq("id",e);if(s)throw s;return r}catch(t){return""}},mo=async e=>{try{const t=await po(e),{data:r}=await Gn.from("users").select("id, created_at").eq("referred_by",e),{data:s}=await Gn.from("credit_transactions").select("amount").eq("user_id",e).eq("transaction_type","referral_bonus"),a=(null==s?void 0:s.reduce((e,t)=>e+t.amount,0))||0,{data:n}=await Gn.from("users").select("id").eq("referred_by",e).is("first_action_at",null);return{code:t,totalReferrals:(null==r?void 0:r.length)||0,creditsEarned:a,pendingReferrals:(null==n?void 0:n.length)||0}}catch(t){return{code:"",totalReferrals:0,creditsEarned:0,pendingReferrals:0}}},fo=async(e,t,r)=>{try{const{data:s,error:a}=await Gn.functions.invoke("production-transition",{body:{stripe_public_key:e,api_base_url:t||"https://www.eventnexus.eu",notes:r||"Admin-initiated production transition"}});return a?null:s}catch(s){return null}},go=async()=>{try{const{data:e,error:t}=await Gn.from("environment_config").select("*").eq("is_active",!0).single();if(t)throw t;return e||{}}catch(e){return{}}},yo=async()=>{try{const{data:e,error:t}=await Gn.rpc("get_production_transition_history");if(t)throw t;return e||[]}catch(e){return[]}},wo=async(e=10,t)=>{try{const{data:r,error:s}=await Gn.rpc("get_top_organizers",{p_limit:e,p_tier:t||null});return s?[]:r||[]}catch(r){return[]}},vo=async(e,t,r,s,a)=>{try{const{data:n,error:i}=await Gn.functions.invoke("rate-organizer",{body:{organizerId:e,eventId:r,rating:t,reviewText:s,aspects:a}});return!i&&((null==n?void 0:n.success)||!1)}catch(n){return!1}},bo=async e=>{try{const{data:t,error:r}=await Gn.from("organizer_ratings").select("*").eq("organizer_id",e).order("created_at",{ascending:!1});return r?[]:t||[]}catch(t){return[]}},xo=async(e=6,t=!1)=>{try{const{data:r,error:s}=await Gn.rpc("get_success_stories",{p_limit:e,p_featured_only:t});return s?[]:r||[]}catch(r){return[]}},_o=async e=>{try{const{data:{user:t}}=await Gn.auth.getUser();if(!t)throw new Error("Not authenticated");const{data:r,error:s}=await Gn.from("success_stories").insert({...e,created_by:t.id}).select().single();return s?null:r}catch(t){return null}},ko=async(e,t)=>{try{const{data:r,error:s}=await Gn.from("success_stories").update(t).eq("id",e).select().single();return s?null:r}catch(r){return null}},jo=async e=>{try{const{error:t}=await Gn.from("success_stories").delete().eq("id",e);return!t}catch(t){return!1}},So=async(e=10,t=!1)=>{try{const{data:r,error:s}=await Gn.rpc("get_press_mentions",{p_limit:e,p_featured_only:t});return s?[]:r||[]}catch(r){return[]}},Eo=async e=>{try{const{data:{user:t}}=await Gn.auth.getUser();if(!t)throw new Error("Not authenticated");const{data:r,error:s}=await Gn.from("press_mentions").insert({...e,created_by:t.id}).select().single();return s?null:r}catch(t){return null}},No=async(e,t)=>{try{const{data:r,error:s}=await Gn.from("press_mentions").update(t).eq("id",e).select().single();return s?null:r}catch(r){return null}},To=async e=>{try{const{error:t}=await Gn.from("press_mentions").delete().eq("id",e);return!t}catch(t){return!1}},Ro=async(e="landing_demo",t)=>{try{const{data:r,error:s}=await Gn.rpc("get_platform_media",{p_location:e,p_media_type:t||null});return s?[]:r||[]}catch(r){return[]}},Oo=async()=>{try{const{data:e,error:t}=await Gn.from("platform_media").select("*").order("display_order",{ascending:!0});return t?[]:e||[]}catch(e){return[]}},Co=async e=>{try{const{data:{user:t}}=await Gn.auth.getUser();if(!t)throw new Error("Not authenticated");const{data:r,error:s}=await Gn.from("platform_media").insert({...e,created_by:t.id}).select().single();return s?null:r}catch(t){return null}},Ao=async(e,t)=>{try{const{data:r,error:s}=await Gn.from("platform_media").update(t).eq("id",e).select().single();return s?null:r}catch(r){return null}},Po=async e=>{try{const{error:t}=await Gn.from("platform_media").delete().eq("id",e);return!t}catch(t){return!1}},Io=async e=>{try{const{data:t,error:r}=await Gn.from("ticket_templates").select("*").eq("event_id",e).eq("is_active",!0).order("created_at",{ascending:!0});return r?[]:t||[]}catch(t){return[]}},$o=async e=>{try{const{data:t,error:r}=await Gn.functions.invoke("generate-promo-codes",{body:e});return r?[]:(null==t?void 0:t.codes)||[]}catch(t){return[]}},Uo=async()=>{try{const{data:e,error:t}=await Gn.from("promo_codes").select("*").order("created_at",{ascending:!1});return t?[]:e||[]}catch(e){return[]}},Do=async()=>{try{const{data:e,error:t}=await Gn.from("promo_code_stats").select("*").order("created_at",{ascending:!1});return t?[]:e||[]}catch(e){return[]}},Lo=async(e,t)=>{try{const{error:r}=await Gn.from("promo_codes").update({is_active:t}).eq("id",e);return!r}catch(r){return!1}},qo=async e=>{try{const{error:t}=await Gn.from("promo_codes").delete().eq("id",e);return!t}catch(t){return!1}},Mo=async(e,t)=>{try{const{data:r,error:s}=await Gn.rpc("redeem_promo_code",{p_user_id:e,p_code:t});return s?{success:!1,error:s.message}:r}catch(r){return{success:!1,error:"Failed to redeem code"}}},Bo=async(e,t,r,s)=>{try{const{data:a,error:n}=await Gn.rpc("admin_grant_credits",{p_user_id:e,p_amount:t,p_reason:r,p_admin_id:s});return n?{success:!1,error:n.message}:a}catch(a){return{success:!1,error:"Failed to grant credits"}}},zo=async e=>{try{const{data:t,error:r}=await Gn.from("credit_transactions").select("*").eq("user_id",e).order("created_at",{ascending:!1});return r?[]:t||[]}catch(t){return[]}},Fo=async()=>{try{const{data:e,error:t}=await Gn.from("credit_transactions").select("*").order("created_at",{ascending:!1}).limit(100);return t?[]:e||[]}catch(e){return[]}},Wo=async e=>{try{const{data:t,error:r}=await Gn.from("code_redemptions").select("*").eq("user_id",e).order("redeemed_at",{ascending:!1});return r?[]:t||[]}catch(t){return[]}},Vo=Object.freeze(Object.defineProperty({__proto__:null,addUserCredits:$i,adminGrantCredits:Bo,banUser:Ii,broadcastNotification:Li,canDeleteEvent:oi,checkConnectStatus:no,checkIfUserLikedEvent:di,checkUserCredits:Di,claimCampaignIncentive:Vi,createCampaign:zi,createConnectAccount:eo,createEvent:ai,createNotification:_i,createPlatformMedia:Co,createPressMention:Eo,createSuccessStory:_o,createTicketTemplates:async(e,t)=>{try{const r=t.map(t=>({event_id:e,name:t.name,type:t.type,price:t.price||0,quantity_total:t.quantity_total||100,quantity_available:t.quantity_available||t.quantity_total||100,quantity_sold:0,description:t.description,sale_start:t.sale_start,sale_end:t.sale_end,valid_days:t.valid_days,includes:t.includes,is_active:!0})),{data:s,error:a}=await Gn.from("ticket_templates").insert(r).select();if(a)throw a;return s||[]}catch(r){throw r}},createUser:mi,deductUserCredits:Ui,deleteCampaign:Wi,deleteEvent:ii,deleteInboxMessage:Xi,deleteNotification:ji,deletePlatformMedia:Po,deletePressMention:To,deletePromoCode:qo,deleteSuccessStory:jo,generateBetaInvitations:oo,generatePromoCodes:$o,generateReferralCode:po,getAllCreditTransactions:Fo,getAllPlatformMedia:Oo,getAllPromoCodes:Uo,getAllUsers:si,getBetaInvitations:co,getBetaStats:uo,getCampaigns:Bi,getConnectDashboardLink:to,getCreditTransactions:zo,getCurrentEnvironment:go,getEvents:ti,getFinancialLedger:Ji,getInboxMessages:Gi,getInboxStats:Yi,getInfrastructureStats:Ai,getNotifications:xi,getOrganizerAttendanceSummary:ao,getOrganizerEvents:ri,getOrganizerRatings:bo,getOrganizerRevenue:ro,getOrganizerRevenueSummary:so,getPlatformMedia:Ro,getPlatformStats:Ci,getPressMentions:So,getProductionTransitionHistory:yo,getPromoCodeStats:Do,getSuccessStories:xo,getSystemConfig:Hi,getTicketById:Ri,getTicketTemplates:Io,getTopOrganizers:wo,getUser:hi,getUserBySlug:vi,getUserCodeRedemptions:Wo,getUserReferralStats:mo,getUserTickets:Ti,getUsers:pi,likeEvent:ci,markInboxAsRead:Qi,markNotificationRead:ki,redeemBetaInvitation:lo,redeemPromoCode:Mo,replyToInboxMessage:Zi,revokeBetaInvitation:ho,safeDeleteEvent:li,signInUser:Ei,signOutUser:Ni,signUpUser:Si,submitOrganizerRating:vo,suspendUser:Pi,transitionToproduction:fo,unlikeEvent:ui,updateCampaign:Fi,updateEvent:ni,updatePlatformMedia:Ao,updatePressMention:No,updatePromoCodeStatus:Lo,updateSuccessStory:ko,updateSystemConfig:Ki,updateUser:wi,uploadAvatar:fi,uploadBanner:gi,uploadEventImage:yi,validateTicket:Oi,verifyConnectOnboarding:io},Symbol.toStringTag,{value:"Module"})),Ko=["Concert","Festival","Workshop","Party","Conference","Meetup","Sports"],Ho={free:{maxEvents:0,analytics:!1,customBranding:!1,support:"community",price:0,commissionRate:.05,description:"Perfect for exploring and attending events",welcomeCredits:100},pro:{maxEvents:20,analytics:!0,customBranding:!1,support:"email",price:19.99,commissionRate:.03,description:"The standard for creators and promoters"},premium:{maxEvents:100,analytics:!0,customBranding:!0,support:"priority",price:49.99,commissionRate:.025,description:"Ultimate power for professional agencies",featuredPlacement:!0,affiliateTools:!0,advancedAnalytics:!0},enterprise:{maxEvents:1/0,analytics:!0,customBranding:!0,support:"dedicated",price:149.99,commissionRate:.015,description:"White-labeling & Global Infrastructure",featuredPlacement:!0,affiliateTools:!0,advancedAnalytics:!0,whiteLabelDashboard:!0,customLandingPage:!0,apiAccess:!0,dedicatedManager:!0}},Jo=({user:e,onOpenAuth:t})=>{var r,a,n,i;const o=he(),[l,c]=s.useState(null),[u,h]=s.useState(!1),[p,m]=s.useState([]),[f,g]=s.useState(!0),[y,w]=s.useState([]),[v,b]=s.useState([]),[x,_]=s.useState(null),[k,j]=s.useState(null),[S,E]=s.useState(""),[N,T]=s.useState("idle"),[R,O]=s.useState(null);s.useEffect(()=>{(async()=>{try{const t=(await Bi()).filter(e=>"Active"===e.status&&("landing_page"===e.placement||"both"===e.placement));if(t.length>0){const r=t[0];c(r),u||e||(await C(r.id),h(!0))}}catch(t){}})()},[e,u]),s.useEffect(()=>{(async()=>{g(!0);try{const e=await wo(6,"enterprise");m(e)}catch(e){}finally{g(!1)}})()},[]),s.useEffect(()=>{(async()=>{try{const[e,t,r,s]=await Promise.all([xo(3,!0),So(6,!0),Ci(),Ro("landing_demo","walkthrough_video")]);w(e),b(t),_(r),O(s&&s.length>0?s[0]:null)}catch(e){}})()},[]);const C=async e=>{try{const{error:t}=await Gn.rpc("increment_campaign_metric",{p_campaign_id:e,p_metric:"views",p_amount:1});if(t)throw t}catch(t){}},A=()=>{e?o("/create"):t()};return d.jsxs("div",{className:"space-y-24 pb-24",children:[d.jsx("section",{className:"px-4 pt-6",children:d.jsx("div",{className:"max-w-7xl mx-auto bg-gradient-to-r from-amber-900/40 via-yellow-900/40 to-amber-900/40 border-2 border-amber-500/60 rounded-2xl p-5 md:p-6 shadow-2xl",children:d.jsxs("div",{className:"flex flex-col md:flex-row items-start md:items-center gap-4",children:[d.jsx("div",{className:"flex-shrink-0",children:d.jsx("div",{className:"w-12 h-12 bg-amber-500/20 rounded-xl flex items-center justify-center",children:d.jsx(Mt,{className:"w-6 h-6 text-amber-400"})})}),d.jsxs("div",{className:"flex-1 space-y-2",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("h3",{className:"text-xl md:text-2xl font-bold text-amber-50",children:"Testing Phase Active"}),d.jsx("span",{className:"bg-amber-500 px-2 py-0.5 rounded-full text-[10px] font-black uppercase tracking-wider text-amber-950",children:"Beta"})]}),d.jsxs("p",{className:"text-amber-100/90 text-sm md:text-base leading-relaxed",children:["EventNexus is currently in ",d.jsx("strong",{children:"testing phase"}),". All payments are processed through a ",d.jsx("strong",{children:"secure sandbox environment"})," â€” no real money is charged.",d.jsx("span",{className:"hidden md:inline",children:" You can explore all features risk-free and help us improve the platform."})]}),d.jsx("div",{className:"bg-amber-950/30 border border-amber-600/40 rounded-xl p-4 mt-3",children:d.jsxs("div",{className:"flex items-start gap-3",children:[d.jsx(zt,{className:"w-5 h-5 text-amber-400 flex-shrink-0 mt-0.5"}),d.jsxs("div",{children:[d.jsx("p",{className:"text-amber-50 font-semibold text-sm md:text-base",children:"Early Adopter Benefit"}),d.jsxs("p",{className:"text-amber-100/80 text-xs md:text-sm mt-1",children:["The first ",d.jsx("strong",{children:"100 users"})," will receive ",d.jsx("strong",{children:"1 month of Pro access absolutely free"})," when EventNexus officially launches. No credit card required during testing."]})]})]})})]})]})})}),d.jsx("section",{className:"px-4",children:d.jsx("a",{href:"/#/beta",className:"block",children:d.jsx("div",{className:"max-w-7xl mx-auto bg-gradient-to-r from-purple-900/50 to-indigo-900/50 border border-purple-500/50 rounded-[32px] p-6 md:p-8 hover:border-purple-400 transition-all shadow-2xl",children:d.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between gap-4",children:[d.jsxs("div",{className:"flex-1",children:[d.jsx("div",{className:"inline-flex items-center gap-2 bg-purple-600 px-3 py-1 rounded-full text-[10px] font-black uppercase tracking-widest text-white mb-3",children:"ðŸš€ Join the Beta"}),d.jsx("h3",{className:"text-2xl md:text-3xl font-bold mb-2",children:"Become a Beta Tester"}),d.jsx("p",{className:"text-slate-300",children:"Get 1000 credits, early access to features, and help shape EventNexus"})]}),d.jsxs("div",{className:"flex items-center gap-3 whitespace-nowrap",children:[d.jsx("span",{className:"text-sm font-semibold text-purple-300",children:"Limited spots available"}),d.jsx(ot,{size:20,className:"text-purple-400"})]})]})})})}),l&&!e&&d.jsx("section",{className:"px-4",children:d.jsxs("div",{className:"max-w-7xl mx-auto bg-slate-900 border border-slate-800 rounded-[32px] overflow-hidden flex flex-col md:flex-row relative group cursor-pointer hover:border-orange-500/50 transition-all shadow-2xl",onClick:async()=>{l&&(await(async e=>{try{const{error:t}=await Gn.rpc("increment_campaign_metric",{p_campaign_id:e,p_metric:"clicks",p_amount:1});if(t)throw t}catch(t){}})(l.id),localStorage.setItem("pendingCampaignClaim",l.id)),t()},children:[d.jsxs("div",{className:"md:w-1/2 p-10 md:p-14 space-y-6 relative z-10",children:[d.jsxs("div",{className:"inline-flex items-center gap-2 bg-orange-600 px-3 py-1 rounded-full text-[10px] font-black uppercase tracking-widest text-white shadow-lg shadow-orange-600/20",children:[d.jsx(Gt,{size:12,className:"fill-current"})," Limited Offer"]}),d.jsx("h2",{className:"text-4xl md:text-5xl font-black tracking-tighter leading-none",children:l.title}),d.jsx("p",{className:"text-lg text-slate-400 font-medium leading-relaxed",children:l.copy}),d.jsxs("div",{className:"pt-2 flex items-center gap-6",children:[d.jsxs("button",{className:"bg-white text-slate-950 px-8 py-4 rounded-2xl font-bold text-sm shadow-xl flex items-center gap-2",children:[l.cta," ",d.jsx(ot,{size:16})]}),d.jsxs("div",{className:"flex flex-col",children:[d.jsx("p",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest",children:"Incentive Status"}),d.jsxs("p",{className:"text-sm font-bold text-orange-500",children:[l.incentive.limit-l.incentive.redeemed," Spots Left"]})]})]})]}),d.jsxs("div",{className:"md:w-1/2 h-64 md:h-auto relative",children:[d.jsx("img",{src:l.imageUrl,className:"w-full h-full object-cover opacity-60 group-hover:scale-105 transition-transform duration-[10s]",alt:""}),d.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-slate-900 via-transparent to-transparent md:block hidden"}),d.jsxs("div",{className:"absolute bottom-6 right-8 bg-slate-950/80 backdrop-blur-md px-6 py-4 rounded-3xl border border-slate-800 flex items-center gap-4 shadow-2xl",children:[d.jsx("div",{className:"w-12 h-12 bg-orange-600/10 rounded-2xl flex items-center justify-center text-orange-500",children:d.jsx(xt,{size:24})}),d.jsxs("div",{children:[d.jsx("p",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest",children:"Reward Value"}),d.jsxs("p",{className:"text-xl font-black text-white",children:["â‚¬",(.5*l.incentive.value).toFixed(2)]})]})]})]})]})}),d.jsxs("section",{className:"relative px-4 pt-20 pb-32 flex flex-col items-center text-center overflow-hidden",children:[d.jsx("div",{className:"absolute top-0 left-1/2 -translate-x-1/2 w-[800px] h-[400px] bg-indigo-600/20 rounded-full blur-[120px] -z-10"}),d.jsxs("div",{className:"max-w-4xl mx-auto space-y-8",children:[d.jsxs("div",{className:"inline-flex items-center gap-2 bg-indigo-600/10 border border-indigo-500/20 px-4 py-2 rounded-full text-indigo-400 text-sm font-bold animate-bounce",children:[d.jsx(Gt,{className:"w-4 h-4 fill-current"})," New: AI Auto-Translation for Events"]}),d.jsxs("h1",{className:"text-4xl sm:text-6xl md:text-8xl font-black tracking-tight leading-[0.9]",children:["Discover, Create, ",d.jsx("br",{}),d.jsx("span",{className:"text-indigo-500",children:"Experience."})]}),d.jsx("p",{className:"text-base sm:text-lg md:text-xl text-slate-400 max-w-2xl mx-auto leading-relaxed px-4",children:"The world's first map-first event platform. From massive festivals to secret living room concerts â€” find your next vibe instantly."}),d.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center gap-4 pt-4",children:[d.jsxs(Ze,{to:"/map",className:"w-full sm:w-auto bg-indigo-600 hover:bg-indigo-700 px-10 py-4 rounded-2xl font-bold text-lg transition-all shadow-xl shadow-indigo-500/20 flex items-center justify-center gap-2",children:[d.jsx(Ot,{className:"w-5 h-5"})," Explore Map"]}),d.jsxs("button",{onClick:A,className:"w-full sm:w-auto bg-slate-100 text-slate-950 hover:bg-white px-10 py-4 rounded-2xl font-bold text-lg transition-all flex items-center justify-center gap-2",children:[d.jsx(It,{className:"w-5 h-5"})," Host an Event"]})]})]})]}),x&&d.jsx("section",{className:"max-w-7xl mx-auto px-4",children:d.jsxs("div",{className:"bg-gradient-to-r from-indigo-900/30 to-purple-900/30 border border-indigo-500/30 rounded-[32px] p-8 md:p-12",children:[d.jsxs("div",{className:"text-center mb-8",children:[d.jsx("h2",{className:"text-3xl md:text-4xl font-black mb-2",children:"Growing Fast, Globally"}),d.jsx("p",{className:"text-slate-400",children:"Join thousands already using EventNexus"})]}),d.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-6",children:[d.jsxs("div",{className:"text-center",children:[d.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-indigo-600/20 rounded-2xl flex items-center justify-center",children:d.jsx(ut,{className:"w-8 h-8 text-indigo-400"})}),d.jsx("div",{className:"text-3xl md:text-4xl font-black text-white mb-1",children:(null==(r=x.totalEvents)?void 0:r.toLocaleString())||"0"}),d.jsx("div",{className:"text-sm text-slate-400 font-bold",children:"Events Created"})]}),d.jsxs("div",{className:"text-center",children:[d.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-emerald-600/20 rounded-2xl flex items-center justify-center",children:d.jsx(Ft,{className:"w-8 h-8 text-emerald-400"})}),d.jsx("div",{className:"text-3xl md:text-4xl font-black text-white mb-1",children:(null==(a=x.totalTickets)?void 0:a.toLocaleString())||"0"}),d.jsx("div",{className:"text-sm text-slate-400 font-bold",children:"Tickets Sold"})]}),d.jsxs("div",{className:"text-center",children:[d.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-orange-600/20 rounded-2xl flex items-center justify-center",children:d.jsx(Ht,{className:"w-8 h-8 text-orange-400"})}),d.jsx("div",{className:"text-3xl md:text-4xl font-black text-white mb-1",children:(null==(n=x.totalUsers)?void 0:n.toLocaleString())||"0"}),d.jsx("div",{className:"text-sm text-slate-400 font-bold",children:"Active Users"})]}),d.jsxs("div",{className:"text-center",children:[d.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-purple-600/20 rounded-2xl flex items-center justify-center",children:d.jsx(_t,{className:"w-8 h-8 text-purple-400"})}),d.jsx("div",{className:"text-3xl md:text-4xl font-black text-white mb-1",children:(null==(i=x.totalOrganizers)?void 0:i.toLocaleString())||"0"}),d.jsx("div",{className:"text-sm text-slate-400 font-bold",children:"Organizers"})]})]})]})}),d.jsxs("section",{className:"max-w-7xl mx-auto px-4",children:[d.jsxs("div",{className:"text-center mb-12 space-y-3",children:[d.jsxs("div",{className:"inline-flex items-center gap-2 bg-gradient-to-r from-indigo-500/10 to-purple-500/10 px-4 py-2 rounded-full border border-indigo-500/30 mb-4",children:[d.jsx(Bt,{className:"w-4 h-4 text-indigo-400"}),d.jsx("span",{className:"text-xs font-bold text-indigo-400 uppercase tracking-wider",children:"Simple Process"})]}),d.jsx("h2",{className:"text-4xl md:text-5xl font-black tracking-tight",children:"How EventNexus Works"}),d.jsx("p",{className:"text-slate-400 text-lg max-w-2xl mx-auto",children:"Three simple steps to discover or host amazing events"})]}),d.jsxs("div",{className:"grid md:grid-cols-3 gap-8",children:[d.jsx("div",{className:"relative",children:d.jsxs("div",{className:"bg-slate-900/50 border border-slate-800 rounded-[32px] p-8 hover:border-indigo-500/50 transition-all group h-full",children:[d.jsx("div",{className:"absolute -top-4 -left-4 w-12 h-12 bg-indigo-600 rounded-2xl flex items-center justify-center text-white font-black text-xl shadow-xl shadow-indigo-600/20",children:"1"}),d.jsxs("div",{className:"mb-6 mt-4",children:[d.jsx("div",{className:"w-16 h-16 bg-indigo-600/20 rounded-2xl flex items-center justify-center mb-4 group-hover:scale-110 transition-transform",children:d.jsx(Ot,{className:"w-8 h-8 text-indigo-400"})}),d.jsx("h3",{className:"text-2xl font-bold mb-3",children:"Explore the Map"}),d.jsx("p",{className:"text-slate-400 leading-relaxed",children:"Browse events on an interactive map. Use filters, radius search, and categories to find exactly what you're looking for."})]})]})}),d.jsx("div",{className:"relative",children:d.jsxs("div",{className:"bg-slate-900/50 border border-slate-800 rounded-[32px] p-8 hover:border-emerald-500/50 transition-all group h-full",children:[d.jsx("div",{className:"absolute -top-4 -left-4 w-12 h-12 bg-emerald-600 rounded-2xl flex items-center justify-center text-white font-black text-xl shadow-xl shadow-emerald-600/20",children:"2"}),d.jsxs("div",{className:"mb-6 mt-4",children:[d.jsx("div",{className:"w-16 h-16 bg-emerald-600/20 rounded-2xl flex items-center justify-center mb-4 group-hover:scale-110 transition-transform",children:d.jsx(Ft,{className:"w-8 h-8 text-emerald-400"})}),d.jsx("h3",{className:"text-2xl font-bold mb-3",children:"Get Your Ticket"}),d.jsx("p",{className:"text-slate-400 leading-relaxed",children:"Secure checkout with Stripe. Receive a fraud-proof QR code instantly via email. No paper needed."})]})]})}),d.jsx("div",{className:"relative",children:d.jsxs("div",{className:"bg-slate-900/50 border border-slate-800 rounded-[32px] p-8 hover:border-orange-500/50 transition-all group h-full",children:[d.jsx("div",{className:"absolute -top-4 -left-4 w-12 h-12 bg-orange-600 rounded-2xl flex items-center justify-center text-white font-black text-xl shadow-xl shadow-orange-600/20",children:"3"}),d.jsxs("div",{className:"mb-6 mt-4",children:[d.jsx("div",{className:"w-16 h-16 bg-orange-600/20 rounded-2xl flex items-center justify-center mb-4 group-hover:scale-110 transition-transform",children:d.jsx(Gt,{className:"w-8 h-8 text-orange-400"})}),d.jsx("h3",{className:"text-2xl font-bold mb-3",children:"Enjoy the Event"}),d.jsx("p",{className:"text-slate-400 leading-relaxed",children:"Show your QR code at entry. Rate the organizer after. Follow them to get notified about future events."})]})]})})]}),d.jsx("div",{className:"text-center mt-12",children:d.jsxs(Ze,{to:"/map",className:"inline-flex items-center gap-2 px-10 py-4 bg-indigo-600 hover:bg-indigo-700 rounded-2xl text-white font-bold text-lg transition-all shadow-xl shadow-indigo-500/20",children:["Start Exploring ",d.jsx(ot,{className:"w-5 h-5"})]})})]}),R&&d.jsx("section",{className:"max-w-7xl mx-auto px-4",children:d.jsx("div",{className:"bg-gradient-to-br from-slate-900 to-slate-950 border border-slate-800 rounded-[48px] overflow-hidden",children:d.jsxs("div",{className:"grid md:grid-cols-2 gap-0",children:[d.jsxs("div",{className:"p-12 md:p-16 flex flex-col justify-center",children:[d.jsxs("div",{className:"inline-flex items-center gap-2 bg-indigo-600/10 px-4 py-2 rounded-full border border-indigo-500/30 mb-6 w-fit",children:[d.jsx(Pt,{className:"w-4 h-4 text-indigo-400"}),d.jsx("span",{className:"text-xs font-bold text-indigo-400 uppercase tracking-wider",children:"Watch Demo"})]}),d.jsx("h2",{className:"text-4xl md:text-5xl font-black tracking-tight mb-6",children:R.title}),R.description&&d.jsx("p",{className:"text-slate-400 text-lg leading-relaxed mb-8",children:R.description}),d.jsxs("ul",{className:"space-y-4 mb-8",children:[d.jsxs("li",{className:"flex items-center gap-3",children:[d.jsx("div",{className:"w-6 h-6 bg-emerald-600/20 rounded-lg flex items-center justify-center flex-shrink-0",children:d.jsx(dt,{className:"w-4 h-4 text-emerald-400"})}),d.jsx("span",{className:"text-slate-300",children:"Interactive map-based discovery"})]}),d.jsxs("li",{className:"flex items-center gap-3",children:[d.jsx("div",{className:"w-6 h-6 bg-emerald-600/20 rounded-lg flex items-center justify-center flex-shrink-0",children:d.jsx(dt,{className:"w-4 h-4 text-emerald-400"})}),d.jsx("span",{className:"text-slate-300",children:"Instant ticket purchasing & QR codes"})]}),d.jsxs("li",{className:"flex items-center gap-3",children:[d.jsx("div",{className:"w-6 h-6 bg-emerald-600/20 rounded-lg flex items-center justify-center flex-shrink-0",children:d.jsx(dt,{className:"w-4 h-4 text-emerald-400"})}),d.jsx("span",{className:"text-slate-300",children:"AI-powered event translation"})]})]}),d.jsxs("button",{onClick:t,className:"inline-flex items-center gap-2 px-8 py-4 bg-indigo-600 hover:bg-indigo-700 rounded-2xl text-white font-bold transition-all w-fit",children:["Get Started Free ",d.jsx(ot,{className:"w-5 h-5"})]})]}),d.jsx("div",{className:"relative bg-slate-950 flex items-center justify-center p-8 md:p-12",children:R.video_url?d.jsxs("div",{className:"relative w-full aspect-video bg-slate-900 rounded-3xl border border-slate-800 overflow-hidden",children:[d.jsx("iframe",{src:R.video_url.includes("youtube.com")||R.video_url.includes("youtu.be")?R.video_url.replace("watch?v=","embed/").replace("youtu.be/","youtube.com/embed/"):R.video_url,title:R.title,className:"w-full h-full",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0}),R.duration&&d.jsxs("div",{className:"absolute bottom-6 left-6 right-6 bg-slate-950/80 backdrop-blur-md rounded-2xl p-4 border border-slate-800",children:[d.jsx("p",{className:"text-sm font-bold text-white",children:R.title}),d.jsxs("p",{className:"text-xs text-slate-400 mt-1",children:[R.duration," â€¢ ",R.media_type.replace("_"," ")]})]})]}):d.jsxs("div",{className:"relative w-full aspect-video bg-slate-900 rounded-3xl border border-slate-800 overflow-hidden group cursor-pointer hover:border-indigo-500/50 transition-all",children:[d.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-indigo-600/20 to-purple-600/20"}),d.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:d.jsx("div",{className:"w-20 h-20 bg-white rounded-full flex items-center justify-center shadow-2xl group-hover:scale-110 transition-transform",children:d.jsx(Pt,{className:"w-8 h-8 text-slate-950 ml-1",fill:"currentColor"})})})]})})]})})}),p.length>0&&d.jsxs("section",{className:"max-w-7xl mx-auto px-4",children:[d.jsxs("div",{className:"text-center mb-12 space-y-3",children:[d.jsxs("div",{className:"inline-flex items-center gap-2 bg-gradient-to-r from-yellow-500/10 to-orange-500/10 px-4 py-2 rounded-full border border-yellow-500/30 mb-4",children:[d.jsx(lt,{className:"w-4 h-4 text-yellow-400"}),d.jsx("span",{className:"text-xs font-bold text-yellow-400 uppercase tracking-wider",children:"Top Rated"})]}),d.jsx("h2",{className:"text-4xl md:text-5xl font-black tracking-tight",children:"Featured Event Organizers"}),d.jsx("p",{className:"text-slate-400 text-lg max-w-2xl mx-auto",children:"Trusted by the community. Rated by real attendees."})]}),d.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:p.map(e=>d.jsxs(Ze,{to:`/agency/${e.agency_slug}`,className:"group bg-slate-900/50 border border-slate-800 rounded-[32px] p-6 hover:border-indigo-500/50 transition-all hover:shadow-xl hover:shadow-indigo-500/10",children:[d.jsxs("div",{className:"flex items-start justify-between mb-4",children:[d.jsxs("div",{className:"flex-1",children:[d.jsx("h3",{className:"text-xl font-black text-white mb-2 group-hover:text-indigo-400 transition-colors",children:e.organizer_name}),d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("div",{className:"flex items-center gap-1",children:[...Array(5)].map((t,r)=>d.jsx(zt,{size:14,className:""+(r<Math.round(e.avg_rating)?"fill-yellow-400 text-yellow-400":"text-slate-700")},r))}),d.jsx("span",{className:"text-sm font-bold text-white",children:e.avg_rating.toFixed(1)}),d.jsxs("span",{className:"text-xs text-slate-500",children:["(",e.total_ratings," ",1===e.total_ratings?"review":"reviews",")"]})]})]}),d.jsx("div",{className:"px-3 py-1 bg-purple-600/20 border border-purple-500/30 rounded-full",children:d.jsx("span",{className:"text-[10px] font-black text-purple-400 uppercase tracking-wider",children:e.subscription_tier})})]}),d.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-4",children:[d.jsxs("div",{className:"bg-slate-800/50 rounded-xl p-3",children:[d.jsx("div",{className:"text-2xl font-black text-indigo-400",children:e.events_rated}),d.jsx("div",{className:"text-xs text-slate-500 uppercase tracking-wider",children:"Events"})]}),d.jsxs("div",{className:"bg-slate-800/50 rounded-xl p-3",children:[d.jsx("div",{className:"text-2xl font-black text-emerald-400",children:e.weighted_score.toFixed(1)}),d.jsx("div",{className:"text-xs text-slate-500 uppercase tracking-wider",children:"Score"})]})]}),d.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-slate-800",children:[d.jsx("span",{className:"text-xs text-slate-400 font-medium",children:"View Profile"}),d.jsx(pt,{className:"w-5 h-5 text-slate-600 group-hover:text-indigo-400 group-hover:translate-x-1 transition-all"})]})]},e.organizer_id))}),d.jsx("div",{className:"text-center mt-12",children:d.jsxs(Ze,{to:"/explore",className:"inline-flex items-center gap-2 px-8 py-4 bg-slate-900 hover:bg-slate-800 border border-slate-800 hover:border-indigo-500/50 rounded-2xl text-white font-bold transition-all group",children:[d.jsx(Vt,{className:"w-5 h-5 group-hover:text-indigo-400 transition-colors"}),"Explore All Organizers",d.jsx(ot,{className:"w-5 h-5 group-hover:translate-x-1 transition-transform"})]})})]}),y.length>0&&d.jsxs("section",{className:"max-w-7xl mx-auto px-4",children:[d.jsxs("div",{className:"text-center mb-12 space-y-3",children:[d.jsxs("div",{className:"inline-flex items-center gap-2 bg-gradient-to-r from-green-500/10 to-emerald-500/10 px-4 py-2 rounded-full border border-green-500/30 mb-4",children:[d.jsx(lt,{className:"w-4 h-4 text-green-400"}),d.jsx("span",{className:"text-xs font-bold text-green-400 uppercase tracking-wider",children:"Success Stories"})]}),d.jsx("h2",{className:"text-4xl md:text-5xl font-black tracking-tight",children:"Real Results from Real Organizers"}),d.jsx("p",{className:"text-slate-400 text-lg max-w-2xl mx-auto",children:"See how EventNexus helps organizers grow their events"})]}),d.jsx("div",{className:"grid md:grid-cols-3 gap-6",children:y.map(e=>d.jsxs("div",{className:"bg-slate-900/50 border border-slate-800 rounded-[32px] p-8 hover:border-green-500/50 transition-all group",children:[d.jsxs("div",{className:"mb-6",children:[d.jsx($t,{className:"w-10 h-10 text-green-500/20 mb-4"}),d.jsxs("p",{className:"text-slate-300 italic leading-relaxed mb-6",children:['"',e.quote,'"']})]}),d.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.avatar_url&&d.jsx("img",{src:e.avatar_url,alt:e.organizer_name,className:"w-12 h-12 rounded-full object-cover"}),d.jsxs("div",{children:[d.jsx("p",{className:"font-bold text-white",children:e.organizer_name}),e.organizer_role&&d.jsx("p",{className:"text-sm text-slate-400",children:e.organizer_role})]})]}),e.event_type&&d.jsx("div",{className:"inline-block bg-green-500/10 border border-green-500/30 px-3 py-1 rounded-full",children:d.jsx("span",{className:"text-xs font-bold text-green-400",children:e.event_type})})]},e.id))})]}),v.length>0&&d.jsxs("section",{className:"max-w-7xl mx-auto px-4",children:[d.jsxs("div",{className:"text-center mb-12 space-y-3",children:[d.jsxs("div",{className:"inline-flex items-center gap-2 bg-gradient-to-r from-blue-500/10 to-cyan-500/10 px-4 py-2 rounded-full border border-blue-500/30 mb-4",children:[d.jsx(At,{className:"w-4 h-4 text-blue-400"}),d.jsx("span",{className:"text-xs font-bold text-blue-400 uppercase tracking-wider",children:"In the Press"})]}),d.jsx("h2",{className:"text-4xl md:text-5xl font-black tracking-tight",children:"Media Coverage"}),d.jsx("p",{className:"text-slate-400 text-lg max-w-2xl mx-auto",children:"What the media is saying about EventNexus"})]}),d.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:v.map(e=>d.jsxs("a",{href:e.article_url,target:"_blank",rel:"noopener noreferrer",className:"bg-slate-900/50 border border-slate-800 rounded-[24px] p-6 hover:border-blue-500/50 transition-all group block",children:[e.publication_logo_url&&d.jsx("div",{className:"mb-4 h-12 flex items-center",children:d.jsx("img",{src:e.publication_logo_url,alt:e.publication_name,className:"max-h-full max-w-full object-contain"})}),d.jsx("p",{className:"font-bold text-slate-500 text-xs uppercase tracking-wider mb-2",children:e.publication_name}),d.jsx("h3",{className:"font-bold text-white mb-3 group-hover:text-blue-400 transition-colors line-clamp-2",children:e.article_title}),e.excerpt&&d.jsx("p",{className:"text-sm text-slate-400 mb-4 line-clamp-3",children:e.excerpt}),d.jsxs("div",{className:"flex items-center justify-between text-xs text-slate-500",children:[d.jsx("span",{children:new Date(e.published_date).toLocaleDateString()}),d.jsx(vt,{className:"w-4 h-4 group-hover:text-blue-400 transition-colors"})]})]},e.id))})]}),d.jsxs("section",{className:"max-w-7xl mx-auto px-4",children:[d.jsxs("div",{className:"text-center mb-12 space-y-3",children:[d.jsxs("div",{className:"inline-flex items-center gap-2 bg-gradient-to-r from-emerald-500/10 to-green-500/10 px-4 py-2 rounded-full border border-emerald-500/30 mb-4",children:[d.jsx(wt,{className:"w-4 h-4 text-emerald-400"}),d.jsx("span",{className:"text-xs font-bold text-emerald-400 uppercase tracking-wider",children:"Transparent Pricing"})]}),d.jsx("h2",{className:"text-4xl md:text-5xl font-black tracking-tight",children:"Choose Your Plan"}),d.jsx("p",{className:"text-slate-400 text-lg max-w-2xl mx-auto",children:"Start free, upgrade when you grow. No hidden fees."})]}),d.jsx("div",{className:"grid md:grid-cols-4 gap-6",children:Object.entries(Ho).map(([e,r])=>d.jsxs("div",{className:"bg-slate-900/50 border rounded-[32px] p-8 hover:border-indigo-500/50 transition-all group relative "+("pro"===e?"border-indigo-500 shadow-xl shadow-indigo-500/10":"border-slate-800"),children:["pro"===e&&d.jsx("div",{className:"absolute -top-4 left-1/2 -translate-x-1/2 bg-indigo-600 px-4 py-1 rounded-full text-xs font-black text-white uppercase tracking-wider",children:"Popular"}),d.jsxs("div",{className:"text-center mb-6",children:[d.jsx("h3",{className:"text-2xl font-black capitalize mb-2",children:e}),d.jsxs("div",{className:"mb-3",children:[d.jsxs("span",{className:"text-4xl font-black text-white",children:["â‚¬",r.price]}),r.price>0&&d.jsx("span",{className:"text-slate-500",children:"/mo"})]}),d.jsx("p",{className:"text-sm text-slate-400",children:r.description})]}),d.jsxs("ul",{className:"space-y-3 mb-8",children:[d.jsxs("li",{className:"flex items-start gap-2 text-sm",children:[d.jsx(dt,{className:"w-5 h-5 text-emerald-400 flex-shrink-0 mt-0.5"}),d.jsx("span",{className:"text-slate-300",children:r.maxEvents===1/0?"Unlimited":0===r.maxEvents?"Attend events":`${r.maxEvents} events`})]}),d.jsxs("li",{className:"flex items-start gap-2 text-sm",children:[d.jsx(dt,{className:"w-5 h-5 text-emerald-400 flex-shrink-0 mt-0.5"}),d.jsxs("span",{className:"text-slate-300",children:[(100*r.commissionRate).toFixed(1),"% platform fee"]})]}),r.analytics&&d.jsxs("li",{className:"flex items-start gap-2 text-sm",children:[d.jsx(dt,{className:"w-5 h-5 text-emerald-400 flex-shrink-0 mt-0.5"}),d.jsx("span",{className:"text-slate-300",children:"Advanced analytics"})]}),r.customBranding&&d.jsxs("li",{className:"flex items-start gap-2 text-sm",children:[d.jsx(dt,{className:"w-5 h-5 text-emerald-400 flex-shrink-0 mt-0.5"}),d.jsx("span",{className:"text-slate-300",children:"Custom branding"})]}),r.welcomeCredits&&d.jsxs("li",{className:"flex items-start gap-2 text-sm",children:[d.jsx(dt,{className:"w-5 h-5 text-emerald-400 flex-shrink-0 mt-0.5"}),d.jsxs("span",{className:"text-slate-300",children:[r.welcomeCredits," welcome credits"]})]})]}),d.jsx("button",{onClick:t,className:"w-full py-3 rounded-2xl font-bold transition-all "+("pro"===e?"bg-indigo-600 hover:bg-indigo-700 text-white":"bg-slate-800 hover:bg-slate-700 text-white"),children:"free"===e?"Start Free":"Get Started"})]},e))}),d.jsx("div",{className:"text-center mt-8",children:d.jsxs(Ze,{to:"/pricing",className:"text-indigo-400 hover:text-indigo-300 font-bold inline-flex items-center gap-2",children:["View Full Pricing Details ",d.jsx(ot,{className:"w-4 h-4"})]})})]}),d.jsxs("section",{className:"max-w-7xl mx-auto px-4 grid md:grid-cols-3 gap-8",children:[d.jsx(Go,{icon:d.jsx(yt,{className:"w-8 h-8"}),title:"Map-First Discovery",description:"Forget lists. Explore events exactly where they are. Radius search and smart filters built-in."}),d.jsx(Go,{icon:d.jsx(_t,{className:"w-8 h-8"}),title:"AI Translation",description:"Powered by Gemini. Host events in any language; reach a global audience automatically."}),d.jsx(Go,{icon:d.jsx(Mt,{className:"w-8 h-8"}),title:"Secure Ticketing",description:"Fraud-proof QR codes and instant validation. Secure payments via Stripe."})]}),d.jsxs("section",{className:"max-w-4xl mx-auto px-4",children:[d.jsxs("div",{className:"text-center mb-12 space-y-3",children:[d.jsxs("div",{className:"inline-flex items-center gap-2 bg-gradient-to-r from-purple-500/10 to-pink-500/10 px-4 py-2 rounded-full border border-purple-500/30 mb-4",children:[d.jsx(Mt,{className:"w-4 h-4 text-purple-400"}),d.jsx("span",{className:"text-xs font-bold text-purple-400 uppercase tracking-wider",children:"FAQs"})]}),d.jsx("h2",{className:"text-4xl md:text-5xl font-black tracking-tight",children:"Frequently Asked Questions"}),d.jsx("p",{className:"text-slate-400 text-lg max-w-2xl mx-auto",children:"Everything you need to know about EventNexus"})]}),d.jsx("div",{className:"space-y-4",children:[{question:"Is EventNexus really free to use?",answer:"Yes! You can create a free account and browse all events. Attendees pay no platform fees. Organizers can start with our Free tier (100 welcome credits) or upgrade to unlock more features."},{question:"How does ticketing work?",answer:"Purchase tickets securely with Stripe. You will receive a unique QR code via email instantly. Show it at the event entrance for instant validation. No printing needed!"},{question:"What happens during the testing phase?",answer:"All payments are processed through a secure sandbox environment - no real money is charged. This allows you to test all features risk-free. The first 100 users get 1 month of Pro access free when we launch!"},{question:"Can I translate my event to multiple languages?",answer:"Absolutely! Our AI-powered translation (powered by Google Gemini) automatically translates your event description to 50+ languages, helping you reach a global audience instantly."},{question:"What are the platform fees?",answer:"Platform fees range from 1.5% to 5% depending on your subscription tier. Free tier: 5%, Pro: 3%, Premium: 2.5%, Enterprise: 1.5%. No hidden costs - what you see is what you pay."},{question:"How do refunds work?",answer:"Full refund if cancelled 7+ days before the event. 50% refund if 3-7 days before. No refund within 3 days of the event. Organizers receive payouts 2 days after the event completes."},{question:"Is my data secure?",answer:"Yes! We use Supabase with PostgreSQL for database security, Stripe for secure payment processing, and implement Row Level Security (RLS) policies. All data is encrypted and GDPR-compliant."},{question:"Can I use EventNexus for private events?",answer:"Yes! You can set event visibility to Public, Private, or Semi-Private. Private events are only visible to people with the direct link."}].map((e,t)=>d.jsxs("div",{className:"bg-slate-900/50 border border-slate-800 rounded-2xl overflow-hidden hover:border-indigo-500/50 transition-all",children:[d.jsxs("button",{onClick:()=>j(k===t?null:t),className:"w-full p-6 flex items-center justify-between text-left group",children:[d.jsx("span",{className:"font-bold text-white group-hover:text-indigo-400 transition-colors pr-4",children:e.question}),d.jsx(ht,{className:"w-5 h-5 text-slate-400 flex-shrink-0 transition-transform "+(k===t?"rotate-180":"")})]}),k===t&&d.jsx("div",{className:"px-6 pb-6 text-slate-400 leading-relaxed animate-in slide-in-from-top-2",children:e.answer})]},t))}),d.jsxs("div",{className:"text-center mt-12",children:[d.jsx("p",{className:"text-slate-400 mb-4",children:"Still have questions?"}),d.jsxs(Ze,{to:"/help",className:"inline-flex items-center gap-2 px-8 py-4 bg-slate-900 hover:bg-slate-800 border border-slate-800 hover:border-indigo-500/50 rounded-2xl text-white font-bold transition-all",children:["Visit Help Center ",d.jsx(ot,{className:"w-5 h-5"})]})]})]}),d.jsx("section",{className:"max-w-4xl mx-auto px-4",children:d.jsxs("div",{className:"bg-gradient-to-br from-indigo-900/40 to-purple-900/40 border border-indigo-500/30 rounded-[40px] p-12 md:p-16 text-center relative overflow-hidden",children:[d.jsx("div",{className:"absolute top-0 right-0 w-96 h-96 bg-indigo-500/10 rounded-full blur-3xl"}),d.jsxs("div",{className:"relative z-10",children:[d.jsxs("div",{className:"inline-flex items-center gap-2 bg-indigo-600/20 px-4 py-2 rounded-full border border-indigo-500/30 mb-6",children:[d.jsx(Rt,{className:"w-4 h-4 text-indigo-400"}),d.jsx("span",{className:"text-xs font-bold text-indigo-400 uppercase tracking-wider",children:"Stay Updated"})]}),d.jsx("h2",{className:"text-3xl md:text-4xl font-black tracking-tight mb-4",children:"Get Event Recommendations"}),d.jsx("p",{className:"text-slate-300 text-lg mb-8 max-w-2xl mx-auto",children:"Subscribe to our newsletter and get personalized event recommendations, early access to new features, and exclusive organizer tips."}),d.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),S&&/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(S)){T("loading");try{const{error:e}=await Gn.from("newsletter_signups").insert({email:S,source:"landing_page"});if(e&&"23505"!==e.code)throw e;T("success"),E(""),setTimeout(()=>T("idle"),3e3)}catch(t){T("error"),setTimeout(()=>T("idle"),3e3)}}else T("error")},className:"max-w-md mx-auto",children:[d.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[d.jsx("input",{type:"email",value:S,onChange:e=>E(e.target.value),placeholder:"Enter your email",disabled:"loading"===N||"success"===N,className:"flex-1 px-6 py-4 bg-slate-950 border border-slate-800 rounded-2xl text-white placeholder-slate-500 focus:outline-none focus:border-indigo-500 transition-all disabled:opacity-50",required:!0}),d.jsx("button",{type:"submit",disabled:"loading"===N||"success"===N,className:"px-8 py-4 bg-indigo-600 hover:bg-indigo-700 disabled:bg-emerald-600 disabled:cursor-not-allowed rounded-2xl font-bold text-white transition-all flex items-center justify-center gap-2 whitespace-nowrap",children:"loading"===N?"Subscribing...":"success"===N?d.jsxs(d.Fragment,{children:[d.jsx(dt,{className:"w-5 h-5"})," Subscribed!"]}):d.jsxs(d.Fragment,{children:[d.jsx(Dt,{className:"w-5 h-5"})," Subscribe"]})})]}),"error"===N&&d.jsx("p",{className:"text-red-400 text-sm mt-3",children:"Invalid email or already subscribed"}),d.jsx("p",{className:"text-slate-500 text-xs mt-4",children:"No spam. Unsubscribe anytime. By subscribing, you agree to our Privacy Policy."})]})]})]})}),d.jsx("section",{className:"max-w-6xl mx-auto px-4",children:d.jsxs("div",{className:"bg-indigo-600 rounded-[40px] p-12 md:p-20 text-center relative overflow-hidden shadow-2xl shadow-indigo-600/20",children:[d.jsx("div",{className:"absolute top-0 right-0 w-96 h-96 bg-white/10 rounded-full blur-3xl -mr-48 -mt-48"}),d.jsxs("div",{className:"relative z-10 space-y-6",children:[d.jsx("h2",{className:"text-4xl md:text-5xl font-black tracking-tight",children:"Ready to host?"}),d.jsx("p",{className:"text-indigo-100 text-lg max-w-2xl mx-auto",children:"Join thousands of organizers using EventNexus to manage tickets, track analytics, and promote their experiences."}),d.jsx("div",{className:"pt-6",children:d.jsxs("button",{onClick:A,className:"bg-white text-indigo-600 px-12 py-4 rounded-2xl font-bold text-lg hover:bg-indigo-50 transition-all inline-flex items-center gap-2",children:["Get Started ",d.jsx(pt,{className:"w-5 h-5"})]})})]})]})})]})},Go=({icon:e,title:t,description:r})=>d.jsxs("div",{className:"bg-slate-900/50 border border-slate-800 p-8 rounded-[32px] hover:border-indigo-500/50 transition-all group",children:[d.jsx("div",{className:"bg-indigo-600/10 text-indigo-500 w-16 h-16 rounded-2xl flex items-center justify-center mb-6 group-hover:scale-110 transition-transform",children:e}),d.jsx("h3",{className:"text-xl font-bold mb-3",children:t}),d.jsx("p",{className:"text-slate-400 leading-relaxed text-sm",children:r})]}),Yo=({to:e,children:t})=>d.jsx("li",{children:d.jsx(Ze,{to:e,className:"text-slate-400 hover:text-white text-sm font-semibold transition-colors",children:t})}),Qo=({icon:e,href:t})=>d.jsx("a",{href:t,target:"_blank",rel:"noopener noreferrer",className:"w-10 h-10 bg-slate-900 border border-slate-800 rounded-xl flex items-center justify-center text-slate-500 hover:text-white hover:bg-slate-800 transition-all","aria-label":"Visit EventNexus on "+(t.includes("facebook")?"Facebook":t.includes("instagram")?"Instagram":t.includes("linkedin")?"LinkedIn":"social media"),children:a.cloneElement(e,{className:"w-4 h-4"})}),Zo=()=>d.jsx("footer",{className:"bg-slate-950 border-t border-slate-900 pt-20 pb-10",children:d.jsxs("div",{className:"max-w-7xl mx-auto px-4",children:[d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-12 mb-16",children:[d.jsxs("div",{className:"space-y-6",children:[d.jsxs(Ze,{to:"/",className:"flex items-center gap-2 font-bold text-2xl tracking-tighter text-white",children:[d.jsx("div",{className:"w-10 h-10 rounded-xl bg-indigo-600 flex items-center justify-center",children:d.jsx(yt,{className:"w-6 h-6 text-white"})}),d.jsx("span",{children:"EventNexus"})]}),d.jsx("p",{className:"text-slate-400 text-sm leading-relaxed max-w-xs font-medium",children:"Discover, Create, and Experience Events â€” Anywhere, Anytime. The world's first map-first discovery engine."}),d.jsxs("div",{className:"flex items-center gap-4",children:[d.jsx(Qo,{icon:d.jsx(bt,{}),href:"https://www.facebook.com/profile.php?id=61585668350154"}),d.jsx(Qo,{icon:d.jsx(kt,{}),href:"https://www.instagram.com/blogpieesti/"}),d.jsx(Qo,{icon:d.jsx(St,{}),href:"https://www.linkedin.com/company/eventnexus-eu"})]})]}),d.jsxs("div",{className:"space-y-6",children:[d.jsx("h4",{className:"text-[10px] font-black uppercase tracking-widest text-indigo-500",children:"Platform"}),d.jsxs("ul",{className:"space-y-4",children:[d.jsx(Yo,{to:"/map",children:"Event Map"}),d.jsx(Yo,{to:"/create",children:"Host an Event"}),d.jsx(Yo,{to:"/pricing",children:"Pricing & Plans"}),d.jsx(Yo,{to:"/dashboard",children:"Organizer Hub"})]})]}),d.jsxs("div",{className:"space-y-6",children:[d.jsx("h4",{className:"text-[10px] font-black uppercase tracking-widest text-indigo-500",children:"Governance"}),d.jsxs("ul",{className:"space-y-4",children:[d.jsx(Yo,{to:"/help",children:"Help Center"}),d.jsx(Yo,{to:"/terms",children:"Terms of Service"}),d.jsx(Yo,{to:"/privacy",children:"Privacy Policy"}),d.jsx(Yo,{to:"/cookies",children:"Cookie Settings"}),d.jsx(Yo,{to:"/gdpr",children:"GDPR Compliance"})]})]}),d.jsxs("div",{className:"space-y-6",children:[d.jsx("h4",{className:"text-[10px] font-black uppercase tracking-widest text-indigo-500",children:"Nexus Updates"}),d.jsx("p",{className:"text-slate-400 text-xs font-medium",children:"Subscribe for early access to secret events and organizer tips."}),d.jsxs("div",{className:"relative group",children:[d.jsx("input",{type:"email",placeholder:"email@nexus.com",className:"w-full bg-slate-900 border border-slate-800 rounded-2xl px-5 py-4 text-xs text-white outline-none focus:border-indigo-500 transition-all"}),d.jsx("button",{className:"absolute right-2 top-2 bottom-2 bg-indigo-600 px-4 rounded-xl text-[10px] font-black uppercase text-white shadow-lg",children:"Join"})]})]})]}),d.jsxs("div",{className:"pt-10 border-t border-slate-900 flex flex-col md:flex-row justify-between items-center gap-6",children:[d.jsxs("div",{className:"flex items-center gap-2 text-slate-500 text-[10px] font-black uppercase tracking-widest",children:[d.jsx(qt,{className:"w-4 h-4"})," Â© 2024 EventNexus Global. All Rights Reserved."]}),d.jsxs("div",{className:"flex items-center gap-6",children:[d.jsxs("div",{className:"flex items-center gap-2 text-slate-500 text-[10px] font-bold",children:[d.jsx(_t,{className:"w-3.5 h-3.5"})," English (US)"]}),d.jsxs("div",{className:"flex items-center gap-2 text-slate-500 text-[10px] font-bold",children:[d.jsx(Rt,{className:"w-3.5 h-3.5"})," support@mail.eventnexus.eu"]})]})]})]})}),Xo=({isOpen:e,onClose:t,onLogin:r})=>{const[a,n]=s.useState("login"),[i,o]=s.useState(!1),[l,c]=s.useState(""),[u,h]=s.useState(""),[p,m]=s.useState(""),[f,g]=s.useState("");if(!e)return null;return d.jsxs("div",{className:"fixed inset-0 z-[2000] flex items-center justify-center p-4 sm:p-6",children:[d.jsx("div",{className:"absolute inset-0 bg-slate-950/60 backdrop-blur-md",onClick:t}),d.jsxs("div",{className:"relative w-full max-w-md bg-slate-900 border border-slate-800 rounded-[40px] shadow-2xl overflow-hidden animate-in zoom-in-95 duration-300",children:[d.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-indigo-600/10 rounded-full blur-[80px] -mr-32 -mt-32 pointer-events-none"}),d.jsxs("div",{className:"p-8 sm:p-10 space-y-8 relative z-10",children:[d.jsxs("div",{className:"flex justify-between items-start",children:[d.jsxs("div",{className:"space-y-1",children:[d.jsx("h2",{className:"text-3xl font-black tracking-tighter text-white",children:"login"===a?"Welcome Back":"Create Account"}),d.jsx("p",{className:"text-slate-400 text-sm font-medium",children:"Join the global Nexus network."})]}),d.jsx("button",{onClick:t,className:"p-2 hover:bg-slate-800 rounded-xl text-slate-500 transition-colors",children:d.jsx(Jt,{className:"w-5 h-5"})})]}),d.jsxs("form",{onSubmit:async e=>{e.preventDefault(),o(!0),g("");let s=!1;const i=setTimeout(()=>{s=!0,o(!1),g("Connection timeout. Please check your internet connection and try again.")},12e3);try{if("login"===a){const{user:e,error:a}=await Ei(l,u);if(a){clearTimeout(i);const e=a.message.includes("Invalid")?"Incorrect email or password. Please check your credentials and try again.":a.message.includes("not confirmed")?"Please confirm your email address before signing in. Check your inbox for a confirmation link.":a.message||"Sign in failed. Please try again.";return g(e),void o(!1)}if(!e)return clearTimeout(i),g("No user returned from authentication."),void o(!1);const n=Date.now(),d=await hi(e.id);Date.now();if(s)return;d?(clearTimeout(i),o(!1),r(d),t(),c(""),h("")):(clearTimeout(i),o(!1),g("User profile not found. Please contact support."))}else{const{user:e,error:s}=await Si(l,u);if(s){clearTimeout(i);const e=s.message.includes("already registered")?"This email is already registered. Please sign in instead.":s.message.includes("Password")?"Password must be at least 6 characters long.":s.message||"Registration failed. Please try again.";return g(e),void o(!1)}if(!e)return clearTimeout(i),g("Registration failed. Please try again."),void o(!1);if(!e.email_confirmed_at)return clearTimeout(i),g("Registration successful! Please check your email to confirm your account before logging in."),o(!1),void setTimeout(()=>{n("login"),g("")},5e3);await new Promise(e=>setTimeout(e,1e3));const a=await hi(e.id);if(a){p&&p!==l.split("@")[0]&&(await wi(e.id,{name:p}),a.name=p);const s=localStorage.getItem("pendingCampaignClaim");if(s)try{const t=await Vi(e.id,s);if(null==t?void 0:t.success){const t=await hi(e.id);t&&(a.credits=t.credits),localStorage.removeItem("pendingCampaignClaim")}}catch(d){}clearTimeout(i),r(a),t(),c(""),h(""),m("")}else clearTimeout(i),g("Failed to load user profile. Please try logging in.")}}catch(f){clearTimeout(i);const e=f instanceof Error?f.message:"An unexpected error occurred";g(e)}finally{o(!1)}},className:"space-y-4",children:["register"===a&&d.jsxs("div",{className:"relative group",children:[d.jsx("input",{type:"text",placeholder:"Full Name",value:p,onChange:e=>m(e.target.value),required:!0,className:"w-full bg-slate-950 border border-slate-800 rounded-2xl px-12 py-4 text-sm text-white outline-none focus:border-indigo-500 transition-all"}),d.jsx("div",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-slate-600 group-focus-within:text-indigo-500 transition-colors",children:d.jsx(Bt,{className:"w-5 h-5"})})]}),d.jsxs("div",{className:"relative group",children:[d.jsx("input",{type:"email",placeholder:"Email Address",value:l,onChange:e=>c(e.target.value),required:!0,className:"w-full bg-slate-950 border border-slate-800 rounded-2xl px-12 py-4 text-sm text-white outline-none focus:border-indigo-500 transition-all"}),d.jsx("div",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-slate-600 group-focus-within:text-indigo-500 transition-colors",children:d.jsx(Rt,{className:"w-5 h-5"})})]}),d.jsxs("div",{className:"relative group",children:[d.jsx("input",{type:"password",placeholder:"Password",value:u,onChange:e=>h(e.target.value),required:!0,className:"w-full bg-slate-950 border border-slate-800 rounded-2xl px-12 py-4 text-sm text-white outline-none focus:border-indigo-500 transition-all"}),d.jsx("div",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-slate-600 group-focus-within:text-indigo-500 transition-colors",children:d.jsx(Nt,{className:"w-5 h-5"})})]}),f&&d.jsx("div",{className:"border rounded-xl p-3 text-sm text-center "+(f.includes("successful")||f.includes("check your email")?"bg-green-500/10 border-green-500/20 text-green-400":"bg-red-500/10 border-red-500/20 text-red-400"),children:f}),d.jsx("button",{type:"submit",disabled:i,className:"w-full bg-indigo-600 hover:bg-indigo-700 py-4 rounded-2xl font-black text-xs uppercase tracking-[0.2em] text-white shadow-xl shadow-indigo-600/20 active:scale-95 transition-all flex items-center justify-center gap-2",children:i?d.jsx(Et,{className:"w-4 h-4 animate-spin"}):d.jsxs(d.Fragment,{children:[d.jsx(ot,{className:"w-4 h-4"})," ","login"===a?"Sign In":"Join Nexus"]})})]}),d.jsxs("div",{className:"relative",children:[d.jsx("div",{className:"absolute inset-0 flex items-center",children:d.jsx("div",{className:"w-full border-t border-slate-800"})}),d.jsx("div",{className:"relative flex justify-center text-[10px] uppercase font-black tracking-widest",children:d.jsx("span",{className:"bg-slate-900 px-4 text-slate-600",children:"Or continue with"})})]}),d.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[d.jsxs("button",{className:"flex items-center justify-center gap-2 py-3.5 bg-slate-950 border border-slate-800 rounded-2xl hover:bg-slate-800 transition-all text-sm font-bold text-white",children:[d.jsx(mt,{className:"w-4 h-4"})," Google"]}),d.jsxs("button",{className:"flex items-center justify-center gap-2 py-3.5 bg-slate-950 border border-slate-800 rounded-2xl hover:bg-slate-800 transition-all text-sm font-bold text-white",children:[d.jsx(bt,{className:"w-4 h-4"})," Facebook"]})]}),d.jsxs("p",{className:"text-center text-xs font-medium text-slate-500",children:["login"===a?"Don't have an account?":"Already a member?"," ",d.jsx("button",{onClick:()=>n("login"===a?"register":"login"),className:"text-indigo-400 hover:underline font-bold",children:"login"===a?"Sign Up":"Log In"})]})]})]})]})},el=s.lazy(()=>n(()=>import("./HomeMap-CxkRF1JG.js"),__vite__mapDeps([0,1,2,3,4]))),tl=s.lazy(()=>n(()=>import("./EventCreationFlow-BxUEt-Yh.js"),__vite__mapDeps([5,4,1,2,6,7,8,9,10,3,11]))),rl=s.lazy(()=>n(()=>import("./Dashboard-kVqm3yur.js").then(e=>e.D),__vite__mapDeps([12,4,1,6,13,14,9,15,16,17,18,19,20,21,22,23,24,25,26,27]))),sl=s.lazy(()=>n(()=>import("./UserProfile-Dmf8mOcy.js"),__vite__mapDeps([28,4,1,29,13,17,10,9,15,16,30,31,24,14,32,25,23,33,8,20]))),al=s.lazy(()=>n(()=>import("./EventDetail-B-KoHTrQ.js"),__vite__mapDeps([34,4,1,35,9,10,36,37,23,38]))),nl=s.lazy(()=>n(()=>import("./EventEditPage-Bze1LBQ4.js"),__vite__mapDeps([39,1,32,40,41,4]))),il=s.lazy(()=>n(()=>import("./TicketScanner-Be5R7jeQ.js"),__vite__mapDeps([42,1,4,29,13,14,43,16,31,44]))),ol=s.lazy(()=>n(()=>import("./TicketViewPage-BUBoWDXL.js"),__vite__mapDeps([45,1,29,13,33,40,10,15,22,23,9,16,4]))),ll=s.lazy(()=>n(()=>import("./PricingPage-B9kxJnGG.js"),__vite__mapDeps([46,1,35,4]))),cl=s.lazy(()=>n(()=>import("./AgencyProfile-DkXKp4FX.js"),__vite__mapDeps([47,1,48,38,27,10,43,4]))),ul=s.lazy(()=>n(()=>import("./AdminCommandCenter-C2oEtua0.js"),__vite__mapDeps([49,4,1,6,50,3,51,9,31,7,19,22,33,16,15,14,52,48,24,53,23,44,30,32,25,41,21]))),dl=s.lazy(()=>n(()=>import("./SimplifiedSocialMediaManager-CNnq1CE-.js"),__vite__mapDeps([30,1,31,24,14,4])).then(e=>({default:e.SimplifiedSocialMediaManager}))),hl=s.lazy(()=>n(()=>import("./HelpCenter-Cz_jTg9Q.js"),__vite__mapDeps([54,1,6,53,17,18,3,33,4]))),pl=s.lazy(()=>n(()=>import("./TermsOfService-CAjcJMjK.js"),__vite__mapDeps([55,56,1,4]))),ml=s.lazy(()=>n(()=>import("./PrivacyPolicy-CFRDE4MF.js"),__vite__mapDeps([57,56,1,4]))),fl=s.lazy(()=>n(()=>import("./CookieSettings-BcNyY7o-.js"),__vite__mapDeps([58,1,44,4]))),gl=s.lazy(()=>n(()=>import("./GDPRCompliance-DosqNCpS.js"),__vite__mapDeps([59,1,51,36,22,4]))),yl=s.lazy(()=>n(()=>import("./NotificationSettings-Dmr9agu7.js"),__vite__mapDeps([60,1,26,10,44,4]))),wl=s.lazy(()=>n(()=>import("./BetaInvitation-CYhFrswv.js"),__vite__mapDeps([61,1,37,16,14,32,4]))),vl=s.lazy(()=>n(()=>import("./OnboardingTutorial-rKfYipU2.js"),__vite__mapDeps([62,1,10,21,4]))),bl=s.lazy(()=>n(()=>import("./AdminCreditManager-D9WjW-L4.js"),__vite__mapDeps([63,1,31,16,14,50,22,3,15,4]))),xl=s.lazy(()=>n(()=>import("./CodeRedemption-DvR6HO_C.js"),__vite__mapDeps([64,1,32,16,14,9,4]))),_l="G-JD7P5ZKF4L",kl=()=>{const e=he();return s.useEffect(()=>{const t=window.location.hash;if(t.startsWith("#/")){const r=t.substring(1);e(r,{replace:!0})}},[e]),null},jl=()=>{const e=ce();return s.useEffect(()=>{const t=window.gtag,r=window.fbq,s=`${e.pathname}${e.search}${e.hash}`,a=window.location.href;t&&(t("config","G-JD7P5ZKF4L",{page_path:s,page_location:a}),t("event","page_view",{page_path:s,page_location:a})),"function"==typeof r?r("track","PageView"):(window.fbq=function(){window.fbq.callMethod?window.fbq.callMethod.apply(window.fbq,arguments):(window.fbq.queue=window.fbq.queue||[]).push(arguments)},window.fbq("track","PageView"))},[e]),null},Sl=()=>{const[e,t]=s.useState(!1),[r,a]=s.useState(()=>{try{const e=localStorage.getItem("eventnexus-user-cache");if(e){const t=JSON.parse(e);if(t.user&&!("agency_slug"in t.user)&&!("agencySlug"in t.user))return localStorage.removeItem("eventnexus-user-cache"),null;if(t.timestamp&&Date.now()-t.timestamp<36e5)return t.user}}catch(Al){}return null}),[i,o]=s.useState(()=>{try{const e=sessionStorage.getItem("eventnexus-notifications-cache");if(e)return JSON.parse(e)}catch(Al){}return[]}),[l,c]=s.useState(new Set),[u,h]=s.useState(!1),[p,m]=s.useState(()=>{try{const e=sessionStorage.getItem("eventnexus-events-cache");if(e){const t=JSON.parse(e);if(t.timestamp&&Date.now()-t.timestamp<12e4)return t.events}}catch(Al){}return[]}),[f,g]=s.useState(!0),[y,w]=s.useState(!1),[v,b]=s.useState(null);s.useEffect(()=>{if("undefined"==typeof window)return;if(window.gtag)return;if(!document.querySelector(`script[src="https://www.googletagmanager.com/gtag/js?id=${_l}"]`)){const e=document.createElement("script");e.async=!0,e.src=`https://www.googletagmanager.com/gtag/js?id=${_l}`,document.head.appendChild(e)}window.dataLayer=window.dataLayer||[],window.gtag=function(){window.dataLayer.push(arguments)},window.gtag("js",new Date),window.gtag("config",_l,{page_path:window.location.pathname+window.location.search+window.location.hash})},[]);const x=e=>{try{e?localStorage.setItem("eventnexus-user-cache",JSON.stringify({user:e,timestamp:Date.now()})):localStorage.removeItem("eventnexus-user-cache")}catch(Al){}},_=e=>{try{sessionStorage.setItem("eventnexus-notifications-cache",JSON.stringify(e))}catch(Al){}},k=(e,t="success")=>{b({message:e,variant:t}),setTimeout(()=>b(null),3e3)},j=e=>{try{sessionStorage.setItem("eventnexus-events-cache",JSON.stringify({events:e,timestamp:Date.now()}))}catch(Al){}},[S,E]=s.useState(()=>{try{const e=localStorage.getItem("eventnexus-user-cache");if(e){const t=JSON.parse(e);if(t.timestamp&&Date.now()-t.timestamp<3e5)return!0}}catch(Al){}return!1}),N=s.useRef(!1);s.useEffect(()=>{let e=!0;return(async()=>{if("success"===new URLSearchParams(window.location.hash.split("?")[1]).get("checkout")&&r)try{await new Promise(e=>setTimeout(e,2e3));const t=await hi(r.id);t&&e&&(a(t),x(t))}catch(t){}})(),()=>{e=!1}},[null==r?void 0:r.id]),s.useEffect(()=>{let e=!0;(async()=>{var t;if(!N.current){N.current=!0;try{const{data:{session:s}}=await Gn.auth.getSession(),{initializeTracking:i}=await n(async()=>{const{initializeTracking:e}=await import("./campaignTrackingService-D4JXwC6N.js");return{initializeTracking:e}},__vite__mapDeps([65,1,4]));if(await i(null==(t=null==s?void 0:s.user)?void 0:t.id),(null==s?void 0:s.user)&&e)try{const t=await hi(s.user.id);if(t&&e){a(t),x(t),E(!0);const r=await xi(t.id);e&&(o(r),_(r))}else await Gn.auth.signOut(),N.current=!1}catch(r){await Gn.auth.signOut(),N.current=!1}else E(!0);if(0===p.length||!sessionStorage.getItem("eventnexus-events-cache")){const t=await ti();e&&(m(t),j(t))}}catch(s){}finally{e&&g(!1)}}})();const{data:t}=Gn.auth.onAuthStateChange(async(t,s)=>{if("INITIAL_SESSION"!==t)if("SIGNED_IN"===t&&(null==s?void 0:s.user)&&e&&!r)try{const t=await hi(s.user.id);if(t&&e){a(t),x(t);const r=await xi(t.id);e&&(o(r),_(r))}else g(!1)}catch(n){g(!1)}else if("TOKEN_REFRESHED"===t&&(null==s?void 0:s.user)&&e);else if("SIGNED_OUT"===t&&e)a(null),o([]),x(null),sessionStorage.removeItem("eventnexus-notifications-cache"),E(!1),N.current=!1;else if("USER_UPDATED"===t&&(null==s?void 0:s.user)&&e){const t=await hi(s.user.id);t&&e&&(a(t),x(t))}});return()=>{e=!1,null==t||t.subscription.unsubscribe()}},[]),s.useEffect(()=>{if(r&&!localStorage.getItem("onboarding_completed")){const e=setTimeout(()=>{w(!0)},2e3);return()=>clearTimeout(e)}},[r]),s.useEffect(()=>{var e;if(!r||!(null==(e=r.notification_prefs)?void 0:e.proximityAlerts)||!("geolocation"in navigator))return;const t=navigator.geolocation.watchPosition(e=>{const{latitude:t,longitude:s}=e.coords;p.forEach(e=>{var a;if(l.has(e.id))return;if(!r.notification_prefs||!Array.isArray(r.notification_prefs.interestedCategories)||!r.notification_prefs.interestedCategories.includes(e.category))return;const n=((e,t,r,s)=>{const a=(r-e)*Math.PI/180,n=(s-t)*Math.PI/180,i=Math.sin(a/2)*Math.sin(a/2)+Math.cos(e*Math.PI/180)*Math.cos(r*Math.PI/180)*Math.sin(n/2)*Math.sin(n/2);return 2*Math.atan2(Math.sqrt(i),Math.sqrt(1-i))*6371})(t,s,e.location.lat,e.location.lng);if(n<=((null==(a=r.notification_prefs)?void 0:a.alertRadius)||10)){const t={id:"radar-"+e.id,title:"Nexus Radar: Event nearby!",message:`"${e.name}" is only ${n.toFixed(1)}km away! It matches your interests. Check it out now!`,type:"proximity_radar",eventId:e.id,senderName:"Nexus AI Radar",timestamp:(new Date).toISOString(),isRead:!1};o(e=>[t,...e]),c(t=>new Set(t).add(e.id))}})},e=>{},{enableHighAccuracy:!0});return()=>navigator.geolocation.clearWatch(t)},[r,l,p]);const T=async()=>{await Ni(),a(null),o([]),c(new Set)},R=async e=>{if(!r)return;const t=await wi(r.id,e);t&&a(t)},O=async()=>{if(r)try{const e=await hi(r.id);e&&(a(e),x(e))}catch(e){}},C=async()=>{try{const e=await ti();m(e),j(e)}catch(e){}};s.useEffect(()=>{if(!r)return;const e=Gn.channel(`realtime:notifications:${r.id}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"notifications",filter:`user_id=eq.${r.id}`},async e=>{var t,s;try{const a=await xi(r.id);o(a),_(a);const n=null==(t=null==e?void 0:e.new)?void 0:t.sender_name,i=null==(s=null==e?void 0:e.new)?void 0:s.title;"EventNexus Admin"===n&&i&&k(`New message from Admin: ${i}`,"success")}catch(a){}});return e.subscribe(),()=>{e.unsubscribe()}},[null==r?void 0:r.id]);const A=e=>{r?a(t=>{if(!t)return null;const r=Array.isArray(t.followedOrganizers)?t.followedOrganizers:[],s=r.includes(e);return{...t,followedOrganizers:s?r.filter(t=>t!==e):[...r,e]}}):h(!0)};return d.jsxs(Ye,{children:[d.jsx(kl,{}),d.jsx(jl,{}),d.jsxs("div",{className:"min-h-screen bg-slate-950 text-slate-50 flex flex-col",children:[f&&d.jsx("div",{className:"fixed inset-0 z-[9999] bg-slate-950 flex items-center justify-center",children:d.jsxs("div",{className:"text-center space-y-4",children:[d.jsx("div",{className:"w-16 h-16 mx-auto border-4 border-indigo-500 border-t-transparent rounded-full animate-spin"}),d.jsx("p",{className:"text-slate-400 text-sm animate-pulse",children:"Loading EventNexus..."})]})}),d.jsx(Nl,{toggleSidebar:()=>t(!0),user:r,notifications:i,onMarkRead:async e=>{await ki(e)&&o(t=>t.map(t=>t.id===e?{...t,isRead:!0}:t))},onDelete:async e=>{await ji(e)&&o(t=>t.filter(t=>t.id!==e))},onLogout:T,onOpenAuth:()=>h(!0)}),d.jsx(Rl,{isOpen:e,closeSidebar:()=>t(!1),user:r}),d.jsx("main",{className:"pt-16 flex-grow",children:d.jsx(s.Suspense,{fallback:d.jsx("div",{className:"min-h-screen flex items-center justify-center bg-slate-950",children:d.jsxs("div",{className:"text-center space-y-4",children:[d.jsx("div",{className:"w-12 h-12 mx-auto border-4 border-indigo-500 border-t-transparent rounded-full animate-spin"}),d.jsx("p",{className:"text-slate-400 text-sm animate-pulse",children:"Loading..."})]})}),children:d.jsxs(Te,{children:[d.jsx(Ee,{path:"/",element:d.jsx(Jo,{user:r,onOpenAuth:()=>h(!0)})}),d.jsx(Ee,{path:"/map",element:d.jsx(el,{})}),d.jsx(Ee,{path:"/create",element:r?d.jsx(tl,{user:r,onUpdateUser:R,onEventCreated:C}):d.jsx(Jo,{user:r,onOpenAuth:()=>h(!0)})}),d.jsx(Ee,{path:"/create-event",element:r?d.jsx(tl,{user:r,onUpdateUser:R,onEventCreated:C}):d.jsx(Jo,{user:r,onOpenAuth:()=>h(!0)})}),d.jsx(Ee,{path:"/dashboard",element:r?d.jsx(rl,{user:r,onBroadcast:async e=>{if(!r)return;const t=await _i({user_id:r.id,title:e.title||"Nexus Alert",message:e.message||"",type:e.type||"system",senderName:e.senderName||"Nexus System",timestamp:(new Date).toISOString(),isRead:!1,eventId:e.eventId});t&&(o(e=>[t,...e]),"EventNexus Admin"===t.senderName&&k(`New message from Admin: ${t.title}`,"success"))},onUpdateUser:R}):d.jsx(Jo,{user:r,onOpenAuth:()=>h(!0)})}),d.jsx(Ee,{path:"/profile",element:r?d.jsx(sl,{user:r,onLogout:T,onUpdateUser:R,onRefreshUser:O}):d.jsx(Jo,{user:r,onOpenAuth:()=>h(!0)})}),d.jsx(Ee,{path:"/event/:id",element:d.jsx(al,{user:r,onToggleFollow:A,onOpenAuth:()=>h(!0)})}),d.jsx(Ee,{path:"/events/:id/edit",element:d.jsx(nl,{user:r,onOpenAuth:()=>h(!0)})}),d.jsx(Ee,{path:"/events/:id",element:d.jsx(al,{user:r,onToggleFollow:A,onOpenAuth:()=>h(!0)})}),d.jsx(Ee,{path:"/scanner",element:r?d.jsx(il,{user:r}):d.jsx(Jo,{user:r,onOpenAuth:()=>h(!0)})}),d.jsx(Ee,{path:"/ticket",element:r?d.jsx(ol,{}):d.jsx(Jo,{user:r,onOpenAuth:()=>h(!0)})}),d.jsx(Ee,{path:"/ticket/:id",element:r?d.jsx(ol,{}):d.jsx(Jo,{user:r,onOpenAuth:()=>h(!0)})}),d.jsx(Ee,{path:"/pricing",element:d.jsx(ll,{user:r,onUpgrade:e=>a(t=>t?{...t,subscription_tier:e,subscription:e}:null),onOpenAuth:()=>h(!0)})}),d.jsx(Ee,{path:"/beta",element:d.jsx(wl,{})}),d.jsx(Ee,{path:"/beta-signup",element:d.jsx(wl,{})}),d.jsx(Ee,{path:"/org/:slug",element:d.jsx(cl,{user:r,onToggleFollow:A})}),d.jsx(Ee,{path:"/agency/:slug",element:d.jsx(cl,{user:r,onToggleFollow:A})}),d.jsx(Ee,{path:"/admin",element:"admin"===(null==r?void 0:r.role)?d.jsx(ul,{user:r}):d.jsx(Jo,{user:r,onOpenAuth:()=>h(!0)})}),d.jsx(Ee,{path:"/admin/credits",element:"admin"===(null==r?void 0:r.role)?d.jsx(bl,{user:r}):d.jsx(Jo,{user:r,onOpenAuth:()=>h(!0)})}),d.jsx(Ee,{path:"/redeem",element:r?d.jsx(xl,{user:r,onCreditsUpdated:O}):d.jsx(Jo,{user:r,onOpenAuth:()=>h(!0)})}),d.jsx(Ee,{path:"/social-media",element:"admin"===(null==r?void 0:r.role)?d.jsx(dl,{user:r}):d.jsx(Jo,{user:r,onOpenAuth:()=>h(!0)})}),d.jsx(Ee,{path:"/help",element:d.jsx(hl,{user:r||void 0,onOpenAuth:()=>h(!0)})}),d.jsx(Ee,{path:"/terms",element:d.jsx(pl,{})}),d.jsx(Ee,{path:"/privacy",element:d.jsx(ml,{})}),d.jsx(Ee,{path:"/cookies",element:d.jsx(fl,{})}),d.jsx(Ee,{path:"/gdpr",element:d.jsx(gl,{})}),d.jsx(Ee,{path:"/notifications",element:r?d.jsx(yl,{user:r,onUpdatePrefs:e=>{r&&a(t=>t?{...t,notification_prefs:e}:null)}}):d.jsx(Jo,{user:r,onOpenAuth:()=>h(!0)})})]})})}),d.jsx(El,{}),d.jsx(Xo,{isOpen:u,onClose:()=>h(!1),onLogin:async e=>{a(e);const t=await xi(e.id);o(t)}}),v&&d.jsx("div",{className:"fixed bottom-6 left-1/2 -translate-x-1/2 z-[1200]",children:d.jsx("div",{className:"px-4 py-3 rounded-xl shadow-2xl border text-sm font-bold animate-in fade-in zoom-in-95 "+("success"===v.variant?"bg-emerald-600 text-white border-emerald-500/40":"error"===v.variant?"bg-red-600 text-white border-red-500/40":"bg-slate-800 text-white border-slate-700"),children:v.message})}),y&&r&&d.jsx(vl,{user:r,onComplete:()=>{localStorage.setItem("onboarding_completed","true"),w(!1)},onSkip:()=>w(!1)})]})]})},El=()=>{const e=ce();return e.pathname.startsWith("/org/")||e.pathname.startsWith("/agency/")?null:d.jsx(Zo,{})},Nl=({toggleSidebar:e,user:t,notifications:r,onMarkRead:a,onDelete:n,onLogout:i,onOpenAuth:o})=>{const[l,c]=s.useState(!1),[u,h]=s.useState(!1),p=r.filter(e=>!e.isRead).length,m=he();return d.jsx("nav",{className:"fixed top-0 left-0 right-0 z-[1000] h-16 border-b bg-slate-950/80 border-slate-800 backdrop-blur-md text-white",children:d.jsxs("div",{className:"max-w-7xl mx-auto px-4 h-full flex items-center justify-between",children:[d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("button",{onClick:e,className:"p-2 hover:bg-slate-800/20 rounded-lg",children:d.jsx(Ct,{className:"w-6 h-6"})}),d.jsxs(Ze,{to:"/",className:"flex items-center gap-2 font-bold text-xl tracking-tighter",children:[d.jsx("img",{src:"/logo for eventnexus.png",alt:"EventNexus Logo",className:"h-10 w-auto object-contain"}),d.jsx("span",{className:"hidden sm:inline",children:"EventNexus"})]})]}),d.jsx("div",{className:"flex items-center gap-2 sm:gap-4",children:t?d.jsxs(d.Fragment,{children:[d.jsxs("div",{className:"relative",children:[d.jsxs("button",{onClick:()=>c(!l),className:"p-2.5 bg-slate-800/50 border border-slate-700/50 rounded-xl hover:bg-slate-800 transition-all relative text-white",children:[d.jsx(ct,{className:"w-5 h-5"}),p>0&&d.jsx("span",{className:"absolute -top-1 -right-1 w-5 h-5 bg-indigo-500 rounded-full text-[10px] font-black flex items-center justify-center border-2 border-slate-950",children:p})]}),l&&d.jsxs("div",{className:"absolute top-full mt-4 right-0 w-80 sm:w-96 bg-slate-900 border border-slate-800 rounded-[32px] shadow-2xl overflow-hidden animate-in fade-in zoom-in-95 duration-200",children:[d.jsxs("div",{className:"p-5 border-b border-slate-800 flex justify-between items-center bg-slate-950/50",children:[d.jsx("h4",{className:"font-black text-xs uppercase tracking-[0.2em] text-indigo-400",children:"Notification Center"}),d.jsx("button",{onClick:()=>c(!1),children:d.jsx(Jt,{className:"w-4 h-4 text-slate-500"})})]}),d.jsx("div",{className:"max-h-[400px] overflow-y-auto divide-y divide-slate-800 scrollbar-hide",children:0===r.length?d.jsx("div",{className:"p-10 text-center text-slate-600 italic text-sm",children:"No notifications yet."}):r.map(e=>{var t;return d.jsxs("div",{className:"block p-5 space-y-3 transition-colors "+(e.isRead?"opacity-60":"bg-indigo-600/5"),onClick:()=>{a(e.id)},children:[d.jsxs("div",{className:"flex justify-between items-start gap-3",children:[d.jsxs(Ze,{to:e.eventId?`/event/${e.eventId}`:"#",className:"space-y-1",onClick:()=>c(!1),children:[d.jsxs("div",{className:"flex items-center gap-2",children:["proximity_radar"===e.type&&d.jsx(Ut,{className:"w-3 h-3 text-indigo-400"}),"contact_inquiry"===e.type&&d.jsx(Rt,{className:"w-3 h-3 text-purple-400"}),d.jsx("h5",{className:"font-black text-sm text-white",children:e.title})]}),d.jsx("p",{className:"text-[10px] text-indigo-400 font-bold uppercase tracking-widest",children:e.senderName})]}),d.jsx("button",{onClick:t=>{t.preventDefault(),t.stopPropagation(),n(e.id)},className:"p-2 text-slate-500 hover:text-red-500 hover:bg-red-500/10 rounded-lg transition-all",children:d.jsx(Wt,{className:"w-4 h-4"})})]}),d.jsx("p",{className:"text-xs text-slate-400 leading-relaxed font-medium",children:e.message}),"proximity_radar"===e.type&&d.jsx(Ze,{to:e.eventId?`/event/${e.eventId}`:"#",onClick:()=>c(!1),className:"block bg-indigo-600 py-2 rounded-xl text-center text-[10px] font-black uppercase tracking-widest text-white mt-2",children:"Buy ticket now"}),"contact_inquiry"===e.type&&(null==(t=e.metadata)?void 0:t.fromEmail)&&d.jsx("a",{href:`mailto:${e.metadata.fromEmail}`,onClick:e=>e.stopPropagation(),className:"block bg-purple-600 hover:bg-purple-700 py-2 rounded-xl text-center text-[10px] font-black uppercase tracking-widest text-white mt-2 transition-colors",children:"Reply via Email"})]},e.id)})})]})]}),d.jsxs("div",{className:"relative",children:[d.jsxs("button",{onClick:()=>h(!u),className:"flex items-center gap-2 bg-slate-800/50 p-1 pr-3 rounded-full hover:bg-slate-800 transition-all border border-slate-700 group",children:[d.jsx("img",{src:t.avatar,className:"w-8 h-8 rounded-full border border-indigo-500",alt:"avatar"}),d.jsx(ht,{className:"w-4 h-4 text-slate-500 transition-transform "+(u?"rotate-180":"")})]}),u&&d.jsxs("div",{className:"absolute top-full mt-4 right-0 w-64 bg-slate-900 border border-slate-800 rounded-[32px] shadow-2xl overflow-hidden animate-in fade-in zoom-in-95 duration-200",children:[d.jsxs("div",{className:"p-6 border-b border-slate-800 bg-slate-950/50",children:[d.jsxs("p",{className:"text-xs font-black text-indigo-400 uppercase tracking-widest mb-1",children:[t.subscription_tier," plan"]}),d.jsx("h4",{className:"font-black text-white truncate",children:t.name})]}),d.jsxs("div",{className:"p-2",children:[d.jsx(Tl,{icon:d.jsx(Kt,{}),label:"My Profile",onClick:()=>{h(!1),m("/profile")}}),d.jsx(Tl,{icon:d.jsx(Lt,{}),label:"Settings",onClick:()=>{h(!1),m("/notifications")}}),d.jsx("div",{className:"h-px bg-slate-800 my-2 mx-4"}),d.jsx(Tl,{icon:d.jsx(Tt,{}),label:"Log Out",variant:"danger",onClick:()=>{h(!1),i(),m("/")}})]})]})]})]}):d.jsx("button",{onClick:o,className:"bg-indigo-600 hover:bg-indigo-700 px-6 py-2.5 rounded-2xl font-black text-xs uppercase tracking-widest text-white transition-all shadow-xl active:scale-95",children:"Sign In"})})]})})},Tl=({icon:e,label:t,onClick:r,variant:s})=>d.jsxs("button",{onClick:r,className:"w-full flex items-center gap-3 px-4 py-3 rounded-2xl transition-all text-sm font-bold "+("danger"===s?"text-red-400 hover:bg-red-400/10":"text-slate-300 hover:bg-slate-800 hover:text-white"),children:[d.jsx("span",{className:"shrink-0",children:a.cloneElement(e,{size:18})}),t]}),Rl=({isOpen:e,closeSidebar:t,user:r})=>d.jsxs(d.Fragment,{children:[e&&d.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-[1050]",onClick:t}),d.jsxs("aside",{className:"fixed inset-y-0 left-0 z-[1100] w-72 bg-slate-900 transform transition-transform duration-300 ease-in-out border-r border-slate-800 "+(e?"translate-x-0":"-translate-x-full"),children:[d.jsxs("div",{className:"p-6 flex items-center justify-between border-b border-slate-800",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx(yt,{className:"w-6 h-6 text-indigo-500"}),d.jsx("span",{className:"font-black text-xl tracking-tighter text-white",children:"EventNexus"})]}),d.jsx("button",{onClick:t,className:"p-2 hover:bg-slate-800 rounded-xl text-slate-400",children:d.jsx(Jt,{className:"w-6 h-6"})})]}),d.jsxs("div",{className:"p-4 space-y-1",children:[d.jsx(Ol,{icon:d.jsx(Ot,{}),label:"Explore Map",to:"/map",onClick:t}),d.jsx(Ol,{icon:d.jsx(ft,{}),label:"Create Event",to:"/create",onClick:t}),d.jsx(Ol,{icon:d.jsx(Ft,{}),label:"My Tickets",to:"/profile",onClick:t}),d.jsx(Ol,{icon:d.jsx(Ut,{}),label:"Nexus Radar",to:"/notifications",onClick:t}),d.jsx(Ol,{icon:d.jsx(xt,{}),label:"Redeem Code",to:"/redeem",onClick:t}),d.jsx(Ol,{icon:d.jsx(Gt,{}),label:"Pricing",to:"/pricing",onClick:t}),d.jsx("div",{className:"pt-6 pb-2 px-3 text-[10px] font-black text-slate-500 uppercase tracking-widest",children:"User"}),d.jsx(Ol,{icon:d.jsx(Lt,{}),label:"Settings",to:"/notifications",onClick:t}),d.jsx(Ol,{icon:d.jsx(jt,{}),label:"Organizer Hub",to:"/dashboard",onClick:t}),"admin"===(null==r?void 0:r.role)&&d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"pt-6 pb-2 px-3 text-[10px] font-black text-orange-500 uppercase tracking-widest",children:"Admin"}),d.jsx(Ol,{icon:d.jsx(qt,{}),label:"Command Center",to:"/admin",onClick:t}),d.jsx(Ol,{icon:d.jsx(gt,{}),label:"Credit Manager",to:"/admin/credits",onClick:t}),d.jsx(Ol,{icon:d.jsx(_t,{}),label:"Social Media",to:"/social-media",onClick:t})]})]})]})]}),Ol=({icon:e,label:t,to:r,onClick:s})=>d.jsxs(Ze,{to:r,onClick:s,className:"flex items-center gap-4 px-4 py-3 rounded-xl hover:bg-indigo-600/10 text-slate-300 hover:text-indigo-400 transition-all group",children:[d.jsx("span",{className:"w-5 h-5 text-slate-500 group-hover:text-indigo-400 transition-colors",children:e}),d.jsx("span",{className:"text-sm font-bold tracking-tight",children:t})]}),Cl=document.getElementById("root");if(!Cl)throw new Error("Could not find root element to mount to");p.createRoot(Cl).render(d.jsx(a.StrictMode,{children:d.jsx(Sl,{})}));export{pe as $,mt as A,so as B,Ko as C,wt as D,vt as E,bt as F,_t as G,ao as H,St as I,kt as J,mo as K,Ze as L,xt as M,dt as N,Rt as O,Mt as P,ot as Q,Ut as R,Ho as S,Ft as T,Kt as U,Ti as V,ii as W,Jt as X,fi as Y,Gt as Z,gi as _,pt as a,lo as a$,Io as a0,di as a1,zt as a2,qt as a3,ui as a4,ci as a5,ni as a6,Oi as a7,Ri as a8,vo as a9,jo as aA,To as aB,Oo as aC,Co as aD,Ao as aE,Po as aF,Ai as aG,Ct as aH,si as aI,Ci as aJ,Bi as aK,Hi as aL,Ji as aM,Pi as aN,Ii as aO,Li as aP,Wi as aQ,Ki as aR,_i as aS,Fi as aT,zi as aU,fo as aV,go as aW,yo as aX,Di as aY,Si as aZ,mi as a_,ce as aa,Pt as ab,$t as ac,Zo as ad,vi as ae,bo as af,Gi as ag,Yi as ah,Qi as ai,Xi as aj,Zi as ak,lt as al,Lt as am,co as an,uo as ao,oo as ap,ho as aq,ht as ar,xo as as,So as at,It as au,At as av,_o as aw,ko as ax,Eo as ay,No as az,hi as b,ct as b0,Uo as b1,Do as b2,Fo as b3,pi as b4,gt as b5,Bo as b6,$o as b7,Lo as b8,qo as b9,zo as ba,Wo as bb,Mo as bc,Xn as bd,Vo as be,it as c,Ui as d,Bt as e,Nt as f,ti as g,ut as h,yi as i,d as j,ai as k,no as l,Vt as m,eo as n,to as o,Et as p,Dt as q,ri as r,Gn as s,jt as t,he as u,io as v,Ht as w,Wt as x,li as y,ro as z};
