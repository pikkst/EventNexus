import{c as e,ba as s,bb as t,j as r,M as a,b5 as l,bc as c,m as d}from"./index-b309e1nc.js";import{b as n}from"./charts-0jYrCXCa.js";import{L as i}from"./loader-GWe7--jB.js";import{C as o}from"./circle-check-big-BVKQvehI.js";import{C as x}from"./circle-alert-_cpfBv0g.js";import{C as m}from"./clock-Cnt1qgag.js";import"./qr-BITZ6EfA.js";
/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h=e("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]),g=e("Tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]),p=({user:e,onCreditsUpdated:p})=>{const[j,u]=n.useState(""),[b,y]=n.useState(!1),[N,f]=n.useState(null),[w,v]=n.useState([]),[k,C]=n.useState([]),[X,S]=n.useState(!1);n.useEffect(()=>{_()},[e.id]);const _=async()=>{try{const[r,a]=await Promise.all([s(e.id),t(e.id)]);v(r),C(a)}catch(r){}},R=async()=>{if(j.trim()){y(!0),f(null);try{const s=await c(e.id,j.trim().toUpperCase());s.success?(f({type:"success",text:`Success! ${s.credits_granted} credits added. New balance: ${s.new_balance} credits`}),u(""),_(),p&&p()):f({type:"error",text:s.error||"Failed to redeem code"})}catch(s){f({type:"error",text:"An error occurred while redeeming the code"})}finally{y(!1)}}else f({type:"error",text:"Please enter a code"})},H=e=>{switch(e){case"admin_grant":return r.jsx(a,{className:"w-5 h-5 text-green-600"});case"code_redemption":return r.jsx(g,{className:"w-5 h-5 text-blue-600"});case"purchase":return r.jsx(l,{className:"w-5 h-5 text-purple-600"});case"refund":return r.jsx(d,{className:"w-5 h-5 text-red-600"});default:return r.jsx(l,{className:"w-5 h-5 text-gray-600"})}};return r.jsx("div",{className:"max-w-4xl mx-auto p-6",children:r.jsxs("div",{className:"bg-white rounded-lg shadow-lg overflow-hidden",children:[r.jsxs("div",{className:"bg-gradient-to-r from-orange-500 to-pink-500 p-6 text-white",children:[r.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[r.jsx("div",{className:"p-3 bg-white/20 rounded-lg backdrop-blur-sm",children:r.jsx(a,{className:"w-6 h-6"})}),r.jsxs("div",{children:[r.jsx("h1",{className:"text-2xl font-bold",children:"Redeem Code"}),r.jsx("p",{className:"text-white/90 text-sm",children:"Enter your promo or reward code"})]})]}),r.jsx("div",{className:"bg-white/10 backdrop-blur-sm rounded-lg p-4",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"text-white/90",children:"Current Balance"}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(l,{className:"w-5 h-5"}),r.jsx("span",{className:"text-2xl font-bold",children:e.credits||0}),r.jsx("span",{className:"text-white/90",children:"credits"})]})]})})]}),r.jsxs("div",{className:"p-6",children:[r.jsxs("div",{className:"mb-6",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Enter Code"}),r.jsxs("div",{className:"flex gap-3",children:[r.jsx("input",{type:"text",value:j,onChange:e=>u(e.target.value.toUpperCase()),onKeyPress:e=>{"Enter"===e.key&&R()},placeholder:"PROMO-XXX-XXXXXXXXXX",className:"flex-1 px-4 py-3 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent font-mono text-lg uppercase",disabled:b}),r.jsx("button",{onClick:R,disabled:b||!j.trim(),className:"px-8 py-3 bg-gradient-to-r from-orange-500 to-pink-500 text-white rounded-lg hover:from-orange-600 hover:to-pink-600 transition-all disabled:opacity-50 disabled:cursor-not-allowed font-medium flex items-center gap-2",children:b?r.jsxs(r.Fragment,{children:[r.jsx(i,{className:"w-5 h-5 animate-spin"}),"Redeeming..."]}):r.jsxs(r.Fragment,{children:[r.jsx(o,{className:"w-5 h-5"}),"Redeem"]})})]})]}),N&&r.jsx("div",{className:"p-4 rounded-lg mb-6 "+("success"===N.type?"bg-green-50 border border-green-200":"error"===N.type?"bg-red-50 border border-red-200":"bg-blue-50 border border-blue-200"),children:r.jsxs("div",{className:"flex items-start gap-3",children:["success"===N.type?r.jsx(o,{className:"w-5 h-5 text-green-600 mt-0.5 flex-shrink-0"}):"error"===N.type?r.jsx(x,{className:"w-5 h-5 text-red-600 mt-0.5 flex-shrink-0"}):r.jsx(x,{className:"w-5 h-5 text-blue-600 mt-0.5 flex-shrink-0"}),r.jsx("p",{className:"text-sm font-medium "+("success"===N.type?"text-green-800":"error"===N.type?"text-red-800":"text-blue-800"),children:N.text})]})}),r.jsx("div",{className:"bg-gradient-to-br from-blue-50 to-purple-50 border border-blue-200 rounded-lg p-4 mb-6",children:r.jsxs("div",{className:"flex gap-3",children:[r.jsx(x,{className:"w-5 h-5 text-blue-600 mt-0.5 flex-shrink-0"}),r.jsxs("div",{className:"text-sm text-gray-700",children:[r.jsx("p",{className:"font-medium text-gray-900 mb-1",children:"About Codes"}),r.jsxs("ul",{className:"space-y-1 text-gray-600",children:[r.jsxs("li",{children:["• ",r.jsx("strong",{children:"Promo codes"})," are for new registrations or special offers"]}),r.jsxs("li",{children:["• ",r.jsx("strong",{children:"Reward codes"})," are for existing users as recognition"]}),r.jsx("li",{children:"• Each code can only be used once per user"}),r.jsx("li",{children:"• Some codes may have expiration dates or usage limits"})]})]})]})}),r.jsxs("button",{onClick:()=>S(!X),className:"w-full flex items-center justify-center gap-2 px-4 py-3 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors text-gray-700 font-medium",children:[r.jsx(h,{className:"w-5 h-5"}),X?"Hide History":"Show History"]}),X&&r.jsxs("div",{className:"mt-6 border-t pt-6",children:[r.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[r.jsx(m,{className:"w-5 h-5 text-gray-600"}),"Transaction History"]}),w.length>0?r.jsx("div",{className:"space-y-3",children:w.map(e=>{return r.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[H(e.transaction_type),r.jsxs("div",{children:[r.jsx("p",{className:"font-medium text-gray-900",children:e.transaction_type.replace("_"," ").replace(/\b\w/g,e=>e.toUpperCase())}),e.reason&&r.jsx("p",{className:"text-sm text-gray-600",children:e.reason}),r.jsx("p",{className:"text-xs text-gray-500",children:new Date(e.created_at).toLocaleString()})]})]}),r.jsxs("div",{className:"text-right",children:[r.jsxs("p",{className:"text-lg font-bold "+(s=e.amount,s>=0?"text-green-600":"text-red-600"),children:[e.amount>=0?"+":"",e.amount]}),r.jsxs("p",{className:"text-sm text-gray-600",children:["Balance: ",e.balance_after]})]})]},e.id);var s})}):r.jsxs("div",{className:"text-center py-8",children:[r.jsx(h,{className:"w-12 h-12 text-gray-400 mx-auto mb-3"}),r.jsx("p",{className:"text-gray-600",children:"No transactions yet"}),r.jsx("p",{className:"text-sm text-gray-500",children:"Redeem your first code to get started!"})]}),k.length>0&&r.jsxs(r.Fragment,{children:[r.jsxs("h3",{className:"text-md font-semibold mt-6 mb-3 text-gray-700",children:["Redeemed Codes (",k.length,")"]}),r.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:k.map(e=>r.jsxs("div",{className:"p-3 bg-gradient-to-br from-green-50 to-blue-50 border border-green-200 rounded-lg",children:[r.jsxs("div",{className:"flex items-center justify-between mb-1",children:[r.jsx("span",{className:"text-xs font-medium text-gray-600",children:"Code Redeemed"}),r.jsx(o,{className:"w-4 h-4 text-green-600"})]}),r.jsx("p",{className:"text-sm text-gray-500",children:new Date(e.redeemed_at).toLocaleDateString()}),r.jsxs("p",{className:"text-lg font-bold text-green-600 mt-1",children:["+",e.credit_granted," credits"]})]},e.id))})]})]})]})]})})};
/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */export{p as default};
