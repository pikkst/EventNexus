import{s as e}from"./index-b309e1nc.js";const t=async()=>{const{data:t}=await e.from("system_config").select("value").eq("key","stripe_public_key").single();return(null==t?void 0:t.value)?(t.value,t.value):""},r=async(r,c,n)=>{try{if(!(await t()))return null;const s={pro:"price_1SgXusJ9WsSrj5gMbJdADsvy",premium:"price_1SgXwZJ9WsSrj5gMehBiDgWp",enterprise:"price_1SgXxRJ9WsSrj5gMLhDEB26O"},i=window.location.origin+window.location.pathname.split("#")[0],{data:a,error:o}=await e.functions.invoke("create-checkout",{body:{userId:r,tier:c,priceId:s[c],customerEmail:n,successUrl:`${i}#/dashboard?checkout=success`,cancelUrl:`${i}#/pricing?checkout=cancelled`}});if(o)throw new Error(o.message||"Failed to create checkout session");if(!(null==a?void 0:a.url))throw new Error((null==a?void 0:a.error)||"No checkout URL received from payment system");return a.url}catch(s){throw s}},c=async(r,c,n,s,i,a,o,l)=>{try{if(!(await t()))return null;const u=window.location.origin+window.location.pathname.split("#")[0],{data:d,error:h}=await e.functions.invoke("create-checkout",{body:{userId:r,eventId:c,ticketCount:n,pricePerTicket:s,eventName:i,ticketTemplateId:a,ticketType:o,ticketName:l,successUrl:`${u}#/events/${c}?purchase=success`,cancelUrl:`${u}#/events/${c}?purchase=cancelled`}});return h?null:(null==d?void 0:d.url)||null}catch(u){return null}},n=()=>{const e=new URLSearchParams(window.location.hash.split("?")[1]);return"success"===e.get("checkout")||"success"===e.get("purchase")},s=async t=>{try{if(!t)return!1;const{data:r,error:c}=await e.functions.invoke("verify-checkout",{body:{sessionId:t}});return!c&&(!0===(null==r?void 0:r.paid)||!0===(null==r?void 0:r.verified))}catch(r){return!1}},i=()=>{const e=window.location.hash.split("?")[0];window.history.replaceState(null,"",e)};export{i as a,c as b,n as c,r as d,s as v};
