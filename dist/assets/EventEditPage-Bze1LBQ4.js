import{$ as e,u as t,j as s,C as a,X as l,g as n,a6 as i}from"./index-b309e1nc.js";import{b as o}from"./charts-0jYrCXCa.js";import{L as r}from"./loader-GWe7--jB.js";import{A as d}from"./arrow-left-XpV3ECAJ.js";import{S as c}from"./save-BMNvfd6I.js";import"./qr-BITZ6EfA.js";const x=({user:x,onOpenAuth:m})=>{const{id:u}=e(),b=t(),[h,p]=o.useState(null),[g,f]=o.useState(!0),[v,j]=o.useState(!1),[y,N]=o.useState({name:"",category:"",description:"",aboutText:""});o.useEffect(()=>{(async()=>{if(u&&x)try{const e=(await n()).find(e=>e.id===u);if(!e)return alert("Event not found"),void b("/");if(e.organizerId!==x.id)return alert("You do not have permission to edit this event"),void b(`/event/${u}`);p(e),N({name:e.name,category:e.category,description:e.description,aboutText:e.aboutText||""})}catch(e){alert("Failed to load event"),b("/")}finally{f(!1)}else b("/")})()},[u,x,b]);const w=async()=>{if(h&&x)if(y.name&&y.category&&y.description){j(!0);try{const e={name:y.name,category:y.category,description:y.description,about_text:y.aboutText||null};if(!(await i(h.id,e)))throw new Error("Update failed");alert("âœ… Event updated successfully!"),b(`/event/${h.id}`)}catch(e){alert("Failed to update event. Please try again.")}finally{j(!1)}}else alert("Please fill in all required fields")};return g?s.jsx("div",{className:"min-h-screen bg-slate-950 text-white flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx(r,{className:"w-8 h-8 animate-spin mx-auto mb-4 text-indigo-500"}),s.jsx("p",{className:"text-slate-400",children:"Loading event..."})]})}):h?s.jsx("div",{className:"min-h-screen bg-slate-950 text-white pb-32",children:s.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-8",children:[s.jsxs("div",{className:"flex items-center justify-between mb-8",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("button",{onClick:()=>b(`/event/${h.id}`),className:"p-2 hover:bg-slate-800 rounded-lg transition-colors",children:s.jsx(d,{className:"w-5 h-5"})}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-black",children:"Edit Event"}),s.jsx("p",{className:"text-slate-400 text-sm",children:"Update your event details"})]})]}),s.jsxs("button",{onClick:w,disabled:v,className:"flex items-center gap-2 px-6 py-3 bg-indigo-600 hover:bg-indigo-700 rounded-xl font-bold transition-all disabled:opacity-50",children:[v?s.jsx(r,{className:"w-5 h-5 animate-spin"}):s.jsx(c,{className:"w-5 h-5"}),v?"Saving...":"Save Changes"]})]}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-bold text-slate-300 mb-2",children:"Event Name *"}),s.jsx("input",{type:"text",value:y.name,onChange:e=>N({...y,name:e.target.value}),className:"w-full bg-slate-900 border border-slate-700 rounded-xl px-4 py-3 focus:border-indigo-500 outline-none",placeholder:"Enter event name"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-bold text-slate-300 mb-2",children:"Category *"}),s.jsxs("select",{value:y.category,onChange:e=>N({...y,category:e.target.value}),className:"w-full bg-slate-900 border border-slate-700 rounded-xl px-4 py-3 focus:border-indigo-500 outline-none",children:[s.jsx("option",{value:"",children:"Select category"}),a.map(e=>s.jsx("option",{value:e,children:e},e))]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-bold text-slate-300 mb-2",children:"Description *"}),s.jsx("textarea",{value:y.description,onChange:e=>N({...y,description:e.target.value}),rows:4,className:"w-full bg-slate-900 border border-slate-700 rounded-xl px-4 py-3 focus:border-indigo-500 outline-none resize-none",placeholder:"Describe your event"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-bold text-slate-300 mb-2",children:"About This Event (Detailed)"}),s.jsx("textarea",{value:y.aboutText,onChange:e=>N({...y,aboutText:e.target.value}),rows:10,className:"w-full bg-slate-900 border border-slate-700 rounded-xl px-4 py-3 focus:border-indigo-500 outline-none resize-none font-mono text-sm",placeholder:"Add detailed information (schedule, lineup, FAQ, etc.)"}),s.jsx("p",{className:"text-xs text-slate-500 mt-2",children:'This will be displayed in the "About this event" section'})]}),s.jsxs("div",{className:"flex gap-4 pt-6",children:[s.jsxs("button",{onClick:w,disabled:v,className:"flex-1 flex items-center justify-center gap-2 px-6 py-4 bg-indigo-600 hover:bg-indigo-700 rounded-xl font-bold transition-all disabled:opacity-50",children:[v?s.jsx(r,{className:"w-5 h-5 animate-spin"}):s.jsx(c,{className:"w-5 h-5"}),v?"Saving Changes...":"Save Changes"]}),s.jsxs("button",{onClick:()=>b(`/event/${h.id}`),className:"px-6 py-4 bg-slate-800 hover:bg-slate-700 rounded-xl font-bold transition-all flex items-center gap-2",children:[s.jsx(l,{className:"w-5 h-5"}),"Cancel"]})]})]})]})}):null};export{x as default};
