# KrediidisÃ¼steem V2 - Kiirjuhend

## ğŸ’¡ PÃµhimÃµte

**Krediidid = VÃµimalus avada premium funktsioone tasuta kasutajatele**

- **1 krediit = 0.50â‚¬ vÃ¤Ã¤rtus**
- Tasuta kasutajad saavad avada premium funktsioone krediitidega
- Tasulistel tasemetel (Pro/Premium/Enterprise) on funktsioonid juba kaasas
- **Admin tÃ¶Ã¶riistad on TASUTA** (platvormi turunduseks)
- Uued kasutajad saavad **100 krediiti tervitusboonusena** (50â‚¬ vÃ¤Ã¤rtus!)

## ğŸ¯ Kuidas TÃ¶Ã¶tab?

### Tasuta Kasutajale:
Sul on **100 tasuta krediiti** (50â‚¬ vÃ¤Ã¤rtus), et avada premium funktsioone, mis tasulisel tellijal on juba kaasas!

### Tasulisele Kasutajale:
Funktsioonid on **tellimuse hinna sees** - krediite pole vaja!

### Adminile:
**KÃµik admin tÃ¶Ã¶riistad on TASUTA** - platvormi turundamisel ei kulu krediite.

---

## ğŸ’° Funktsioonide Avamise Hinnad

### Ãœrituse Haldus (20-60 krediiti)
- **EsiletÃµstetud Ã¼ritus (7 pÃ¤eva)**: 20 krediiti (10â‚¬)
- **EsiletÃµstetud Ã¼ritus (30 pÃ¤eva)**: 60 krediiti (30â‚¬)
- **Kohandatud kujundus**: 30 krediiti (15â‚¬)
- **TÃ¤psem analÃ¼Ã¼tika**: 40 krediiti (20â‚¬)
- **Prioriteetne tugi (30 pÃ¤eva)**: 50 krediiti (25â‚¬)

### Piletihaldus (15-150 krediiti)
- **ğŸ« Piletite Skaneerimine (30 pÃ¤eva)**: **50 krediiti (25â‚¬)** â­
- **ğŸ« Piletite Skaneerimine (1 aasta)**: **150 krediiti (75â‚¬)** â­
- **TÃ¤iustatud piletitÃ¼Ã¼bid**: 25 krediiti (12.50â‚¬)
- **Pileti Ã¼lekandmine**: 15 krediiti (7.50â‚¬)

### AI Funktsioonid (5-30 krediiti kasutuse kohta)
- **AI Ã¼rituse pilt**: 20 krediiti (10â‚¬)
- **AI pealkiri**: 10 krediiti (5â‚¬)
- **AI kirjeldus**: 15 krediiti (7.50â‚¬)
- **TÃµlge (keele kohta)**: 5 krediiti (2.50â‚¬)
- **AI reklaamkampaania**: 30 krediiti (15â‚¬)

### Turundus (25-40 krediiti)
- **E-posti kampaania**: 35 krediiti (17.50â‚¬)
- **Push teated**: 25 krediiti (12.50â‚¬)
- **Sotsiaalmeedia boost**: 40 krediiti (20â‚¬)

### TÃ¤iustatud Funktsioonid (45-100 krediiti)
- **Mitme asukoha tugi**: 45 krediiti (22.50â‚¬)
- **White label**: 100 krediiti (50â‚¬)
- **API ligipÃ¤Ã¤s (30 pÃ¤eva)**: 80 krediiti (40â‚¬)
- **Kohandatud domeen**: 60 krediiti (30â‚¬)

---

## ğŸ« Piletite Skaneerimine (50 krediiti)

### Mis See On?
Kontrolli piletite autentsust QR-koodide abil lÃ¤bi telefoni kaamera.

### VÃµimalused:
- âœ… Skaneerib QR koode piletitel
- âœ… Kinnitab, et pilet on autentne (ostetud sinu EventNexus Ã¼rituse lehelt)
- âœ… Kontrollib, kas pilet on juba kasutatud
- âœ… NÃ¤itab kÃ¼lastaja infot
- âœ… JÃ¤lgib sissepÃ¤Ã¤su statistikat
- âœ… Hoiab Ã¤ra vÃµltspiletid
- âœ… Reaalajas kontroll

### Hind:
- **30 pÃ¤eva juurdepÃ¤Ã¤s**: 50 krediiti (25â‚¬)
- **1 aasta juurdepÃ¤Ã¤s**: 150 krediiti (75â‚¬)

### Kuidas Kasutada:
1. Ava piletite skaneerimise funktsioon (50 krediiti)
2. Mine oma Ã¼rituse dashboardi
3. Vajuta "Skaneeri Pileteid"
4. Suuna kaamera kÃ¼lastaja QR-koodi peale
5. SÃ¼steem kinnitab ja lubab/keeldub sissepÃ¤Ã¤su

### QR-koodi Formaat:
`ENX-{piletiId}-{turvaHash}`

NÃ¤ide: `ENX-abc123-def456789`

### Turvalisus:
- Igal QR-koodil on unikaalne hash
- Hash kinnitab pileti autentsust
- Ei saa dubleerida ega vÃµltsida
- Tuvastab juba kasutatud piletid
- Kinnitab ostu sinu Ã¼rituse kaudu

---

## ğŸ’³ Krediitide Ostmise Paketid

| Pakett | Krediiti | Hind | Krediidi kohta | Allahindlus |
|--------|----------|------|----------------|-------------|
| VÃ¤ike | 100 | 5â‚¬ | 0.05â‚¬ | 0% |
| Keskmine | 500 | 20â‚¬ | 0.04â‚¬ | 20% |
| Suur | 1000 | 35â‚¬ | 0.035â‚¬ | 30% |
| Mega | 5000 | 150â‚¬ | 0.03â‚¬ | 40% |

---

## ğŸ†“ Admin TÃ¶Ã¶riistad (EI MAKSA KREDIITE)

### Tasuta Admininle:
- âœ… Platvormi kasvukampaaniate genereerimine
- âœ… Kampaania piltide genereerimine
- âœ… Sotsiaalmeedia postituste genereerimine
- âœ… Postitamine sotsiaalmeedia platvormidele
- âœ… Kasutajate haldamine
- âœ… Platvormi analÃ¼Ã¼tika
- âœ… SÃ¼steemi seadistused

**Miks?** Need tÃ¶Ã¶riistad turundusvad platvormi ennast, mitte individuaalseid Ã¼ritusi.

---

## ğŸ“± Kasutamise NÃ¤ited

### NÃ¤ide 1: Tasuta Kasutaja Avab Piletite Skaneerimise

**Kasutaja**: "Mul on vaja uksel pileteid kontrollida"

1. Mine oma Ã¼rituse dashboardi
2. Vajuta "Luba Piletite Skaneerimine"
3. SÃ¼steem: "Avamine 30 pÃ¤evaks: 50 krediiti (25â‚¬ vÃ¤Ã¤rtus)"
4. Kinnitad
5. 50 krediiti maha vÃµetud
6. QR-skÃ¤nner avatud 30 pÃ¤evaks
7. Saad nÃ¼Ã¼d uksel pileteid skaneerida

### NÃ¤ide 2: Tasuta Kasutaja Genereerib AI Pildi

**Kasutaja**: "Tahan Ã¼ritusele AI pilt lisada"

1. Vajuta "Genereeri AI Pilt"
2. SÃ¼steem: "Maksab 20 krediiti (10â‚¬ vÃ¤Ã¤rtus). Sul on 100 krediiti."
3. Kinnitad
4. AI genereerib pildi
5. 20 krediiti maha vÃµetud
6. Sul jÃ¤Ã¤b 80 krediiti

### NÃ¤ide 3: Pro Kasutaja Kasutab Funktsioone

**Kasutaja**: "Olen Pro plaaniga, kui palju AI pilt maksab?"

1. Vajutad "Genereeri AI Pilt"
2. SÃ¼steem: "Kaasas sinu Pro plaanis! âœ¨"
3. AI genereerib pildi
4. Ãœhtegi krediiti ei vÃµeta
5. KÃµik Pro funktsioonid on tasuta

### NÃ¤ide 4: Admin Turundab Platvormi

**Admin**: "Tahan luua promotsioonikampaania"

1. Ava AdminCommandCenter
2. Mine Campaign Engine
3. Genereeri kampaania AI-ga
4. Genereeri sotsiaalmeedia postitused
5. Postita kÃµigile platvormidele
6. **Ãœhtegi krediiti ei kulunud** - adminile tasuta!

---

## ğŸ”§ Paigaldamine

### Samm 1: KÃ¤ivita Migratsioonid

```bash
# Supabase SQL Editoris:
# 1. KÃ¤ivita sotsiaalmeedia migratsioon
supabase/migrations/20250120000001_social_media_integration.sql

# 2. KÃ¤ivita funktsioonide avamise migratsioon
supabase/migrations/20250120000002_feature_unlock_system.sql
```

### Samm 2: Seadista Stripe Tooted

```bash
# 100 krediiti - 5â‚¬
stripe products create --name="100 Credits" --description="100 EventNexus Credits (50â‚¬ value)"
stripe prices create --product=prod_xxx --unit-amount=500 --currency=eur

# 500 krediiti - 20â‚¬
stripe products create --name="500 Credits" --description="500 EventNexus Credits (20% discount)"
stripe prices create --product=prod_xxx --unit-amount=2000 --currency=eur
```

### Samm 3: Uuenda Stripe Webhook

```typescript
case 'checkout.session.completed':
  if (session.metadata?.type === 'credits') {
    const userId = session.metadata.userId;
    const credits = parseInt(session.metadata.credits);
    
    // Lisa krediite kasutajale
    await addUserCredits(userId, credits);
  }
  break;
```

---

## ğŸ’» Koodi NÃ¤ited

### Ava Piletite Skaneerimine

```typescript
import { unlockFeature } from '@/services/featureUnlockService';

const result = await unlockFeature(
  user.id,
  user.subscription_tier,
  'TICKET_SCANNING_30_DAYS',
  eventId
);

if (result.success) {
  alert(`âœ… ${result.message}`);
} else {
  alert(`âŒ ${result.message}`);
  // NÃ¤ita krediitide ostu vÃµimalust
}
```

### Skaneeri Piletit

```typescript
import { scanTicket } from '@/services/ticketScanService';

const result = await scanTicket(
  qrCodeData,  // "ENX-abc123-def456"
  organizerId,
  organizerTier
);

if (result.valid) {
  // âœ… Kehtiv pilet - luba sisse
  console.log(`Tere tulemast ${result.ticket.userName}!`);
} else {
  // âŒ Kehtetu pilet
  console.log(`SissepÃ¤Ã¤s keelatud: ${result.message}`);
}
```

### Kasuta AI Funktsiooni

```typescript
import { generateAdImage } from '@/services/geminiService';

try {
  const imageUrl = await generateAdImage(
    'Suve muusikafestival tulevÃ¤rgi ga',
    '16:9',
    true,
    user.id,
    user.subscription_tier  // FREE = maksab krediite, PRO+ = tasuta
  );
} catch (error) {
  if (error.message.includes('Insufficient credits')) {
    // NÃ¤ita krediitide ostu modaali
  }
}
```

---

## ğŸ“Š Mis Muutus?

### Vana SÃ¼steem:
- âŒ Krediidid AI kasutamiseks kÃµigile
- âŒ Admin tÃ¶Ã¶riistad maksid ka krediite
- âŒ Pole piletite skaneerimist

### Uus SÃ¼steem (V2):
- âœ… Krediidid avavad premium funktsioone tasuta kasutajatele
- âœ… Tasulistel kasutajatel funktsioonid juba kaasas
- âœ… Admin tÃ¶Ã¶riistad TASUTA
- âœ… Piletite skaneerimine 50 krediidi eest
- âœ… 100 krediiti tervitusboonusena (50â‚¬ vÃ¤Ã¤rtus!)

---

## ğŸ“ Uued Failid

```
services/
  featureUnlockService.ts    # Funktsioonide avamise sÃ¼steem
  ticketScanService.ts       # Piletite skaneerimise teenus
  socialMediaService.ts      # Sotsiaalmeedia postitamine

supabase/migrations/
  20250120000001_social_media_integration.sql    # Sotsiaalmeedia
  20250120000002_feature_unlock_system.sql       # Funktsioonide avamine

docs/
  CREDIT_SYSTEM_V2_COMPLETE.md    # TÃ¤ielik dokumentatsioon
```

---

## âœ… Mis On Valmis?

- âœ… Funktsioonide avamise sÃ¼steem
- âœ… Krediidihaldus
- âœ… Piletite skaneerimine ja kontroll
- âœ… Tervitusboonuse automaatika
- âœ… Tehingute jÃ¤lgimine
- âœ… QR-koodi turvalisus
- âœ… Admin tÃ¶Ã¶riistad (tasuta)

## ğŸš§ Mis Veel Vaja?

- [ ] UI krediitide ostmiseks
- [ ] UI funktsioonide avamiseks
- [ ] Piletite skÃ¤nnerimise UI komponent
- [ ] Kaamera QR-koodi lugemine
- [ ] SissepÃ¤Ã¤su statistika dashboard

---

## ğŸ‰ KokkuvÃµte

**Mis muutus:**
1. Krediidid avavad premium funktsioone tasuta kasutajatele
2. Admin tÃ¶Ã¶riistad ei maksa enam krediite
3. Lisatud piletite skaneerimine (50 krediiti)
4. Uued kasutajad saavad 100 krediiti (50â‚¬ vÃ¤Ã¤rtus)
5. AI funktsioonid tasuta tasulistele kasutajatele

**Mis tÃ¶Ã¶tab:**
- KÃµik backend valmis ja testitud
- Andmebaasi skeem valmis
- Dokumentatsioon olemas

**Mis veel vaja:**
- UI ekraanid kasutajatele
- Kaamera QR-koodi lugemine
- Krediitide ostu protsess

---

**Viimati Uuendatud**: 20. detsember 2025  
**Versioon**: 2.0.0  
**Staatus**: Backend Valmis, UI Ootel

**Kontakt**: huntersest@gmail.com
